




-- =============================================
-- Author:	
-- Create date: 2014-07-31
-- Description:	
-- =============================================

CREATE PROCEDURE [aimp2].[MergeTableFromStageHurtownia] (@TableName VARCHAR(50) = NULL)
AS
BEGIN
	SET NOCOUNT ON;
	DECLARE @Merged BIT = 0;

	IF (@TableName IS NULL) BEGIN
		;THROW 51001, 'Nie wskazano nazwy tabeli w parametrze @TableName procedury.', 0;
	END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_Dokument' BEGIN
MERGE INTO aimp2.DPDZ_Dokument AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_Dokument AS src
ON (tgt.IdDok=src.IdDok)
WHEN MATCHED
THEN UPDATE SET
tgt.TypDeklaracji=src.TypDeklaracji, tgt.PodmiotAEO=src.PodmiotAEO, tgt.EksportDanych=src.EksportDanych, tgt.AwaryjnaRejestracja=src.AwaryjnaRejestracja, tgt.FlagaDeklaracji=src.FlagaDeklaracji, tgt.PrzyjetaRecznie=src.PrzyjetaRecznie, tgt.MRN=src.MRN, tgt.IdEwidencjaPapierowa=src.IdEwidencjaPapierowa, tgt.EmailPodmiotu=src.EmailPodmiotu, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.SegmentacjaZISAR=src.SegmentacjaZISAR, tgt.NumerWlasny=src.NumerWlasny, tgt.PodpisanaCyfrowo=src.PodpisanaCyfrowo, tgt.DataPrzyjecia=src.DataPrzyjecia, tgt.DodatkowyTypZgloszenia=src.DodatkowyTypZgloszenia, tgt.DodatkowyTypZgloszeniaPid=src.DodatkowyTypZgloszeniaPid, tgt.DataKalkulacji=src.DataKalkulacji, tgt.DataAnulowania=src.DataAnulowania, tgt.CzyKontenery=src.CzyKontenery, tgt.UrzadCelnyKontrolny=src.UrzadCelnyKontrolny, tgt.UrzadCelnyKontrolnyPid=src.UrzadCelnyKontrolnyPid, tgt.KrajPrzeznaczenia=src.KrajPrzeznaczenia, tgt.KrajPrzeznaczeniaPid=src.KrajPrzeznaczeniaPid, tgt.KrajPrzeznaczeniaRegion=src.KrajPrzeznaczeniaRegion, tgt.KrajPrzeznaczeniaRegionPid=src.KrajPrzeznaczeniaRegionPid, tgt.KrajWysylki=src.KrajWysylki, tgt.KrajWysylkiPid=src.KrajWysylkiPid, tgt.KodWaluty=src.KodWaluty, tgt.KodWalutypid=src.KodWalutypid, tgt.UrzadCelnyZgloszenia=src.UrzadCelnyZgloszenia, tgt.UrzadCelnyZgloszeniaPid=src.UrzadCelnyZgloszeniaPid, tgt.PlatnoscOdroczona=src.PlatnoscOdroczona, tgt.DataWydaniaPrzesylkiDPZ=src.DataWydaniaPrzesylkiDPZ, tgt.WynikiKontroliDPZ=src.WynikiKontroliDPZ, tgt.NumerPrzesylkiDPZ=src.NumerPrzesylkiDPZ, tgt.DataPowiadomieniaDlugDPZ=src.DataPowiadomieniaDlugDPZ, tgt.ZwyklyPocztowyDPZ=src.ZwyklyPocztowyDPZ, tgt.TypZabezpieczeniaDPZ=src.TypZabezpieczeniaDPZ, tgt.OplacenieZabezpieczenieNaleznosci=src.OplacenieZabezpieczenieNaleznosci, tgt.SposobUregulowaniaTowaruDPZ=src.SposobUregulowaniaTowaruDPZ, tgt.DataZwolnieniaDPZ=src.DataZwolnieniaDPZ, tgt.PodpisElektroniczny=src.PodpisElektroniczny, tgt.StatusObslugiEMCS=src.StatusObslugiEMCS, tgt.UrzadCelnyWprowadzania=src.UrzadCelnyWprowadzania, tgt.UrzadCelnyWprowadzaniaPid=src.UrzadCelnyWprowadzaniaPid, tgt.MasaBrutto=src.MasaBrutto, tgt.IdDanychCelnychPTW=src.IdDanychCelnychPTW, tgt.TypDokumentu=src.TypDokumentu, tgt.TypDokumentuPid=src.TypDokumentuPid, tgt.AdnotacjePrawne=src.AdnotacjePrawne, tgt.LiczbaPozycjiTowarowych=src.LiczbaPozycjiTowarowych, tgt.NumerPozwolenia=src.NumerPozwolenia, tgt.LiczbaOpakowan=src.LiczbaOpakowan, tgt.NumerReferencyjnyPrzesylki=src.NumerReferencyjnyPrzesylki, tgt.DataPrzedstawieniaTowaru=src.DataPrzedstawieniaTowaru, tgt.PrzedstawienieTowaru=src.PrzedstawienieTowaru, tgt.UrzadCelnyPrzedstawieniaTowaru=src.UrzadCelnyPrzedstawieniaTowaru, tgt.NumerDokPoprzedniego=src.NumerDokPoprzedniego, tgt.ZawartoscZC213ObslugaSprostowania=src.ZawartoscZC213ObslugaSprostowania, tgt.DataRejestracji=src.DataRejestracji, tgt.NumerRejestru=src.NumerRejestru, tgt.TerminZwolnieniaTowaru=src.TerminZwolnieniaTowaru, tgt.DataOdrzucenia=src.DataOdrzucenia, tgt.OgolnaWartoscFaktur=src.OgolnaWartoscFaktur, tgt.CzyWyslanoDeklaracjeDoTQS=src.CzyWyslanoDeklaracjeDoTQS, tgt.LicznikWysylkiDoTQS=src.LicznikWysylkiDoTQS, tgt.IdZgloszeniaUZP=src.IdZgloszeniaUZP, tgt.DanePokontrolne=src.DanePokontrolne, tgt.TypZgloszenia=src.TypZgloszenia, tgt.OsobaPodpisujacaDokument=src.OsobaPodpisujacaDokument, tgt.StatusDeklaracjiZCP=src.StatusDeklaracjiZCP, tgt.NumerSystemowyAIS=src.NumerSystemowyAIS, tgt.DataGranicznaZlozeniaZgloszeniaUZP=src.DataGranicznaZlozeniaZgloszeniaUZP, tgt.VAT7=src.VAT7
WHEN NOT MATCHED
THEN INSERT (IdDok, TypDeklaracji, PodmiotAEO, EksportDanych, AwaryjnaRejestracja, FlagaDeklaracji, PrzyjetaRecznie, MRN, IdEwidencjaPapierowa, EmailPodmiotu, PlacowkaPodmiotu, SegmentacjaZISAR, NumerWlasny, PodpisanaCyfrowo, DataPrzyjecia, DodatkowyTypZgloszenia, DodatkowyTypZgloszeniaPid, DataKalkulacji, DataAnulowania, CzyKontenery, UrzadCelnyKontrolny, UrzadCelnyKontrolnyPid, KrajPrzeznaczenia, KrajPrzeznaczeniaPid, KrajPrzeznaczeniaRegion, KrajPrzeznaczeniaRegionPid, KrajWysylki, KrajWysylkiPid, KodWaluty, KodWalutypid, UrzadCelnyZgloszenia, UrzadCelnyZgloszeniaPid, PlatnoscOdroczona, DataWydaniaPrzesylkiDPZ, WynikiKontroliDPZ, NumerPrzesylkiDPZ, DataPowiadomieniaDlugDPZ, ZwyklyPocztowyDPZ, TypZabezpieczeniaDPZ, OplacenieZabezpieczenieNaleznosci, SposobUregulowaniaTowaruDPZ, DataZwolnieniaDPZ, PodpisElektroniczny, StatusObslugiEMCS, UrzadCelnyWprowadzania, UrzadCelnyWprowadzaniaPid, MasaBrutto, IdDanychCelnychPTW, TypDokumentu, TypDokumentuPid, AdnotacjePrawne, LiczbaPozycjiTowarowych, NumerPozwolenia, LiczbaOpakowan, NumerReferencyjnyPrzesylki, DataPrzedstawieniaTowaru, PrzedstawienieTowaru, UrzadCelnyPrzedstawieniaTowaru, NumerDokPoprzedniego, ZawartoscZC213ObslugaSprostowania, DataRejestracji, NumerRejestru, TerminZwolnieniaTowaru, DataOdrzucenia, OgolnaWartoscFaktur, CzyWyslanoDeklaracjeDoTQS, LicznikWysylkiDoTQS, IdZgloszeniaUZP, DanePokontrolne, TypZgloszenia, OsobaPodpisujacaDokument, StatusDeklaracjiZCP, NumerSystemowyAIS, DataGranicznaZlozeniaZgloszeniaUZP, VAT7)
VALUES (src.IdDok, src.TypDeklaracji, src.PodmiotAEO, src.EksportDanych, src.AwaryjnaRejestracja, src.FlagaDeklaracji, src.PrzyjetaRecznie, src.MRN, src.IdEwidencjaPapierowa, src.EmailPodmiotu, src.PlacowkaPodmiotu, src.SegmentacjaZISAR, src.NumerWlasny, src.PodpisanaCyfrowo, src.DataPrzyjecia, src.DodatkowyTypZgloszenia, src.DodatkowyTypZgloszeniaPid, src.DataKalkulacji, src.DataAnulowania, src.CzyKontenery, src.UrzadCelnyKontrolny, src.UrzadCelnyKontrolnyPid, src.KrajPrzeznaczenia, src.KrajPrzeznaczeniaPid, src.KrajPrzeznaczeniaRegion, src.KrajPrzeznaczeniaRegionPid, src.KrajWysylki, src.KrajWysylkiPid, src.KodWaluty, src.KodWalutypid, src.UrzadCelnyZgloszenia, src.UrzadCelnyZgloszeniaPid, src.PlatnoscOdroczona, src.DataWydaniaPrzesylkiDPZ, src.WynikiKontroliDPZ, src.NumerPrzesylkiDPZ, src.DataPowiadomieniaDlugDPZ, src.ZwyklyPocztowyDPZ, src.TypZabezpieczeniaDPZ, src.OplacenieZabezpieczenieNaleznosci, src.SposobUregulowaniaTowaruDPZ, src.DataZwolnieniaDPZ, src.PodpisElektroniczny, src.StatusObslugiEMCS, src.UrzadCelnyWprowadzania, src.UrzadCelnyWprowadzaniaPid, src.MasaBrutto, src.IdDanychCelnychPTW, src.TypDokumentu, src.TypDokumentuPid, src.AdnotacjePrawne, src.LiczbaPozycjiTowarowych, src.NumerPozwolenia, src.LiczbaOpakowan, src.NumerReferencyjnyPrzesylki, src.DataPrzedstawieniaTowaru, src.PrzedstawienieTowaru, src.UrzadCelnyPrzedstawieniaTowaru, src.NumerDokPoprzedniego, src.ZawartoscZC213ObslugaSprostowania, src.DataRejestracji, src.NumerRejestru, src.TerminZwolnieniaTowaru, src.DataOdrzucenia, src.OgolnaWartoscFaktur, src.CzyWyslanoDeklaracjeDoTQS, src.LicznikWysylkiDoTQS, src.IdZgloszeniaUZP, src.DanePokontrolne, src.TypZgloszenia, src.OsobaPodpisujacaDokument, src.StatusDeklaracjiZCP, src.NumerSystemowyAIS, src.DataGranicznaZlozeniaZgloszeniaUZP, src.VAT7);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_DokumentPoprzedni' BEGIN
MERGE INTO aimp2.DPDZ_DokumentPoprzedni AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_DokumentPoprzedni AS src
ON (tgt.IdDokPoprzed=src.IdDokPoprzed)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.Kategoria=src.Kategoria, tgt.KategoriaPid=src.KategoriaPid, tgt.KodDokPoprz=src.KodDokPoprz, tgt.KodDokPoprzPid=src.KodDokPoprzPid, tgt.Numer=src.Numer, tgt.NumerDokumentu=src.NumerDokumentu, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdDokPoprzed, IdTowarDPDZ, Kategoria, KategoriaPid, KodDokPoprz, KodDokPoprzPid, Numer, NumerDokumentu, DanePokontrolne)
VALUES (src.IdDokPoprzed, src.IdTowarDPDZ, src.Kategoria, src.KategoriaPid, src.KodDokPoprz, src.KodDokPoprzPid, src.Numer, src.NumerDokumentu, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_DokumentWymagany' BEGIN
MERGE INTO aimp2.DPDZ_DokumentWymagany AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_DokumentWymagany AS src
ON (tgt.IdDokWym=src.IdDokWym)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.AGRIMOpisNiezgodnosci=src.AGRIMOpisNiezgodnosci, tgt.AGRIMWynik=src.AGRIMWynik, tgt.KodDokumentu=src.KodDokumentu, tgt.KodDokumentuPid=src.KodDokumentuPid, tgt.UwagiDoDokumentu=src.UwagiDoDokumentu, tgt.NumerDokumentu=src.NumerDokumentu, tgt.DataWygasniecia=src.DataWygasniecia, tgt.NazwaInstytucji=src.NazwaInstytucji, tgt.IloscTowaru=src.IloscTowaru, tgt.NumerPozycji=src.NumerPozycji, tgt.JednostkaMiary=src.JednostkaMiary, tgt.JednostkaMiaryPid=src.JednostkaMiaryPid, tgt.DanePokontroln=src.DanePokontroln
WHEN NOT MATCHED
THEN INSERT (IdDokWym, IdTowarDPDZ, AGRIMOpisNiezgodnosci, AGRIMWynik, KodDokumentu, KodDokumentuPid, UwagiDoDokumentu, NumerDokumentu, DataWygasniecia, NazwaInstytucji, IloscTowaru, NumerPozycji, JednostkaMiary, JednostkaMiaryPid, DanePokontroln)
VALUES (src.IdDokWym, src.IdTowarDPDZ, src.AGRIMOpisNiezgodnosci, src.AGRIMWynik, src.KodDokumentu, src.KodDokumentuPid, src.UwagiDoDokumentu, src.NumerDokumentu, src.DataWygasniecia, src.NazwaInstytucji, src.IloscTowaru, src.NumerPozycji, src.JednostkaMiary, src.JednostkaMiaryPid, src.DanePokontroln);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_IloscTowaru' BEGIN
MERGE INTO aimp2.DPDZ_IloscTowaru AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_IloscTowaru AS src
ON (tgt.IdIlosci=src.IdIlosci)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.IdPozycjiNaLiscieDokWym=src.IdPozycjiNaLiscieDokWym, tgt.KwalifikatorJednostkiMiary=src.KwalifikatorJednostkiMiary, tgt.KwalifikatorJednostkiMiaryPid=src.KwalifikatorJednostkiMiaryPid, tgt.IloscTowaruDoTARIC=src.IloscTowaruDoTARIC, tgt.JednostkaMiary=src.JednostkaMiary, tgt.JednostkaMiaryPid=src.JednostkaMiaryPid
WHEN NOT MATCHED
THEN INSERT (IdIlosci, IdTowarDPDZ, IdPozycjiNaLiscieDokWym, KwalifikatorJednostkiMiary, KwalifikatorJednostkiMiaryPid, IloscTowaruDoTARIC, JednostkaMiary, JednostkaMiaryPid)
VALUES (src.IdIlosci, src.IdTowarDPDZ, src.IdPozycjiNaLiscieDokWym, src.KwalifikatorJednostkiMiary, src.KwalifikatorJednostkiMiaryPid, src.IloscTowaruDoTARIC, src.JednostkaMiary, src.JednostkaMiaryPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_InformacjaDodatkowa' BEGIN
MERGE INTO aimp2.DPDZ_InformacjaDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_InformacjaDodatkowa AS src
ON (tgt.IdInfDodatk=src.IdInfDodatk)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.KodInfDodatk=src.KodInfDodatk, tgt.KodInfDodatkPid=src.KodInfDodatkPid, tgt.OpisInfDodatk=src.OpisInfDodatk, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdInfDodatk, IdTowarDPDZ, KodInfDodatk, KodInfDodatkPid, OpisInfDodatk, DanePokontrolne)
VALUES (src.IdInfDodatk, src.IdTowarDPDZ, src.KodInfDodatk, src.KodInfDodatkPid, src.OpisInfDodatk, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_LokalizacjaTowarow' BEGIN
MERGE INTO aimp2.DPDZ_LokalizacjaTowarow AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_LokalizacjaTowarow AS src
ON (tgt.IdLokalizacji=src.IdLokalizacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.DodatkowyIdLokalizacji=src.DodatkowyIdLokalizacji, tgt.KodMiejscaLokalizacji=src.KodMiejscaLokalizacji, tgt.KodMiejscaLokalizacjiPid=src.KodMiejscaLokalizacjiPid, tgt.KrajLokalizacji=src.KrajLokalizacji, tgt.KrajLokalizacjiPid=src.KrajLokalizacjiPid, tgt.OpisMiejscaLokalizacji=src.OpisMiejscaLokalizacji, tgt.UrzadCelnyLokalizacji=src.UrzadCelnyLokalizacji, tgt.UrzadCelnyLokalizacjiPid=src.UrzadCelnyLokalizacjiPid, tgt.KwalifikatorLokalizacji=src.KwalifikatorLokalizacji, tgt.KwalifikatorLokalizacjiPid=src.KwalifikatorLokalizacjiPid, tgt.TypLokalizacji=src.TypLokalizacji, tgt.TypLokalizacjiPid=src.TypLokalizacjiPid, tgt.IdentyfikatorAdresu=src.IdentyfikatorAdresu
WHEN NOT MATCHED
THEN INSERT (IdLokalizacji, IdDok, DodatkowyIdLokalizacji, KodMiejscaLokalizacji, KodMiejscaLokalizacjiPid, KrajLokalizacji, KrajLokalizacjiPid, OpisMiejscaLokalizacji, UrzadCelnyLokalizacji, UrzadCelnyLokalizacjiPid, KwalifikatorLokalizacji, KwalifikatorLokalizacjiPid, TypLokalizacji, TypLokalizacjiPid, IdentyfikatorAdresu)
VALUES (src.IdLokalizacji, src.IdDok, src.DodatkowyIdLokalizacji, src.KodMiejscaLokalizacji, src.KodMiejscaLokalizacjiPid, src.KrajLokalizacji, src.KrajLokalizacjiPid, src.OpisMiejscaLokalizacji, src.UrzadCelnyLokalizacji, src.UrzadCelnyLokalizacjiPid, src.KwalifikatorLokalizacji, src.KwalifikatorLokalizacjiPid, src.TypLokalizacji, src.TypLokalizacjiPid, src.IdentyfikatorAdresu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_MetodaPlatnosci' BEGIN
MERGE INTO aimp2.DPDZ_MetodaPlatnosci AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_MetodaPlatnosci AS src
ON (tgt.IdMetodyPlatnosci=src.IdMetodyPlatnosci)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.Kwota=src.Kwota, tgt.KwotaZaplacona=src.KwotaZaplacona, tgt.KwotaDoZabezpieczenia=src.KwotaDoZabezpieczenia, tgt.PodstawaOplaty=src.PodstawaOplaty, tgt.DataPowiadomienia=src.DataPowiadomienia, tgt.DataNotyfikacji=src.DataNotyfikacji, tgt.IdPODZ=src.IdPODZ, tgt.KwotaZabezpieczona=src.KwotaZabezpieczona, tgt.MetodaPlatnosci=src.MetodaPlatnosci, tgt.MetodaPlatnosciPid=src.MetodaPlatnosciPid, tgt.Stawka=src.Stawka, tgt.StylWiersza=src.StylWiersza, tgt.TypOplaty=src.TypOplaty, tgt.TypOplatyPid=src.TypOplatyPid, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdMetodyPlatnosci, IdTowarDPDZ, Kwota, KwotaZaplacona, KwotaDoZabezpieczenia, PodstawaOplaty, DataPowiadomienia, DataNotyfikacji, IdPODZ, KwotaZabezpieczona, MetodaPlatnosci, MetodaPlatnosciPid, Stawka, StylWiersza, TypOplaty, TypOplatyPid, DanePokontrolne)
VALUES (src.IdMetodyPlatnosci, src.IdTowarDPDZ, src.Kwota, src.KwotaZaplacona, src.KwotaDoZabezpieczenia, src.PodstawaOplaty, src.DataPowiadomienia, src.DataNotyfikacji, src.IdPODZ, src.KwotaZabezpieczona, src.MetodaPlatnosci, src.MetodaPlatnosciPid, src.Stawka, src.StylWiersza, src.TypOplaty, src.TypOplatyPid, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_Odbiorca' BEGIN
MERGE INTO aimp2.DPDZ_Odbiorca AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_Odbiorca AS src
ON (tgt.IdKontrahenta=src.IdKontrahenta)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.IdentyfikatorFirmy=src.IdentyfikatorFirmy, tgt.NazwaFirmy=src.NazwaFirmy, tgt.ImieOdbiorcy=src.ImieOdbiorcy, tgt.NazwiskoOdbiorcy=src.NazwiskoOdbiorcy, tgt.PESELOdbiorcy=src.PESELOdbiorcy, tgt.RodzajOdbiorcy=src.RodzajOdbiorcy
WHEN NOT MATCHED
THEN INSERT (IdKontrahenta, IdDok, IdentyfikatorFirmy, NazwaFirmy, ImieOdbiorcy, NazwiskoOdbiorcy, PESELOdbiorcy, RodzajOdbiorcy)
VALUES (src.IdKontrahenta, src.IdDok, src.IdentyfikatorFirmy, src.NazwaFirmy, src.ImieOdbiorcy, src.NazwiskoOdbiorcy, src.PESELOdbiorcy, src.RodzajOdbiorcy);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_Opakowanie' BEGIN
MERGE INTO aimp2.DPDZ_Opakowanie AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_Opakowanie AS src
ON (tgt.IdOpakowania=src.IdOpakowania)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.NumeryZnakiOpakowan=src.NumeryZnakiOpakowan, tgt.LiczbaOpakowan=src.LiczbaOpakowan, tgt.RodzajOpakowan=src.RodzajOpakowan, tgt.RodzajOpakowanPid=src.RodzajOpakowanPid, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdOpakowania, IdTowarDPDZ, NumeryZnakiOpakowan, LiczbaOpakowan, RodzajOpakowan, RodzajOpakowanPid, DanePokontrolne)
VALUES (src.IdOpakowania, src.IdTowarDPDZ, src.NumeryZnakiOpakowan, src.LiczbaOpakowan, src.RodzajOpakowan, src.RodzajOpakowanPid, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_OsobaFizyczna' BEGIN
MERGE INTO aimp2.DPDZ_OsobaFizyczna AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_OsobaFizyczna AS src
ON (tgt.IdKontrahenta=src.IdKontrahenta)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.RodzajOsoby=src.RodzajOsoby, tgt.NumerIdentyfikacyjny=src.NumerIdentyfikacyjny, tgt.IdentyfikatorOsoby=src.IdentyfikatorOsoby, tgt.Imie=src.Imie, tgt.Nazwisko=src.Nazwisko, tgt.PESEL=src.PESEL, tgt.RodzajReprezentanta=src.RodzajReprezentanta, tgt.DanePokontrolne=src.DanePokontrolne, tgt.IdAdresu=src.IdAdresu, tgt.IdOsobyPodpisujacejDok=src.IdOsobyPodpisujacejDok
WHEN NOT MATCHED
THEN INSERT (IdKontrahenta, IdDok, PlacowkaPodmiotu, RodzajOsoby, NumerIdentyfikacyjny, IdentyfikatorOsoby, Imie, Nazwisko, PESEL, RodzajReprezentanta, DanePokontrolne, IdAdresu, IdOsobyPodpisujacejDok)
VALUES (src.IdKontrahenta, src.IdDok, src.PlacowkaPodmiotu, src.RodzajOsoby, src.NumerIdentyfikacyjny, src.IdentyfikatorOsoby, src.Imie, src.Nazwisko, src.PESEL, src.RodzajReprezentanta, src.DanePokontrolne, src.IdAdresu, src.IdOsobyPodpisujacejDok);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_Podmiot' BEGIN
MERGE INTO aimp2.DPDZ_Podmiot AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_Podmiot AS src
ON (tgt.IdKontrahenta=src.IdKontrahenta)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.IdGrupyCertyfAEO=src.IdGrupyCertyfAEO, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.RolaPodmiotu=src.RolaPodmiotu, tgt.Email=src.Email, tgt.EORI=src.EORI, tgt.IdSISC=src.IdSISC, tgt.IdPodmiotuGospodarczego=src.IdPodmiotuGospodarczego, tgt.NazwaPodmiotu=src.NazwaPodmiotu, tgt.REGON=src.REGON, tgt.TypReprezentacji=src.TypReprezentacji, tgt.TIN=src.TIN, tgt.IdAdresu=src.IdAdresu, tgt.IdOsobyPodpisujacejDok=src.IdOsobyPodpisujacejDok
WHEN NOT MATCHED
THEN INSERT (IdKontrahenta, IdDok, IdGrupyCertyfAEO, PlacowkaPodmiotu, RolaPodmiotu, Email, EORI, IdSISC, IdPodmiotuGospodarczego, NazwaPodmiotu, REGON, TypReprezentacji, TIN, IdAdresu, IdOsobyPodpisujacejDok)
VALUES (src.IdKontrahenta, src.IdDok, src.IdGrupyCertyfAEO, src.PlacowkaPodmiotu, src.RolaPodmiotu, src.Email, src.EORI, src.IdSISC, src.IdPodmiotuGospodarczego, src.NazwaPodmiotu, src.REGON, src.TypReprezentacji, src.TIN, src.IdAdresu, src.IdOsobyPodpisujacejDok);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_PodmiotAdres' BEGIN
MERGE INTO aimp2.DPDZ_PodmiotAdres AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_PodmiotAdres AS src
ON (tgt.IdAdresu=src.IdAdresu)
WHEN MATCHED
THEN UPDATE SET
tgt.Miasto=src.Miasto, tgt.Kraj=src.Kraj, tgt.KrajPid=src.KrajPid, tgt.UlicaNumer=src.UlicaNumer, tgt.KodPocztowy=src.KodPocztowy
WHEN NOT MATCHED
THEN INSERT (IdAdresu, Miasto, Kraj, KrajPid, UlicaNumer, KodPocztowy)
VALUES (src.IdAdresu, src.Miasto, src.Kraj, src.KrajPid, src.UlicaNumer, src.KodPocztowy);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_PodmiotInfDodatkowa' BEGIN
MERGE INTO aimp2.DPDZ_PodmiotInfDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_PodmiotInfDodatkowa AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdPodmiotuGospodarczego=src.IdPodmiotuGospodarczego, tgt.KodInfDodPodm=src.KodInfDodPodm
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdPodmiotuGospodarczego, KodInfDodPodm)
VALUES (src.IdInformacji, src.IdPodmiotuGospodarczego, src.KodInfDodPodm);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_SrodekTaryfowy' BEGIN
MERGE INTO aimp2.DPDZ_SrodekTaryfowy AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_SrodekTaryfowy AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.SrodekArchiwalny=src.SrodekArchiwalny, tgt.Przypisy=src.Przypisy, tgt.ObszarGeograficzny=src.ObszarGeograficzny, tgt.IdSrodka=src.IdSrodka, tgt.DataRejestracji=src.DataRejestracji, tgt.NumerWpisu=src.NumerWpisu, tgt.Seria=src.Seria, tgt.SID=src.SID, tgt.Typ=src.Typ, tgt.KodUAM=src.KodUAM, tgt.KwalifikatorUAM=src.KwalifikatorUAM
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdTowarDPDZ, SrodekArchiwalny, Przypisy, ObszarGeograficzny, IdSrodka, DataRejestracji, NumerWpisu, Seria, SID, Typ, KodUAM, KwalifikatorUAM)
VALUES (src.IdWpisu, src.IdTowarDPDZ, src.SrodekArchiwalny, src.Przypisy, src.ObszarGeograficzny, src.IdSrodka, src.DataRejestracji, src.NumerWpisu, src.Seria, src.SID, src.Typ, src.KodUAM, src.KwalifikatorUAM);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_SzczegolyWartosciTowarow' BEGIN
MERGE INTO aimp2.DPDZ_SzczegolyWartosciTowarow AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_SzczegolyWartosciTowarow AS src
ON (tgt.idWpisu=src.idWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdWartosciTowarDPDZ=src.IdWartosciTowarDPDZ, tgt.KodSzczegolyWart=src.KodSzczegolyWart, tgt.NumerPozycji=src.NumerPozycji, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (idWpisu, IdWartosciTowarDPDZ, KodSzczegolyWart, NumerPozycji, DanePokontrolne)
VALUES (src.idWpisu, src.IdWartosciTowarDPDZ, src.KodSzczegolyWart, src.NumerPozycji, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_Towar' BEGIN
MERGE INTO aimp2.DPDZ_Towar AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_Towar AS src
ON (tgt.IdPozycji=src.IdPozycji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.AGRIM=src.AGRIM, tgt.SaldoARR=src.SaldoARR, tgt.StatusPrzetwarzaniaPozycjiARR=src.StatusPrzetwarzaniaPozycjiARR, tgt.IdKupujacegoOsobaFizyczna=src.IdKupujacegoOsobaFizyczna, tgt.IdPodmiotuDoKontaktu=src.IdPodmiotuDoKontaktu, tgt.IdOdbiorcyPodmiotGospodarczy=src.IdOdbiorcyPodmiotGospodarczy, tgt.IdSprzedajacegoPodmiotGospodarczy=src.IdSprzedajacegoPodmiotGospodarczy, tgt.IdNadawcyPodmiotGospodarczy=src.IdNadawcyPodmiotGospodarczy, tgt.DataDoKalkulacji1=src.DataDoKalkulacji1, tgt.DataDoKalkulacji2=src.DataDoKalkulacji2, tgt.KodCN=src.KodCN, tgt.RzeczywistyKodTowarowy=src.RzeczywistyKodTowarowy, tgt.IdPodmiotuZPozwNaSamoobslugeCelna=src.IdPodmiotuZPozwNaSamoobslugeCelna, tgt.KontynuacjaProcesu=src.KontynuacjaProcesu, tgt.KrajPrzeznaczenia=src.KrajPrzeznaczenia, tgt.KrajPrzeznaczeniaPid=src.KrajPrzeznaczeniaPid, tgt.KrajPrzeznaczeniaRegion=src.KrajPrzeznaczeniaRegion, tgt.KrajPrzeznaczeniaRegionPid=src.KrajPrzeznaczeniaRegionPid, tgt.KrajWysylki=src.KrajWysylki, tgt.KrajWysylkiPid=src.KrajWysylkiPid, tgt.KrajPochodzenia=src.KrajPochodzenia, tgt.KrajPochodzeniaPid=src.KrajPochodzeniaPid, tgt.WynikWalidacjiCRX_REX=src.WynikWalidacjiCRX_REX, tgt.KodWaluty=src.KodWaluty, tgt.KodWalutyPid=src.KodWalutyPid, tgt.KodCUS=src.KodCUS, tgt.IdDecyzjiAdminUsuwajacejPozycje=src.IdDecyzjiAdminUsuwajacejPozycje, tgt.OpisNieprawidlowosci=src.OpisNieprawidlowosci, tgt.TowarStrategiczny=src.TowarStrategiczny, tgt.EAD=src.EAD, tgt.EMCSNumerARC=src.EMCSNumerARC, tgt.EMCSKodCN=src.EMCSKodCN, tgt.EMCSMasaNetto=src.EMCSMasaNetto, tgt.EMCSStatusPrzetwarzaniaPozycji=src.EMCSStatusPrzetwarzaniaPozycji, tgt.EMCSTryb=src.EMCSTryb, tgt.MasaBrutto=src.MasaBrutto, tgt.ZarejestrowaneZabezpieczenie=src.ZarejestrowaneZabezpieczenie, tgt.IdPozycjiZdefiniowanejPDS=src.IdPozycjiZdefiniowanejPDS, tgt.IdDanychCelnychPozycjiPDS=src.IdDanychCelnychPozycjiPDS, tgt.DataUniewaznienia=src.DataUniewaznienia, tgt.UniewaznionoPozycjeManualnie=src.UniewaznionoPozycjeManualnie, tgt.PowodUniewaznieniaPozycji=src.PowodUniewaznieniaPozycji, tgt.PowodOdrzuceniaUniewaznieniaPozycji=src.PowodOdrzuceniaUniewaznieniaPozycji, tgt.NumerWlasnyWnioskuOUniewaznienie=src.NumerWlasnyWnioskuOUniewaznienie, tgt.KodTowarowy=src.KodTowarowy, tgt.OpisPozycji=src.OpisPozycji, tgt.NumerPozycji=src.NumerPozycji, tgt.Wartosc=src.Wartosc, tgt.TrescAdnotacjiUrzedowych=src.TrescAdnotacjiUrzedowych, tgt.NrPozycjiSrodkaTARIC=src.NrPozycjiSrodkaTARIC, tgt.KodTypuSrodkaTARIC=src.KodTypuSrodkaTARIC, tgt.MasaNetto=src.MasaNetto, tgt.RzeczywistaMasaNetto=src.RzeczywistaMasaNetto, tgt.Adnotacje=src.Adnotacje, tgt.IdKupujacegoPodmiotGospodarczy=src.IdKupujacegoPodmiotGospodarczy, tgt.IdOsobyDoKontaktu=src.IdOsobyDoKontaktu, tgt.IdOdbiorcyOsobaFizyczna=src.IdOdbiorcyOsobaFizyczna, tgt.IdSprzedajacegoOsobaFizyczna=src.IdSprzedajacegoOsobaFizyczna, tgt.IdNadawcyOsobaFizyczna=src.IdNadawcyOsobaFizyczna, tgt.ZaksiegowanoZerowePlatnosciZEFIR=src.ZaksiegowanoZerowePlatnosciZEFIR, tgt.KodKrajuPreferencyjnegoPochodzenia=src.KodKrajuPreferencyjnegoPochodzenia, tgt.KodKrajuPreferencyjnegoPochodzeniaPid=src.KodKrajuPreferencyjnegoPochodzeniaPid, tgt.NumerReferencyjnyPrzesylki=src.NumerReferencyjnyPrzesylki, tgt.PlatnoscZarejestrowana=src.PlatnoscZarejestrowana, tgt.KodPreferencji=src.KodPreferencji, tgt.KodPreferencjiPid=src.KodPreferencjiPid, tgt.KodProceduryPoprzedniej=src.KodProceduryPoprzedniej, tgt.KodProceduryPoprzedniejPid=src.KodProceduryPoprzedniejPid, tgt.KodProceduryWnioskowanej=src.KodProceduryWnioskowanej, tgt.KodProceduryWnioskowanejPid=src.KodProceduryWnioskowanejPid, tgt.ZrealizowanePlatnosciZEFIR=src.ZrealizowanePlatnosciZEFIR, tgt.IloscTowaru=src.IloscTowaru, tgt.IloscTowaruUzupelniajacaJednostkaMiary=src.IloscTowaruUzupelniajacaJednostkaMiary, tgt.DataZwolnieniaTowaru=src.DataZwolnieniaTowaru, tgt.PodstawaUregulowaniaStatusu=src.PodstawaUregulowaniaStatusu, tgt.TerminUregulowaniaStatusu=src.TerminUregulowaniaStatusu,
tgt.SposobUregulowaniaStatusu=src.SposobUregulowaniaStatusu, tgt.StatusWyslaniaPozycjiDoOSOZ=src.StatusWyslaniaPozycjiDoOSOZ, tgt.StatusWyslaniaPozycjiDoZEFIR=src.StatusWyslaniaPozycjiDoZEFIR, tgt.WyslanoKomunikatZC272=src.WyslanoKomunikatZC272, tgt.EMCSOczekiwanie=src.EMCSOczekiwanie, tgt.KodTARIC=src.KodTARIC, tgt.TQSOdrzucenie=src.TQSOdrzucenie, tgt.RodzajTransakcji=src.RodzajTransakcji, tgt.RodzajTransakcjiPid=src.RodzajTransakcjiPid, tgt.IdZgloszeniaUzupelniajacego=src.IdZgloszeniaUzupelniajacego, tgt.VAT7DecyzjaAdministracyjna=src.VAT7DecyzjaAdministracyjna, tgt.VAT7Zamkniecia=src.VAT7Zamkniecia, tgt.VAT7DataCzasZaplaty=src.VAT7DataCzasZaplaty, tgt.WynikWeryfikacji=src.WynikWeryfikacji, tgt.DanePokontrolne=src.DanePokontrolne, tgt.StatusPozycji=src.StatusPozycji, tgt.LiczbaSprostowanWyslanychDoZEFIR=src.LiczbaSprostowanWyslanychDoZEFIR
WHEN NOT MATCHED
THEN INSERT (IdPozycji, IdDok, AGRIM, SaldoARR, StatusPrzetwarzaniaPozycjiARR, IdKupujacegoOsobaFizyczna, IdPodmiotuDoKontaktu, IdOdbiorcyPodmiotGospodarczy, IdSprzedajacegoPodmiotGospodarczy, IdNadawcyPodmiotGospodarczy, DataDoKalkulacji1, DataDoKalkulacji2, KodCN, RzeczywistyKodTowarowy, IdPodmiotuZPozwNaSamoobslugeCelna, KontynuacjaProcesu, KrajPrzeznaczenia, KrajPrzeznaczeniaPid, KrajPrzeznaczeniaRegion, KrajPrzeznaczeniaRegionPid, KrajWysylki, KrajWysylkiPid, KrajPochodzenia, KrajPochodzeniaPid, WynikWalidacjiCRX_REX, KodWaluty, KodWalutyPid, KodCUS, IdDecyzjiAdminUsuwajacejPozycje, OpisNieprawidlowosci, TowarStrategiczny, EAD, EMCSNumerARC, EMCSKodCN, EMCSMasaNetto, EMCSStatusPrzetwarzaniaPozycji, EMCSTryb, MasaBrutto, ZarejestrowaneZabezpieczenie, IdPozycjiZdefiniowanejPDS, IdDanychCelnychPozycjiPDS, DataUniewaznienia, UniewaznionoPozycjeManualnie, PowodUniewaznieniaPozycji, PowodOdrzuceniaUniewaznieniaPozycji, NumerWlasnyWnioskuOUniewaznienie, KodTowarowy, OpisPozycji, NumerPozycji, Wartosc, TrescAdnotacjiUrzedowych, NrPozycjiSrodkaTARIC, KodTypuSrodkaTARIC, MasaNetto, RzeczywistaMasaNetto, Adnotacje, IdKupujacegoPodmiotGospodarczy, IdOsobyDoKontaktu, IdOdbiorcyOsobaFizyczna, IdSprzedajacegoOsobaFizyczna, IdNadawcyOsobaFizyczna, ZaksiegowanoZerowePlatnosciZEFIR, KodKrajuPreferencyjnegoPochodzenia, KodKrajuPreferencyjnegoPochodzeniaPid, NumerReferencyjnyPrzesylki, PlatnoscZarejestrowana, KodPreferencji, KodPreferencjiPid, KodProceduryPoprzedniej, KodProceduryPoprzedniejPid, KodProceduryWnioskowanej, KodProceduryWnioskowanejPid, ZrealizowanePlatnosciZEFIR, IloscTowaru, IloscTowaruUzupelniajacaJednostkaMiary, DataZwolnieniaTowaru, PodstawaUregulowaniaStatusu, TerminUregulowaniaStatusu, SposobUregulowaniaStatusu, StatusWyslaniaPozycjiDoOSOZ, StatusWyslaniaPozycjiDoZEFIR, WyslanoKomunikatZC272, EMCSOczekiwanie, KodTARIC, TQSOdrzucenie, RodzajTransakcji, RodzajTransakcjiPid, IdZgloszeniaUzupelniajacego, VAT7DecyzjaAdministracyjna, VAT7Zamkniecia, VAT7DataCzasZaplaty, WynikWeryfikacji, DanePokontrolne, StatusPozycji, LiczbaSprostowanWyslanychDoZEFIR)
VALUES (src.IdPozycji, src.IdDok, src.AGRIM, src.SaldoARR, src.StatusPrzetwarzaniaPozycjiARR, src.IdKupujacegoOsobaFizyczna, src.IdPodmiotuDoKontaktu, src.IdOdbiorcyPodmiotGospodarczy, src.IdSprzedajacegoPodmiotGospodarczy, src.IdNadawcyPodmiotGospodarczy, src.DataDoKalkulacji1, src.DataDoKalkulacji2, src.KodCN, src.RzeczywistyKodTowarowy, src.IdPodmiotuZPozwNaSamoobslugeCelna, src.KontynuacjaProcesu, src.KrajPrzeznaczenia, src.KrajPrzeznaczeniaPid, src.KrajPrzeznaczeniaRegion, src.KrajPrzeznaczeniaRegionPid, src.KrajWysylki, src.KrajWysylkiPid, src.KrajPochodzenia, src.KrajPochodzeniaPid, src.WynikWalidacjiCRX_REX, src.KodWaluty, src.KodWalutyPid, src.KodCUS, src.IdDecyzjiAdminUsuwajacejPozycje, src.OpisNieprawidlowosci, src.TowarStrategiczny, src.EAD, src.EMCSNumerARC, src.EMCSKodCN, src.EMCSMasaNetto, src.EMCSStatusPrzetwarzaniaPozycji, src.EMCSTryb, src.MasaBrutto, src.ZarejestrowaneZabezpieczenie, src.IdPozycjiZdefiniowanejPDS, src.IdDanychCelnychPozycjiPDS, src.DataUniewaznienia, src.UniewaznionoPozycjeManualnie, src.PowodUniewaznieniaPozycji, src.PowodOdrzuceniaUniewaznieniaPozycji, src.NumerWlasnyWnioskuOUniewaznienie, src.KodTowarowy, src.OpisPozycji, src.NumerPozycji, src.Wartosc, src.TrescAdnotacjiUrzedowych, src.NrPozycjiSrodkaTARIC, src.KodTypuSrodkaTARIC, src.MasaNetto, src.RzeczywistaMasaNetto, src.Adnotacje, src.IdKupujacegoPodmiotGospodarczy, src.IdOsobyDoKontaktu, src.IdOdbiorcyOsobaFizyczna, src.IdSprzedajacegoOsobaFizyczna, src.IdNadawcyOsobaFizyczna, src.ZaksiegowanoZerowePlatnosciZEFIR, src.KodKrajuPreferencyjnegoPochodzenia, src.KodKrajuPreferencyjnegoPochodzeniaPid, src.NumerReferencyjnyPrzesylki, src.PlatnoscZarejestrowana, src.KodPreferencji, src.KodPreferencjiPid, src.KodProceduryPoprzedniej, src.KodProceduryPoprzedniejPid, src.KodProceduryWnioskowanej, src.KodProceduryWnioskowanejPid, src.ZrealizowanePlatnosciZEFIR, src.IloscTowaru, src.IloscTowaruUzupelniajacaJednostkaMiary, src.DataZwolnieniaTowaru, src.PodstawaUregulowaniaStatusu, src.TerminUregulowaniaStatusu, src.SposobUregulowaniaStatusu, src.StatusWyslaniaPozycjiDoOSOZ, src.StatusWyslaniaPozycjiDoZEFIR, src.WyslanoKomunikatZC272, src.EMCSOczekiwanie, src.KodTARIC, src.TQSOdrzucenie, src.RodzajTransakcji, src.RodzajTransakcjiPid, src.IdZgloszeniaUzupelniajacego, src.VAT7DecyzjaAdministracyjna, src.VAT7Zamkniecia, src.VAT7DataCzasZaplaty, src.WynikWeryfikacji, src.DanePokontrolne, src.StatusPozycji, src.LiczbaSprostowanWyslanychDoZEFIR);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DPDZ_WartoscTowarow' BEGIN
MERGE INTO aimp2.DPDZ_WartoscTowarow AS tgt
USING WA_StageHurtownia.aimp2.DPDZ_WartoscTowarow AS src
ON (tgt.IdWartosci=src.IdWartosci)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.WartoscTowarow=src.WartoscTowarow, tgt.WartoscStatystyczna=src.WartoscStatystyczna, tgt.MetodaWartosciowania=src.MetodaWartosciowania, tgt.MetodaWartosciowaniaPid=src.MetodaWartosciowaniaPid
WHEN NOT MATCHED
THEN INSERT (IdWartosci, IdTowarDPDZ, WartoscTowarow, WartoscStatystyczna, MetodaWartosciowania, MetodaWartosciowaniaPid)
VALUES (src.IdWartosci, src.IdTowarDPDZ, src.WartoscTowarow, src.WartoscStatystyczna, src.MetodaWartosciowania, src.MetodaWartosciowaniaPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_Dokument' BEGIN
MERGE INTO aimp2.DSK_Dokument AS tgt
USING WA_StageHurtownia.aimp2.DSK_Dokument AS src
ON (tgt.IdDok=src.IdDok)
WHEN MATCHED
THEN UPDATE SET
tgt.TypDeklaracji=src.TypDeklaracji, tgt.PodmiotAEO=src.PodmiotAEO, tgt.EksportDanych=src.EksportDanych, tgt.AwaryjnaRejestracja=src.AwaryjnaRejestracja, tgt.FlagaDeklaracji=src.FlagaDeklaracji, tgt.PrzyjetaRecznie=src.PrzyjetaRecznie, tgt.MRN=src.MRN, tgt.IdEwidencjaPapierowa=src.IdEwidencjaPapierowa, tgt.EmailPodmiotu=src.EmailPodmiotu, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.SegmentacjaZISAR=src.SegmentacjaZISAR, tgt.NumerWlasny=src.NumerWlasny, tgt.PodpisanaCyfrowo=src.PodpisanaCyfrowo, tgt.DataPrzyjeciaDeklaracji=src.DataPrzyjeciaDeklaracji, tgt.DataRejestracjiDSK=src.DataRejestracjiDSK, tgt.DodatkowyEmail=src.DodatkowyEmail, tgt.IdDeklaracjiPTW=src.IdDeklaracjiPTW, tgt.MasaBrutto=src.MasaBrutto, tgt.NumerReferencyjnyPrzesylki=src.NumerReferencyjnyPrzesylki, tgt.IdOdbiorcyOsobaFizyczna=src.IdOdbiorcyOsobaFizyczna, tgt.IdOsobyFizycznejDoKontaktu=src.IdOsobyFizycznejDoKontaktu, tgt.IdPrzedstawicielaOsobyFizycznej=src.IdPrzedstawicielaOsobyFizycznej, tgt.IdSkladajacegoOsobaFizyczna=src.IdSkladajacegoOsobaFizyczna, tgt.IdOdbiorcyPodmiotGospodarczy=src.IdOdbiorcyPodmiotGospodarczy, tgt.IdPodmiotuGospodarczegoDoKontaktu=src.IdPodmiotuGospodarczegoDoKontaktu, tgt.IdPrzedstawicielaPodmiotuGospodarczego=src.IdPrzedstawicielaPodmiotuGospodarczego, tgt.IdSkladajacegoPodmiotGospodarczy=src.IdSkladajacegoPodmiotGospodarczy, tgt.KomunikatPodpisanyElektronicznie=src.KomunikatPodpisanyElektronicznie, tgt.IdMRZPTW=src.IdMRZPTW, tgt.ReferencjaDoZT=src.ReferencjaDoZT, tgt.StatusDeklaracji=src.StatusDeklaracji, tgt.UrzadCelnyDeklaracji=src.UrzadCelnyDeklaracji, tgt.UrzadCelnyDeklaracjiPid=src.UrzadCelnyDeklaracjiPid, tgt.UrzadCelnyNadzoru=src.UrzadCelnyNadzoru, tgt.UrzadCelnyNadzoruPid=src.UrzadCelnyNadzoruPid
WHEN NOT MATCHED
THEN INSERT (IdDok, TypDeklaracji, PodmiotAEO, EksportDanych, AwaryjnaRejestracja, FlagaDeklaracji, PrzyjetaRecznie, MRN, IdEwidencjaPapierowa, EmailPodmiotu, PlacowkaPodmiotu, SegmentacjaZISAR, NumerWlasny, PodpisanaCyfrowo, DataPrzyjeciaDeklaracji, DataRejestracjiDSK, DodatkowyEmail, IdDeklaracjiPTW, MasaBrutto, NumerReferencyjnyPrzesylki, IdOdbiorcyOsobaFizyczna, IdOsobyFizycznejDoKontaktu, IdPrzedstawicielaOsobyFizycznej, IdSkladajacegoOsobaFizyczna, IdOdbiorcyPodmiotGospodarczy, IdPodmiotuGospodarczegoDoKontaktu, IdPrzedstawicielaPodmiotuGospodarczego, IdSkladajacegoPodmiotGospodarczy, KomunikatPodpisanyElektronicznie, IdMRZPTW, ReferencjaDoZT, StatusDeklaracji, UrzadCelnyDeklaracji, UrzadCelnyDeklaracjiPid, UrzadCelnyNadzoru, UrzadCelnyNadzoruPid)
VALUES (src.IdDok, src.TypDeklaracji, src.PodmiotAEO, src.EksportDanych, src.AwaryjnaRejestracja, src.FlagaDeklaracji, src.PrzyjetaRecznie, src.MRN, src.IdEwidencjaPapierowa, src.EmailPodmiotu, src.PlacowkaPodmiotu, src.SegmentacjaZISAR, src.NumerWlasny, src.PodpisanaCyfrowo, src.DataPrzyjeciaDeklaracji, src.DataRejestracjiDSK, src.DodatkowyEmail, src.IdDeklaracjiPTW, src.MasaBrutto, src.NumerReferencyjnyPrzesylki, src.IdOdbiorcyOsobaFizyczna, src.IdOsobyFizycznejDoKontaktu, src.IdPrzedstawicielaOsobyFizycznej, src.IdSkladajacegoOsobaFizyczna, src.IdOdbiorcyPodmiotGospodarczy, src.IdPodmiotuGospodarczegoDoKontaktu, src.IdPrzedstawicielaPodmiotuGospodarczego, src.IdSkladajacegoPodmiotGospodarczy, src.KomunikatPodpisanyElektronicznie, src.IdMRZPTW, src.ReferencjaDoZT, src.StatusDeklaracji, src.UrzadCelnyDeklaracji, src.UrzadCelnyDeklaracjiPid, src.UrzadCelnyNadzoru, src.UrzadCelnyNadzoruPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_DokumentPoprzedni' BEGIN
MERGE INTO aimp2.DSK_DokumentPoprzedni AS tgt
USING WA_StageHurtownia.aimp2.DSK_DokumentPoprzedni AS src
ON (tgt.IdDokPoprzed=src.IdDokPoprzed)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDSK=src.IdTowarDSK, tgt.Kategoria=src.Kategoria, tgt.KategoriaPid=src.KategoriaPid, tgt.Kod=src.Kod, tgt.KodPid=src.KodPid, tgt.NumerPozycji=src.NumerPozycji, tgt.NumerDokumentu=src.NumerDokumentu
WHEN NOT MATCHED
THEN INSERT (IdDokPoprzed, IdTowarDSK, Kategoria, KategoriaPid, Kod, KodPid, NumerPozycji, NumerDokumentu)
VALUES (src.IdDokPoprzed, src.IdTowarDSK, src.Kategoria, src.KategoriaPid, src.Kod, src.KodPid, src.NumerPozycji, src.NumerDokumentu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_DokumentPoprzedniDeklaracja' BEGIN
MERGE INTO aimp2.DSK_DokumentPoprzedniDeklaracja AS tgt
USING WA_StageHurtownia.aimp2.DSK_DokumentPoprzedniDeklaracja AS src
ON (tgt.IdDokPoprzed=src.IdDokPoprzed)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.Kategoria=src.Kategoria, tgt.KategoriaPid=src.KategoriaPid, tgt.Kod=src.Kod, tgt.KodPid=src.KodPid, tgt.Numer=src.Numer
WHEN NOT MATCHED
THEN INSERT (IdDokPoprzed, IdDok, Kategoria, KategoriaPid, Kod, KodPid, Numer)
VALUES (src.IdDokPoprzed, src.IdDok, src.Kategoria, src.KategoriaPid, src.Kod, src.KodPid, src.Numer);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_DokumentWymagany' BEGIN
MERGE INTO aimp2.DSK_DokumentWymagany AS tgt
USING WA_StageHurtownia.aimp2.DSK_DokumentWymagany AS src
ON (tgt.IdDokWym=src.IdDokWym)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDSK=src.IdTowarDSK, tgt.Kod=src.Kod, tgt.KodPid=src.KodPid, tgt.Numer=src.Numer, tgt.Uwagi=src.Uwagi
WHEN NOT MATCHED
THEN INSERT (IdDokWym, IdTowarDSK, Kod, KodPid, Numer, Uwagi)
VALUES (src.IdDokWym, src.IdTowarDSK, src.Kod, src.KodPid, src.Numer, src.Uwagi);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_InformacjaDodatkowa' BEGIN
MERGE INTO aimp2.DSK_InformacjaDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.DSK_InformacjaDodatkowa AS src
ON (tgt.IdInfDod=src.IdInfDod)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.IdTowarDSK=src.IdTowarDSK, tgt.KodInfDodatk=src.KodInfDodatk, tgt.KodInfDodatkPid=src.KodInfDodatkPid, tgt.OpisInfDodatk=src.OpisInfDodatk
WHEN NOT MATCHED
THEN INSERT (IdInfDod, IdDok, IdTowarDSK, KodInfDodatk, KodInfDodatkPid, OpisInfDodatk)
VALUES (src.IdInfDod, src.IdDok, src.IdTowarDSK, src.KodInfDodatk, src.KodInfDodatkPid, src.OpisInfDodatk);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_Kontener' BEGIN
MERGE INTO aimp2.DSK_Kontener AS tgt
USING WA_StageHurtownia.aimp2.DSK_Kontener AS src
ON (tgt.IdKontenera=src.IdKontenera)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.NumerKontenera=src.NumerKontenera
WHEN NOT MATCHED
THEN INSERT (IdKontenera, IdDok, NumerKontenera)
VALUES (src.IdKontenera, src.IdDok, src.NumerKontenera);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_LokalizacjaTowarow' BEGIN
MERGE INTO aimp2.DSK_LokalizacjaTowarow AS tgt
USING WA_StageHurtownia.aimp2.DSK_LokalizacjaTowarow AS src
ON (tgt.IdLokalizacji=src.IdLokalizacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.DodatkowyIdLokalizacji=src.DodatkowyIdLokalizacji, tgt.KodUrzeduSkladujacegoTowar=src.KodUrzeduSkladujacegoTowar, tgt.KodUrzeduSkladujacegoTowarPid=src.KodUrzeduSkladujacegoTowarPid, tgt.KodMiejscaLokalizacjiTowaru=src.KodMiejscaLokalizacjiTowaru, tgt.KodMiejscaLokalizacjiTowaruPid=src.KodMiejscaLokalizacjiTowaruPid, tgt.KrajMiejscaLokalizacjiTowaru=src.KrajMiejscaLokalizacjiTowaru, tgt.KrajMiejscaLokalizacjiTowaruPid=src.KrajMiejscaLokalizacjiTowaruPid, tgt.KwalifikatorLokalizacji=src.KwalifikatorLokalizacji, tgt.KwalifikatorLokalizacjiPid=src.KwalifikatorLokalizacjiPid, tgt.OpisMiejscaLokalizacjiTowaru=src.OpisMiejscaLokalizacjiTowaru, tgt.TypLokalizacji=src.TypLokalizacji, tgt.TypLokalizacjiPid=src.TypLokalizacjiPid
WHEN NOT MATCHED
THEN INSERT (IdLokalizacji, IdDok, DodatkowyIdLokalizacji, KodUrzeduSkladujacegoTowar, KodUrzeduSkladujacegoTowarPid, KodMiejscaLokalizacjiTowaru, KodMiejscaLokalizacjiTowaruPid, KrajMiejscaLokalizacjiTowaru, KrajMiejscaLokalizacjiTowaruPid, KwalifikatorLokalizacji, KwalifikatorLokalizacjiPid, OpisMiejscaLokalizacjiTowaru, TypLokalizacji, TypLokalizacjiPid)
VALUES (src.IdLokalizacji, src.IdDok, src.DodatkowyIdLokalizacji, src.KodUrzeduSkladujacegoTowar, src.KodUrzeduSkladujacegoTowarPid, src.KodMiejscaLokalizacjiTowaru, src.KodMiejscaLokalizacjiTowaruPid, src.KrajMiejscaLokalizacjiTowaru, src.KrajMiejscaLokalizacjiTowaruPid, src.KwalifikatorLokalizacji, src.KwalifikatorLokalizacjiPid, src.OpisMiejscaLokalizacjiTowaru, src.TypLokalizacji, src.TypLokalizacjiPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_OdmowaSkladowania' BEGIN
MERGE INTO aimp2.DSK_OdmowaSkladowania AS tgt
USING WA_StageHurtownia.aimp2.DSK_OdmowaSkladowania AS src
ON (tgt.IdOdmowy=src.IdOdmowy)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDSK=src.IdTowarDSK, tgt.OpisNieprawidlowosci=src.OpisNieprawidlowosci, tgt.TrescUzasadnienia=src.TrescUzasadnienia
WHEN NOT MATCHED
THEN INSERT (IdOdmowy, IdTowarDSK, OpisNieprawidlowosci, TrescUzasadnienia)
VALUES (src.IdOdmowy, src.IdTowarDSK, src.OpisNieprawidlowosci, src.TrescUzasadnienia);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_Opakowanie' BEGIN
MERGE INTO aimp2.DSK_Opakowanie AS tgt
USING WA_StageHurtownia.aimp2.DSK_Opakowanie AS src
ON (tgt.IdOpakowania=src.IdOpakowania)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDSK=src.IdTowarDSK, tgt.LiczbaOpakowan=src.LiczbaOpakowan, tgt.NumeryZnakiOpakowania=src.NumeryZnakiOpakowania, tgt.RodzajOpakowania=src.RodzajOpakowania, tgt.RodzajOpakowaniaPid=src.RodzajOpakowaniaPid
WHEN NOT MATCHED
THEN INSERT (IdOpakowania, IdTowarDSK, LiczbaOpakowan, NumeryZnakiOpakowania, RodzajOpakowania, RodzajOpakowaniaPid)
VALUES (src.IdOpakowania, src.IdTowarDSK, src.LiczbaOpakowan, src.NumeryZnakiOpakowania, src.RodzajOpakowania, src.RodzajOpakowaniaPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_OsobaFizyczna' BEGIN
MERGE INTO aimp2.DSK_OsobaFizyczna AS tgt
USING WA_StageHurtownia.aimp2.DSK_OsobaFizyczna AS src
ON (tgt.IdOsobyFizycznej=src.IdOsobyFizycznej)
WHEN MATCHED
THEN UPDATE SET
tgt.IdAdresu=src.IdAdresu, tgt.Imie=src.Imie, tgt.Nazwisko=src.Nazwisko, tgt.NumerIdentyfikacyjny=src.NumerIdentyfikacyjny, tgt.PESEL=src.PESEL, tgt.Placowka=src.Placowka, tgt.RodzajPrzedstawicielstwa=src.RodzajPrzedstawicielstwa, tgt.RodzajPrzedstawicielstwaPid=src.RodzajPrzedstawicielstwaPid
WHEN NOT MATCHED
THEN INSERT (IdOsobyFizycznej, IdAdresu, Imie, Nazwisko, NumerIdentyfikacyjny, PESEL, Placowka, RodzajPrzedstawicielstwa, RodzajPrzedstawicielstwaPid)
VALUES (src.IdOsobyFizycznej, src.IdAdresu, src.Imie, src.Nazwisko, src.NumerIdentyfikacyjny, src.PESEL, src.Placowka, src.RodzajPrzedstawicielstwa, src.RodzajPrzedstawicielstwaPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_PodmiotGospodarczy' BEGIN
MERGE INTO aimp2.DSK_PodmiotGospodarczy AS tgt
USING WA_StageHurtownia.aimp2.DSK_PodmiotGospodarczy AS src
ON (tgt.IdPodmiotuGospodarczego=src.IdPodmiotuGospodarczego)
WHEN MATCHED
THEN UPDATE SET
tgt.IdGrupyCertyfAEO=src.IdGrupyCertyfAEO, tgt.IdAdresu=src.IdAdresu, tgt.Email=src.Email, tgt.EORI=src.EORI, tgt.NazwaPodmiotu=src.NazwaPodmiotu, tgt.InnyNumerIdentyfikPodmiotu=src.InnyNumerIdentyfikPodmiotu, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.REGON=src.REGON, tgt.RodzajPrzedstawicielstwa=src.RodzajPrzedstawicielstwa, tgt.RodzajPrzedstawicielstwaPid=src.RodzajPrzedstawicielstwaPid, tgt.TIN=src.TIN
WHEN NOT MATCHED
THEN INSERT (IdPodmiotuGospodarczego, IdGrupyCertyfAEO, IdAdresu, Email, EORI, NazwaPodmiotu, InnyNumerIdentyfikPodmiotu, PlacowkaPodmiotu, REGON, RodzajPrzedstawicielstwa, RodzajPrzedstawicielstwaPid, TIN)
VALUES (src.IdPodmiotuGospodarczego, src.IdGrupyCertyfAEO, src.IdAdresu, src.Email, src.EORI, src.NazwaPodmiotu, src.InnyNumerIdentyfikPodmiotu, src.PlacowkaPodmiotu, src.REGON, src.RodzajPrzedstawicielstwa, src.RodzajPrzedstawicielstwaPid, src.TIN);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_PodmiotLancuchDostawDeklaracja' BEGIN
MERGE INTO aimp2.DSK_PodmiotLancuchDostawDeklaracja AS tgt
USING WA_StageHurtownia.aimp2.DSK_PodmiotLancuchDostawDeklaracja AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.IdPodmiotu=src.IdPodmiotu, tgt.RolaPodmiotu=src.RolaPodmiotu
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdDok, IdPodmiotu, RolaPodmiotu)
VALUES (src.IdWpisu, src.IdDok, src.IdPodmiotu, src.RolaPodmiotu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_PodmiotLancuchDostawTowar' BEGIN
MERGE INTO aimp2.DSK_PodmiotLancuchDostawTowar AS tgt
USING WA_StageHurtownia.aimp2.DSK_PodmiotLancuchDostawTowar AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDSK=src.IdTowarDSK, tgt.NumerIdDodatkowegoAktora=src.NumerIdDodatkowegoAktora, tgt.RolaPodmiot=src.RolaPodmiot
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdTowarDSK, NumerIdDodatkowegoAktora, RolaPodmiot)
VALUES (src.IdWpisu, src.IdTowarDSK, src.NumerIdDodatkowegoAktora, src.RolaPodmiot);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_PodpisujacyDokument' BEGIN
MERGE INTO aimp2.DSK_PodpisujacyDokument AS tgt
USING WA_StageHurtownia.aimp2.DSK_PodpisujacyDokument AS src
ON (tgt.IdPodpisujacego=src.IdPodpisujacego)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.DataWpisuNaListeAgentowCelnych=src.DataWpisuNaListeAgentowCelnych, tgt.NumerWpisuNaListeAgentowCelnych=src.NumerWpisuNaListeAgentowCelnych, tgt.EmailOsobyPodpisujacej=src.EmailOsobyPodpisujacej, tgt.ImieOsobyPodpisujacej=src.ImieOsobyPodpisujacej, tgt.NazwiskoOsobyPodpisujacej=src.NazwiskoOsobyPodpisujacej, tgt.TrescPouczenia=src.TrescPouczenia, tgt.NumerTelefonuOsobyPodpisujacej=src.NumerTelefonuOsobyPodpisujacej
WHEN NOT MATCHED
THEN INSERT (IdPodpisujacego, IdDok, DataWpisuNaListeAgentowCelnych, NumerWpisuNaListeAgentowCelnych, EmailOsobyPodpisujacej, ImieOsobyPodpisujacej, NazwiskoOsobyPodpisujacej, TrescPouczenia, NumerTelefonuOsobyPodpisujacej)
VALUES (src.IdPodpisujacego, src.IdDok, src.DataWpisuNaListeAgentowCelnych, src.NumerWpisuNaListeAgentowCelnych, src.EmailOsobyPodpisujacej, src.ImieOsobyPodpisujacej, src.NazwiskoOsobyPodpisujacej, src.TrescPouczenia, src.NumerTelefonuOsobyPodpisujacej);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_Towar' BEGIN
MERGE INTO aimp2.DSK_Towar AS tgt
USING WA_StageHurtownia.aimp2.DSK_Towar AS src
ON (tgt.IdPozycji=src.IdPozycji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.IdPozycjiPTW=src.IdPozycjiPTW, tgt.IloscTowaru=src.IloscTowaru, tgt.JednostkaMiary=src.JednostkaMiary, tgt.JednostkaMiaryPid=src.JednostkaMiaryPid, tgt.KodCUS=src.KodCUS, tgt.KodTowarowy=src.KodTowarowy, tgt.MasaBrutto=src.MasaBrutto, tgt.MasaNetto=src.MasaNetto, tgt.NumerPozycji=src.NumerPozycji, tgt.NumerReferencyjnyPrzesylki=src.NumerReferencyjnyPrzesylki, tgt.IdOdbiorcyOsobaFizyczna=src.IdOdbiorcyOsobaFizyczna, tgt.OpisNieprawidlowosci=src.OpisNieprawidlowosci, tgt.OpisTowaru=src.OpisTowaru, tgt.IdOdbiorcyPodmiotGospodarczy=src.IdOdbiorcyPodmiotGospodarczy, tgt.Przeterminowanie=src.Przeterminowanie, tgt.OdniesienieDoZT=src.OdniesienieDoZT, tgt.StatusPozycjiDSK=src.StatusPozycjiDSK, tgt.AktualnyTerminCzasowegoSkladowania=src.AktualnyTerminCzasowegoSkladowania, tgt.UwagiDoTowaru=src.UwagiDoTowaru, tgt.WynikKontroli=src.WynikKontroli, tgt.Zabezpieczono=src.Zabezpieczono
WHEN NOT MATCHED
THEN INSERT (IdPozycji, IdDok, IdPozycjiPTW, IloscTowaru, JednostkaMiary, JednostkaMiaryPid, KodCUS, KodTowarowy, MasaBrutto, MasaNetto, NumerPozycji, NumerReferencyjnyPrzesylki, IdOdbiorcyOsobaFizyczna, OpisNieprawidlowosci, OpisTowaru, IdOdbiorcyPodmiotGospodarczy, Przeterminowanie, OdniesienieDoZT, StatusPozycjiDSK, AktualnyTerminCzasowegoSkladowania, UwagiDoTowaru, WynikKontroli, Zabezpieczono)
VALUES (src.IdPozycji, src.IdDok, src.IdPozycjiPTW, src.IloscTowaru, src.JednostkaMiary, src.JednostkaMiaryPid, src.KodCUS, src.KodTowarowy, src.MasaBrutto, src.MasaNetto, src.NumerPozycji, src.NumerReferencyjnyPrzesylki, src.IdOdbiorcyOsobaFizyczna, src.OpisNieprawidlowosci, src.OpisTowaru, src.IdOdbiorcyPodmiotGospodarczy, src.Przeterminowanie, src.OdniesienieDoZT, src.StatusPozycjiDSK, src.AktualnyTerminCzasowegoSkladowania, src.UwagiDoTowaru, src.WynikKontroli, src.Zabezpieczono);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_TowarKontener' BEGIN
MERGE INTO aimp2.DSK_TowarKontener AS tgt
USING WA_StageHurtownia.aimp2.DSK_TowarKontener AS src
ON (tgt.IdKontenera=src.IdKontenera)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDSK=src.IdTowarDSK, tgt.NumerKontenera=src.NumerKontenera
WHEN NOT MATCHED
THEN INSERT (IdKontenera, IdTowarDSK, NumerKontenera)
VALUES (src.IdKontenera, src.IdTowarDSK, src.NumerKontenera);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_Transport' BEGIN
MERGE INTO aimp2.DSK_Transport AS tgt
USING WA_StageHurtownia.aimp2.DSK_Transport AS src
ON (tgt.IdTransportu=src.IdTransportu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.OznaczenieSrodkaTransportuPrzybycie=src.OznaczenieSrodkaTransportuPrzybycie, tgt.OznaczenieSrodkaTransportuPrzybyciePid=src.OznaczenieSrodkaTransportuPrzybyciePid, tgt.ZnakiSrodkaTransportuPrzybycie=src.ZnakiSrodkaTransportuPrzybycie
WHEN NOT MATCHED
THEN INSERT (IdTransportu, IdDok, OznaczenieSrodkaTransportuPrzybycie, OznaczenieSrodkaTransportuPrzybyciePid, ZnakiSrodkaTransportuPrzybycie)
VALUES (src.IdTransportu, src.IdDok, src.OznaczenieSrodkaTransportuPrzybycie, src.OznaczenieSrodkaTransportuPrzybyciePid, src.ZnakiSrodkaTransportuPrzybycie);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_UniewaznienieTowaru' BEGIN
MERGE INTO aimp2.DSK_UniewaznienieTowaru AS tgt
USING WA_StageHurtownia.aimp2.DSK_UniewaznienieTowaru AS src
ON (tgt.IdUniewaznienia=src.IdUniewaznienia)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDSK=src.IdTowarDSK, tgt.MRN=src.MRN, tgt.NumerPozycji=src.NumerPozycji, tgt.StatusUniewaznienia=src.StatusUniewaznienia, tgt.TrescUzasadnienia=src.TrescUzasadnienia
WHEN NOT MATCHED
THEN INSERT (IdUniewaznienia, IdTowarDSK, MRN, NumerPozycji, StatusUniewaznienia, TrescUzasadnienia)
VALUES (src.IdUniewaznienia, src.IdTowarDSK, src.MRN, src.NumerPozycji, src.StatusUniewaznienia, src.TrescUzasadnienia);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_ZamkniecieCelne' BEGIN
MERGE INTO aimp2.DSK_ZamkniecieCelne AS tgt
USING WA_StageHurtownia.aimp2.DSK_ZamkniecieCelne AS src
ON (tgt.IdZamkniecia=src.IdZamkniecia)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.IloscZamkniecCelnych=src.IloscZamkniecCelnych, tgt.RodzajZamkniecCelnych=src.RodzajZamkniecCelnych, tgt.RodzajZamkniecCelnychPid=src.RodzajZamkniecCelnychPid
WHEN NOT MATCHED
THEN INSERT (IdZamkniecia, IdDok, IloscZamkniecCelnych, RodzajZamkniecCelnych, RodzajZamkniecCelnychPid)
VALUES (src.IdZamkniecia, src.IdDok, src.IloscZamkniecCelnych, src.RodzajZamkniecCelnych, src.RodzajZamkniecCelnychPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DSK_ZamkniecieCelneNumery' BEGIN
MERGE INTO aimp2.DSK_ZamkniecieCelneNumery AS tgt
USING WA_StageHurtownia.aimp2.DSK_ZamkniecieCelneNumery AS src
ON (tgt.IdNumeru=src.IdNumeru)
WHEN MATCHED
THEN UPDATE SET
tgt.IdZamknieciaCelnego=src.IdZamknieciaCelnego, tgt.NumerZamknieciaCelnego=src.NumerZamknieciaCelnego
WHEN NOT MATCHED
THEN INSERT (IdNumeru, IdZamknieciaCelnego, NumerZamknieciaCelnego)
VALUES (src.IdNumeru, src.IdZamknieciaCelnego, src.NumerZamknieciaCelnego);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_DaneARR' BEGIN
MERGE INTO aimp2.PWD_DaneARR AS tgt
USING WA_StageHurtownia.aimp2.PWD_DaneARR AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarPWD=src.IdTowarPWD, tgt.IloscDodatkowa=src.IloscDodatkowa, tgt.PozwolenieWazneDo=src.PozwolenieWazneDo, tgt.StatusSalda=src.StatusSalda, tgt.DataWeryfikacji=src.DataWeryfikacji, tgt.OpisRozbieznosci=src.OpisRozbieznosci, tgt.NrPozwolenia=src.NrPozwolenia, tgt.Ilosc=src.Ilosc, tgt.DodatkJednMiary=src.DodatkJednMiary, tgt.KwalifikatorDodatkUzupJednMiary=src.KwalifikatorDodatkUzupJednMiary, tgt.JednostkaMiary=src.JednostkaMiary, tgt.KwalifikatorJednostkiMiary=src.KwalifikatorJednostkiMiary, tgt.IdWywolania=src.IdWywolania
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdTowarPWD, IloscDodatkowa, PozwolenieWazneDo, StatusSalda, DataWeryfikacji, OpisRozbieznosci, NrPozwolenia, Ilosc, DodatkJednMiary, KwalifikatorDodatkUzupJednMiary, JednostkaMiary, KwalifikatorJednostkiMiary, IdWywolania)
VALUES (src.IdWpisu, src.IdTowarPWD, src.IloscDodatkowa, src.PozwolenieWazneDo, src.StatusSalda, src.DataWeryfikacji, src.OpisRozbieznosci, src.NrPozwolenia, src.Ilosc, src.DodatkJednMiary, src.KwalifikatorDodatkUzupJednMiary, src.JednostkaMiary, src.KwalifikatorJednostkiMiary, src.IdWywolania);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_DefinicjaKontyngentu' BEGIN
MERGE INTO aimp2.PWD_DefinicjaKontyngentu AS tgt
USING WA_StageHurtownia.aimp2.PWD_DefinicjaKontyngentu AS src
ON (tgt.IdDefinicji=src.IdDefinicji)
WHEN MATCHED
THEN UPDATE SET
tgt.BalansKontyngentu=src.BalansKontyngentu, tgt.ZablokowanyOd=src.ZablokowanyOd, tgt.ZablokowanyDo=src.ZablokowanyDo, tgt.ProgStanuKrytycznego=src.ProgStanuKrytycznego, tgt.KodWaluty=src.KodWaluty, tgt.KodWalutyPid=src.KodWalutyPid, tgt.DataAktualizacji=src.DataAktualizacji, tgt.WartoscPoczatkowaKontyngentu=src.WartoscPoczatkowaKontyngentu, tgt.ZablokowanyZawieszony=src.ZablokowanyZawieszony, tgt.StanKrytyczny=src.StanKrytyczny, tgt.Wyczerpany=src.Wyczerpany, tgt.NrPozycjiTowarowej=src.NrPozycjiTowarowej, tgt.KwalifikatorJednostkiMiary=src.KwalifikatorJednostkiMiary, tgt.JednostkaMiary=src.JednostkaMiary, tgt.KontyngentWaznyOd=src.KontyngentWaznyOd, tgt.KontyngentWaznyDo=src.KontyngentWaznyDo
WHEN NOT MATCHED
THEN INSERT (IdDefinicji, BalansKontyngentu, ZablokowanyOd, ZablokowanyDo, ProgStanuKrytycznego, KodWaluty, KodWalutyPid, DataAktualizacji, WartoscPoczatkowaKontyngentu, ZablokowanyZawieszony, StanKrytyczny, Wyczerpany, NrPozycjiTowarowej, KwalifikatorJednostkiMiary, JednostkaMiary, KontyngentWaznyOd, KontyngentWaznyDo)
VALUES (src.IdDefinicji, src.BalansKontyngentu, src.ZablokowanyOd, src.ZablokowanyDo, src.ProgStanuKrytycznego, src.KodWaluty, src.KodWalutyPid, src.DataAktualizacji, src.WartoscPoczatkowaKontyngentu, src.ZablokowanyZawieszony, src.StanKrytyczny, src.Wyczerpany, src.NrPozycjiTowarowej, src.KwalifikatorJednostkiMiary, src.JednostkaMiary, src.KontyngentWaznyOd, src.KontyngentWaznyDo);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_Dokument' BEGIN
MERGE INTO aimp2.PWD_Dokument AS tgt
USING WA_StageHurtownia.aimp2.PWD_Dokument AS src
ON (tgt.IdDok=src.IdDok)
WHEN MATCHED
THEN UPDATE SET
tgt.TypDeklaracji=src.TypDeklaracji, tgt.PodmiotAEO=src.PodmiotAEO, tgt.EksportDanych=src.EksportDanych, tgt.AwaryjnaRejestracja=src.AwaryjnaRejestracja, tgt.FlagaDeklaracji=src.FlagaDeklaracji, tgt.PrzyjetaRecznie=src.PrzyjetaRecznie, tgt.MRN=src.MRN, tgt.IdEwidencjaPapierowa=src.IdEwidencjaPapierowa, tgt.EmailPodmiotu=src.EmailPodmiotu, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.SegmentacjaZISAR=src.SegmentacjaZISAR, tgt.NumerWlasny=src.NumerWlasny, tgt.PodpisanaCyfrowo=src.PodpisanaCyfrowo, tgt.DataPrzyjecia=src.DataPrzyjecia, tgt.DodatkowyTypZgloszenia=src.DodatkowyTypZgloszenia, tgt.DodatkowyTypZgloszeniaPid=src.DodatkowyTypZgloszeniaPid, tgt.DataKalkulacji=src.DataKalkulacji, tgt.DataAnulowania=src.DataAnulowania, tgt.CzyKontenery=src.CzyKontenery, tgt.UrzadCelnyKontrolny=src.UrzadCelnyKontrolny, tgt.UrzadCelnyKontrolnyPid=src.UrzadCelnyKontrolnyPid, tgt.KrajPrzeznaczenia=src.KrajPrzeznaczenia, tgt.KrajPrzeznaczeniaPid=src.KrajPrzeznaczeniaPid, tgt.KrajPrzeznaczeniaRegion=src.KrajPrzeznaczeniaRegion, tgt.KrajPrzeznaczeniaRegionPid=src.KrajPrzeznaczeniaRegionPid, tgt.KrajWysylki=src.KrajWysylki, tgt.KrajWysylkiPid=src.KrajWysylkiPid, tgt.KodWaluty=src.KodWaluty, tgt.KodWalutyPid=src.KodWalutyPid, tgt.UrzadCelnyZgloszenia=src.UrzadCelnyZgloszenia, tgt.UrzadCelnyZgloszeniaPid=src.UrzadCelnyZgloszeniaPid, tgt.PlatnoscOdroczona=src.PlatnoscOdroczona, tgt.DataWydaniaPrzesylkiDPZ=src.DataWydaniaPrzesylkiDPZ, tgt.WynikiKontroliDPZ=src.WynikiKontroliDPZ, tgt.NumerPrzesylkiDPZ=src.NumerPrzesylkiDPZ, tgt.DataPowiadomieniaDlugDPZ=src.DataPowiadomieniaDlugDPZ, tgt.ZwyklyPocztowyDPZ=src.ZwyklyPocztowyDPZ, tgt.TypZabezpieczeniaDPZ=src.TypZabezpieczeniaDPZ, tgt.OplacenieZabezpieczenieNaleznosci=src.OplacenieZabezpieczenieNaleznosci, tgt.SposobUregulowaniaTowaruDPZ=src.SposobUregulowaniaTowaruDPZ, tgt.DataZwolnieniaDPZ=src.DataZwolnieniaDPZ, tgt.PodpisElektroniczny=src.PodpisElektroniczny, tgt.StatusObslugiEMCS=src.StatusObslugiEMCS, tgt.UrzadCelnyWprowadzania=src.UrzadCelnyWprowadzania, tgt.UrzadCelnyWprowadzaniaPid=src.UrzadCelnyWprowadzaniaPid, tgt.MasaBrutto=src.MasaBrutto, tgt.IdDanychCelnychPTW=src.IdDanychCelnychPTW, tgt.TypDokumentu=src.TypDokumentu, tgt.TypDokumentuPid=src.TypDokumentuPid, tgt.AdnotacjePrawne=src.AdnotacjePrawne, tgt.LiczbaPozycjiTowarowych=src.LiczbaPozycjiTowarowych, tgt.NumerPozwolenia=src.NumerPozwolenia, tgt.LiczbaOpakowan=src.LiczbaOpakowan, tgt.NumerReferencyjnyPrzesylki=src.NumerReferencyjnyPrzesylki, tgt.DataPrzedstawieniaTowaru=src.DataPrzedstawieniaTowaru, tgt.PrzedstawienieTowaru=src.PrzedstawienieTowaru, tgt.UrzadCelnyPrzedstawieniaTowaru=src.UrzadCelnyPrzedstawieniaTowaru, tgt.NumerDokPoprzedniego=src.NumerDokPoprzedniego, tgt.ZawartoscZC213ObslugaSprostowania=src.ZawartoscZC213ObslugaSprostowania, tgt.DataRejestracji=src.DataRejestracji, tgt.NumerRejestru=src.NumerRejestru, tgt.TerminZwolnieniaTowaru=src.TerminZwolnieniaTowaru, tgt.DataOdrzucenia=src.DataOdrzucenia, tgt.OgolnaWartoscFaktur=src.OgolnaWartoscFaktur, tgt.CzyWyslanodeklaracjeDoTQS=src.CzyWyslanodeklaracjeDoTQS, tgt.LicznikWysylkiDoTQS=src.LicznikWysylkiDoTQS, tgt.IdZgloszeniaUZP=src.IdZgloszeniaUZP, tgt.DanePokontrolne=src.DanePokontrolne, tgt.TypZgloszenia=src.TypZgloszenia, tgt.OsobaPodpisujacaDokument=src.OsobaPodpisujacaDokument, tgt.StatusDeklaracjiZCP=src.StatusDeklaracjiZCP, tgt.NumerSystemowyAIS=src.NumerSystemowyAIS, tgt.DataGranicznaZlozeniaZgloszeniaUZP=src.DataGranicznaZlozeniaZgloszeniaUZP, tgt.VAT7=src.VAT7, tgt.PowodAnulowaniaZgloszenia=src.PowodAnulowaniaZgloszenia, tgt.CzasNaPrzeslaniePowiadomPrzywoz=src.CzasNaPrzeslaniePowiadomPrzywoz, tgt.CzasNaPrzeslaniePowiadomPrzybycie=src.CzasNaPrzeslaniePowiadomPrzybycie, tgt.OczekujeNaIE025=src.OczekujeNaIE025, tgt.JednostkaCzasuDecyzjePrzywoz=src.JednostkaCzasuDecyzjePrzywoz, tgt.JednostkaCzasuPowiadomPrzybycie=src.JednostkaCzasuPowiadomPrzybycie, tgt.WyslanoZgloszenieTQS=src.WyslanoZgloszenieTQS
WHEN NOT MATCHED
THEN INSERT (IdDok, TypDeklaracji, PodmiotAEO, EksportDanych, AwaryjnaRejestracja, FlagaDeklaracji, PrzyjetaRecznie, MRN, IdEwidencjaPapierowa, EmailPodmiotu, PlacowkaPodmiotu, SegmentacjaZISAR, NumerWlasny, PodpisanaCyfrowo, DataPrzyjecia, DodatkowyTypZgloszenia, DodatkowyTypZgloszeniaPid, DataKalkulacji, DataAnulowania, CzyKontenery, UrzadCelnyKontrolny, UrzadCelnyKontrolnyPid, KrajPrzeznaczenia, KrajPrzeznaczeniaPid, KrajPrzeznaczeniaRegion, KrajPrzeznaczeniaRegionPid, KrajWysylki, KrajWysylkiPid, KodWaluty, KodWalutyPid, UrzadCelnyZgloszenia, UrzadCelnyZgloszeniaPid, PlatnoscOdroczona, DataWydaniaPrzesylkiDPZ, WynikiKontroliDPZ, NumerPrzesylkiDPZ, DataPowiadomieniaDlugDPZ, ZwyklyPocztowyDPZ, TypZabezpieczeniaDPZ, OplacenieZabezpieczenieNaleznosci, SposobUregulowaniaTowaruDPZ, DataZwolnieniaDPZ, PodpisElektroniczny, StatusObslugiEMCS, UrzadCelnyWprowadzania, UrzadCelnyWprowadzaniaPid, MasaBrutto, IdDanychCelnychPTW, TypDokumentu, TypDokumentuPid, AdnotacjePrawne, LiczbaPozycjiTowarowych, NumerPozwolenia, LiczbaOpakowan, NumerReferencyjnyPrzesylki, DataPrzedstawieniaTowaru, PrzedstawienieTowaru, UrzadCelnyPrzedstawieniaTowaru, NumerDokPoprzedniego, ZawartoscZC213ObslugaSprostowania, DataRejestracji, NumerRejestru, TerminZwolnieniaTowaru, DataOdrzucenia, OgolnaWartoscFaktur, CzyWyslanodeklaracjeDoTQS, LicznikWysylkiDoTQS, IdZgloszeniaUZP, DanePokontrolne, TypZgloszenia, OsobaPodpisujacaDokument, StatusDeklaracjiZCP, NumerSystemowyAIS, DataGranicznaZlozeniaZgloszeniaUZP, VAT7, PowodAnulowaniaZgloszenia, CzasNaPrzeslaniePowiadomPrzywoz, CzasNaPrzeslaniePowiadomPrzybycie, OczekujeNaIE025, JednostkaCzasuDecyzjePrzywoz, JednostkaCzasuPowiadomPrzybycie, WyslanoZgloszenieTQS)
VALUES (src.IdDok, src.TypDeklaracji, src.PodmiotAEO, src.EksportDanych, src.AwaryjnaRejestracja, src.FlagaDeklaracji, src.PrzyjetaRecznie, src.MRN, src.IdEwidencjaPapierowa, src.EmailPodmiotu, src.PlacowkaPodmiotu, src.SegmentacjaZISAR, src.NumerWlasny, src.PodpisanaCyfrowo, src.DataPrzyjecia, src.DodatkowyTypZgloszenia, src.DodatkowyTypZgloszeniaPid, src.DataKalkulacji, src.DataAnulowania, src.CzyKontenery, src.UrzadCelnyKontrolny, src.UrzadCelnyKontrolnyPid, src.KrajPrzeznaczenia, src.KrajPrzeznaczeniaPid, src.KrajPrzeznaczeniaRegion, src.KrajPrzeznaczeniaRegionPid, src.KrajWysylki, src.KrajWysylkiPid, src.KodWaluty, src.KodWalutyPid, src.UrzadCelnyZgloszenia, src.UrzadCelnyZgloszeniaPid, src.PlatnoscOdroczona, src.DataWydaniaPrzesylkiDPZ, src.WynikiKontroliDPZ, src.NumerPrzesylkiDPZ, src.DataPowiadomieniaDlugDPZ, src.ZwyklyPocztowyDPZ, src.TypZabezpieczeniaDPZ, src.OplacenieZabezpieczenieNaleznosci, src.SposobUregulowaniaTowaruDPZ, src.DataZwolnieniaDPZ, src.PodpisElektroniczny, src.StatusObslugiEMCS, src.UrzadCelnyWprowadzania, src.UrzadCelnyWprowadzaniaPid, src.MasaBrutto, src.IdDanychCelnychPTW, src.TypDokumentu, src.TypDokumentuPid, src.AdnotacjePrawne, src.LiczbaPozycjiTowarowych, src.NumerPozwolenia, src.LiczbaOpakowan, src.NumerReferencyjnyPrzesylki, src.DataPrzedstawieniaTowaru, src.PrzedstawienieTowaru, src.UrzadCelnyPrzedstawieniaTowaru, src.NumerDokPoprzedniego, src.ZawartoscZC213ObslugaSprostowania, src.DataRejestracji, src.NumerRejestru, src.TerminZwolnieniaTowaru, src.DataOdrzucenia, src.OgolnaWartoscFaktur, src.CzyWyslanodeklaracjeDoTQS, src.LicznikWysylkiDoTQS, src.IdZgloszeniaUZP, src.DanePokontrolne, src.TypZgloszenia, src.OsobaPodpisujacaDokument, src.StatusDeklaracjiZCP, src.NumerSystemowyAIS, src.DataGranicznaZlozeniaZgloszeniaUZP, src.VAT7, src.PowodAnulowaniaZgloszenia, src.CzasNaPrzeslaniePowiadomPrzywoz, src.CzasNaPrzeslaniePowiadomPrzybycie, src.OczekujeNaIE025, src.JednostkaCzasuDecyzjePrzywoz, src.JednostkaCzasuPowiadomPrzybycie, src.WyslanoZgloszenieTQS);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_DokumentPoprzedni' BEGIN
MERGE INTO aimp2.PWD_DokumentPoprzedni AS tgt
USING WA_StageHurtownia.aimp2.PWD_DokumentPoprzedni AS src
ON (tgt.IdDokPoprzed=src.IdDokPoprzed)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarPWD=src.IdTowarPWD, tgt.Kategoria=src.Kategoria, tgt.KategoriaPid=src.KategoriaPid, tgt.KodDokPoprz=src.KodDokPoprz, tgt.KodDokPoprzPid=src.KodDokPoprzPid, tgt.Numer=src.Numer, tgt.NumerDokumentu=src.NumerDokumentu, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdDokPoprzed, IdTowarPWD, Kategoria, KategoriaPid, KodDokPoprz, KodDokPoprzPid, Numer, NumerDokumentu, DanePokontrolne)
VALUES (src.IdDokPoprzed, src.IdTowarPWD, src.Kategoria, src.KategoriaPid, src.KodDokPoprz, src.KodDokPoprzPid, src.Numer, src.NumerDokumentu, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_DokumentPoprzedniPozycje' BEGIN
MERGE INTO aimp2.PWD_DokumentPoprzedniPozycje AS tgt
USING WA_StageHurtownia.aimp2.PWD_DokumentPoprzedniPozycje AS src
ON (tgt.IdPozycjiDokPoprzed=src.IdPozycjiDokPoprzed)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDokPoprzed=src.IdDokPoprzed, tgt.NumerPozycji=src.NumerPozycji
WHEN NOT MATCHED
THEN INSERT (IdPozycjiDokPoprzed, IdDokPoprzed, NumerPozycji)
VALUES (src.IdPozycjiDokPoprzed, src.IdDokPoprzed, src.NumerPozycji);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_DokumentWymagany' BEGIN
MERGE INTO aimp2.PWD_DokumentWymagany AS tgt
USING WA_StageHurtownia.aimp2.PWD_DokumentWymagany AS src
ON (tgt.IdDokWym=src.IdDokWym)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarPWD=src.IdTowarPWD, tgt.AGRIMOpisNiezgodnosci=src.AGRIMOpisNiezgodnosci, tgt.AGRIMWynik=src.AGRIMWynik, tgt.KodDokumentu=src.KodDokumentu, tgt.KodDokumentuPid=src.KodDokumentuPid, tgt.UwagiDoDokumentu=src.UwagiDoDokumentu, tgt.NumerDokumentu=src.NumerDokumentu, tgt.DataWygasniecia=src.DataWygasniecia, tgt.NazwaInstytucji=src.NazwaInstytucji, tgt.IloscTowaru=src.IloscTowaru, tgt.NumerPozycji=src.NumerPozycji, tgt.JednostkaMiary=src.JednostkaMiary, tgt.JednostkaMiaryPid=src.JednostkaMiaryPid, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdDokWym, IdTowarPWD, AGRIMOpisNiezgodnosci, AGRIMWynik, KodDokumentu, KodDokumentuPid, UwagiDoDokumentu, NumerDokumentu, DataWygasniecia, NazwaInstytucji, IloscTowaru, NumerPozycji, JednostkaMiary, JednostkaMiaryPid, DanePokontrolne)
VALUES (src.IdDokWym, src.IdTowarPWD, src.AGRIMOpisNiezgodnosci, src.AGRIMWynik, src.KodDokumentu, src.KodDokumentuPid, src.UwagiDoDokumentu, src.NumerDokumentu, src.DataWygasniecia, src.NazwaInstytucji, src.IloscTowaru, src.NumerPozycji, src.JednostkaMiary, src.JednostkaMiaryPid, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_InformacjaDodatkowa' BEGIN
MERGE INTO aimp2.PWD_InformacjaDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.PWD_InformacjaDodatkowa AS src
ON (tgt.IdInfDodatk=src.IdInfDodatk)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarDPDZ=src.IdTowarDPDZ, tgt.KodInfDodatk=src.KodInfDodatk, tgt.KodInfDodatkPid=src.KodInfDodatkPid, tgt.OpisInfDodatk=src.OpisInfDodatk, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdInfDodatk, IdTowarDPDZ, KodInfDodatk, KodInfDodatkPid, OpisInfDodatk, DanePokontrolne)
VALUES (src.IdInfDodatk, src.IdTowarDPDZ, src.KodInfDodatk, src.KodInfDodatkPid, src.OpisInfDodatk, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_Kontener' BEGIN
MERGE INTO aimp2.PWD_Kontener AS tgt
USING WA_StageHurtownia.aimp2.PWD_Kontener AS src
ON (tgt.IdKontenera=src.IdKontenera)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarPWD=src.IdTowarPWD, tgt.NumerKontenera=src.NumerKontenera, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdKontenera, IdTowarPWD, NumerKontenera, DanePokontrolne)
VALUES (src.IdKontenera, src.IdTowarPWD, src.NumerKontenera, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_Kontyngent' BEGIN
MERGE INTO aimp2.PWD_Kontyngent AS tgt
USING WA_StageHurtownia.aimp2.PWD_Kontyngent AS src
ON (tgt.IdKontyngentu=src.IdKontyngentu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarPWD=src.IdTowarPWD, tgt.JednostkaMiaryWnioskowanejIlosci=src.JednostkaMiaryWnioskowanejIlosci, tgt.JednostkaMiaryWnioskowanejIlosciPid=src.JednostkaMiaryWnioskowanejIlosciPid, tgt.WnioskowanaIloscWRamachKontyngentu=src.WnioskowanaIloscWRamachKontyngentu, tgt.NumerPozycji=src.NumerPozycji, tgt.KwalifikatorJednostkiMiary=src.KwalifikatorJednostkiMiary, tgt.KwalifikatorJednostkiMiaryPid=src.KwalifikatorJednostkiMiaryPid, tgt.OpisKontyngentu=src.OpisKontyngentu, tgt.NumerKontyngentu=src.NumerKontyngentu, tgt.WniosekRetrospektywny=src.WniosekRetrospektywny, tgt.WyslanoDoTQS=src.WyslanoDoTQS, tgt.Status=src.Status, tgt.StanWeryfikacji=src.StanWeryfikacji, tgt.StanWeryfikacji2=src.StanWeryfikacji2, tgt.DanePokontrolne=src.DanePokontrolne, tgt.IdDefinicjiKontyngentu=src.IdDefinicjiKontyngentu
WHEN NOT MATCHED
THEN INSERT (IdKontyngentu, IdTowarPWD, JednostkaMiaryWnioskowanejIlosci, JednostkaMiaryWnioskowanejIlosciPid, WnioskowanaIloscWRamachKontyngentu, NumerPozycji, KwalifikatorJednostkiMiary, KwalifikatorJednostkiMiaryPid, OpisKontyngentu, NumerKontyngentu, WniosekRetrospektywny, WyslanoDoTQS, Status, StanWeryfikacji, StanWeryfikacji2, DanePokontrolne, IdDefinicjiKontyngentu)
VALUES (src.IdKontyngentu, src.IdTowarPWD, src.JednostkaMiaryWnioskowanejIlosci, src.JednostkaMiaryWnioskowanejIlosciPid, src.WnioskowanaIloscWRamachKontyngentu, src.NumerPozycji, src.KwalifikatorJednostkiMiary, src.KwalifikatorJednostkiMiaryPid, src.OpisKontyngentu, src.NumerKontyngentu, src.WniosekRetrospektywny, src.WyslanoDoTQS, src.Status, src.StanWeryfikacji, src.StanWeryfikacji2, src.DanePokontrolne, src.IdDefinicjiKontyngentu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_LokalizacjaTowarow' BEGIN
MERGE INTO aimp2.PWD_LokalizacjaTowarow AS tgt
USING WA_StageHurtownia.aimp2.PWD_LokalizacjaTowarow AS src
ON (tgt.IdLokalizacji=src.IdLokalizacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.DodatkowyIdLokalizacji=src.DodatkowyIdLokalizacji, tgt.KodMiejscaLokalizacji=src.KodMiejscaLokalizacji, tgt.KrajLokalizacji=src.KrajLokalizacji, tgt.KrajLokalizacjiPid=src.KrajLokalizacjiPid, tgt.OpisMiejscaLokalizacji=src.OpisMiejscaLokalizacji, tgt.UrzadCelnyLokalizacji=src.UrzadCelnyLokalizacji, tgt.UrzadCelnyLokalizacjiPid=src.UrzadCelnyLokalizacjiPid, tgt.KwalifikatorLokalizacji=src.KwalifikatorLokalizacji, tgt.KwalifikatorLokalizacjiPid=src.KwalifikatorLokalizacjiPid, tgt.TypLokalizacji=src.TypLokalizacji, tgt.TypLokalizacjiPid=src.TypLokalizacjiPid, tgt.IdentyfikatorAdresu=src.IdentyfikatorAdresu
WHEN NOT MATCHED
THEN INSERT (IdLokalizacji, IdDok, DodatkowyIdLokalizacji, KodMiejscaLokalizacji, KrajLokalizacji, KrajLokalizacjiPid, OpisMiejscaLokalizacji, UrzadCelnyLokalizacji, UrzadCelnyLokalizacjiPid, KwalifikatorLokalizacji, KwalifikatorLokalizacjiPid, TypLokalizacji, TypLokalizacjiPid, IdentyfikatorAdresu)
VALUES (src.IdLokalizacji, src.IdDok, src.DodatkowyIdLokalizacji, src.KodMiejscaLokalizacji, src.KrajLokalizacji, src.KrajLokalizacjiPid, src.OpisMiejscaLokalizacji, src.UrzadCelnyLokalizacji, src.UrzadCelnyLokalizacjiPid, src.KwalifikatorLokalizacji, src.KwalifikatorLokalizacjiPid, src.TypLokalizacji, src.TypLokalizacjiPid, src.IdentyfikatorAdresu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_Opakowanie' BEGIN
MERGE INTO aimp2.PWD_Opakowanie AS tgt
USING WA_StageHurtownia.aimp2.PWD_Opakowanie AS src
ON (tgt.IdOpakowania=src.IdOpakowania)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarPWD=src.IdTowarPWD, tgt.NumeryZnakiOpakowan=src.NumeryZnakiOpakowan, tgt.LiczbaOpakowan=src.LiczbaOpakowan, tgt.RodzajOpakowan=src.RodzajOpakowan, tgt.RodzajOpakowanPid=src.RodzajOpakowanPid, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdOpakowania, IdTowarPWD, NumeryZnakiOpakowan, LiczbaOpakowan, RodzajOpakowan, RodzajOpakowanPid, DanePokontrolne)
VALUES (src.IdOpakowania, src.IdTowarPWD, src.NumeryZnakiOpakowan, src.LiczbaOpakowan, src.RodzajOpakowan, src.RodzajOpakowanPid, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_OsobaFizyczna' BEGIN
MERGE INTO aimp2.PWD_OsobaFizyczna AS tgt
USING WA_StageHurtownia.aimp2.PWD_OsobaFizyczna AS src
ON (tgt.IdKontrahenta=src.IdKontrahenta)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.RodzajOsoby=src.RodzajOsoby, tgt.NumerIdentyfikacyjny=src.NumerIdentyfikacyjny, tgt.IdentyfikatorOsoby=src.IdentyfikatorOsoby, tgt.Imie=src.Imie, tgt.Nazwisko=src.Nazwisko, tgt.PESEL=src.PESEL, tgt.RodzajReprezentanta=src.RodzajReprezentanta, tgt.DanePokontrolne=src.DanePokontrolne, tgt.IdAdresu=src.IdAdresu, tgt.IdOsobyPodpisujacejDok=src.IdOsobyPodpisujacejDok
WHEN NOT MATCHED
THEN INSERT (IdKontrahenta, IdDok, PlacowkaPodmiotu, RodzajOsoby, NumerIdentyfikacyjny, IdentyfikatorOsoby, Imie, Nazwisko, PESEL, RodzajReprezentanta, DanePokontrolne, IdAdresu, IdOsobyPodpisujacejDok)
VALUES (src.IdKontrahenta, src.IdDok, src.PlacowkaPodmiotu, src.RodzajOsoby, src.NumerIdentyfikacyjny, src.IdentyfikatorOsoby, src.Imie, src.Nazwisko, src.PESEL, src.RodzajReprezentanta, src.DanePokontrolne, src.IdAdresu, src.IdOsobyPodpisujacejDok);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_Podmiot' BEGIN
MERGE INTO aimp2.PWD_Podmiot AS tgt
USING WA_StageHurtownia.aimp2.PWD_Podmiot AS src
ON (tgt.IdKontrahenta=src.IdKontrahenta)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.IdGrupyCertyfAEO=src.IdGrupyCertyfAEO, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.RolaPodmiotu=src.RolaPodmiotu, tgt.Email=src.Email, tgt.EORI=src.EORI, tgt.IdSISC=src.IdSISC, tgt.IdPodmiotuGospodarczego=src.IdPodmiotuGospodarczego, tgt.NazwaPodmiotu=src.NazwaPodmiotu, tgt.REGON=src.REGON, tgt.TypReprezentacji=src.TypReprezentacji, tgt.TIN=src.TIN, tgt.IdAdresu=src.IdAdresu, tgt.IdOsobyPodpisujacejDok=src.IdOsobyPodpisujacejDok
WHEN NOT MATCHED
THEN INSERT (IdKontrahenta, IdDok, IdGrupyCertyfAEO, PlacowkaPodmiotu, RolaPodmiotu, Email, EORI, IdSISC, IdPodmiotuGospodarczego, NazwaPodmiotu, REGON, TypReprezentacji, TIN, IdAdresu, IdOsobyPodpisujacejDok)
VALUES (src.IdKontrahenta, src.IdDok, src.IdGrupyCertyfAEO, src.PlacowkaPodmiotu, src.RolaPodmiotu, src.Email, src.EORI, src.IdSISC, src.IdPodmiotuGospodarczego, src.NazwaPodmiotu, src.REGON, src.TypReprezentacji, src.TIN, src.IdAdresu, src.IdOsobyPodpisujacejDok);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_PodmiotAdres' BEGIN
MERGE INTO aimp2.PWD_PodmiotAdres AS tgt
USING WA_StageHurtownia.aimp2.PWD_PodmiotAdres AS src
ON (tgt.IdAdresu=src.IdAdresu)
WHEN MATCHED
THEN UPDATE SET
tgt.Miasto=src.Miasto, tgt.Kraj=src.Kraj, tgt.KrajPid=src.KrajPid, tgt.UlicaNumer=src.UlicaNumer, tgt.KodPocztowy=src.KodPocztowy
WHEN NOT MATCHED
THEN INSERT (IdAdresu, Miasto, Kraj, KrajPid, UlicaNumer, KodPocztowy)
VALUES (src.IdAdresu, src.Miasto, src.Kraj, src.KrajPid, src.UlicaNumer, src.KodPocztowy);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_PodmiotInfDodatkowa' BEGIN
MERGE INTO aimp2.PWD_PodmiotInfDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.PWD_PodmiotInfDodatkowa AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdPodmiotuGospodarczego=src.IdPodmiotuGospodarczego, tgt.KodInfDodPodm=src.KodInfDodPodm
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdPodmiotuGospodarczego, KodInfDodPodm)
VALUES (src.IdInformacji, src.IdPodmiotuGospodarczego, src.KodInfDodPodm);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_Procedura' BEGIN
MERGE INTO aimp2.PWD_Procedura AS tgt
USING WA_StageHurtownia.aimp2.PWD_Procedura AS src
ON (tgt.IdProcedury=src.IdProcedury AND tgt.KodProcedurySzczeg=src.KodProcedurySzczeg)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.KodProceduryWnioskowanej=src.KodProceduryWnioskowanej, tgt.KodProceduryWnioskowanejPid=src.KodProceduryWnioskowanejPid, tgt.KodProceduryPoprzedniej=src.KodProceduryPoprzedniej, tgt.KodProceduryPoprzedniejPid=src.KodProceduryPoprzedniejPid, tgt.KodProcedurySzczegPid=src.KodProcedurySzczegPid
WHEN NOT MATCHED
THEN INSERT (IdProcedury, IdDok, KodProceduryWnioskowanej, KodProceduryWnioskowanejPid, KodProceduryPoprzedniej, KodProceduryPoprzedniejPid, KodProcedurySzczeg, KodProcedurySzczegPid)
VALUES (src.IdProcedury, src.IdDok, src.KodProceduryWnioskowanej, src.KodProceduryWnioskowanejPid, src.KodProceduryPoprzedniej, src.KodProceduryPoprzedniejPid, src.KodProcedurySzczeg, src.KodProcedurySzczegPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_SrodekTaryfowy' BEGIN
MERGE INTO aimp2.PWD_SrodekTaryfowy AS tgt
USING WA_StageHurtownia.aimp2.PWD_SrodekTaryfowy AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarPWD=src.IdTowarPWD, tgt.SrodeArchiwalny=src.SrodeArchiwalny, tgt.Przypisy=src.Przypisy, tgt.ObszarGeograficzny=src.ObszarGeograficzny, tgt.IdSrodka=src.IdSrodka, tgt.DataRejestracji=src.DataRejestracji, tgt.NumerWpisu=src.NumerWpisu, tgt.Seria=src.Seria, tgt.SID=src.SID, tgt.Typ=src.Typ, tgt.KodUAM=src.KodUAM, tgt.KwalifikatorUAM=src.KwalifikatorUAM
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdTowarPWD, SrodeArchiwalny, Przypisy, ObszarGeograficzny, IdSrodka, DataRejestracji, NumerWpisu, Seria, SID, Typ, KodUAM, KwalifikatorUAM)
VALUES (src.IdWpisu, src.IdTowarPWD, src.SrodeArchiwalny, src.Przypisy, src.ObszarGeograficzny, src.IdSrodka, src.DataRejestracji, src.NumerWpisu, src.Seria, src.SID, src.Typ, src.KodUAM, src.KwalifikatorUAM);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_Towar' BEGIN
MERGE INTO aimp2.PWD_Towar AS tgt
USING WA_StageHurtownia.aimp2.PWD_Towar AS src
ON (tgt.IdPozycji=src.IdPozycji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.AGRIM=src.AGRIM, tgt.SaldoARR=src.SaldoARR, tgt.StatusPrzetwarzaniaPozycjiARR=src.StatusPrzetwarzaniaPozycjiARR, tgt.IdKupujacegoOsobaFizyczna=src.IdKupujacegoOsobaFizyczna, tgt.IdPodmiotuDoKontaktu=src.IdPodmiotuDoKontaktu, tgt.IdOdbiorcyPodmiotGospodarczy=src.IdOdbiorcyPodmiotGospodarczy, tgt.IdSprzedajacegoPodmiotGospodarczy=src.IdSprzedajacegoPodmiotGospodarczy, tgt.IdNadawcyPodmiotGospodarczy=src.IdNadawcyPodmiotGospodarczy, tgt.DataDoKalkulacji1=src.DataDoKalkulacji1, tgt.DataDoKalkulacji2=src.DataDoKalkulacji2, tgt.KodCN=src.KodCN, tgt.RzeczywistyKodTowarowy=src.RzeczywistyKodTowarowy, tgt.IdPodmiotuZPozwNaSamoobslugeCelna=src.IdPodmiotuZPozwNaSamoobslugeCelna, tgt.KontynuacjaProcesu=src.KontynuacjaProcesu, tgt.KrajPrzeznaczenia=src.KrajPrzeznaczenia, tgt.KrajPrzeznaczeniaPid=src.KrajPrzeznaczeniaPid, tgt.KrajPrzeznaczeniaRegion=src.KrajPrzeznaczeniaRegion, tgt.KrajPrzeznaczeniaRegionPid=src.KrajPrzeznaczeniaRegionPid, tgt.KrajWysylki=src.KrajWysylki, tgt.KrajWysylkiPid=src.KrajWysylkiPid, tgt.KrajPochodzenia=src.KrajPochodzenia, tgt.KrajPochodzeniaPid=src.KrajPochodzeniaPid, tgt.WynikWalidacjiCRX_REX=src.WynikWalidacjiCRX_REX, tgt.KodWaluty=src.KodWaluty, tgt.KodWalutyPid=src.KodWalutyPid, tgt.KodCUS=src.KodCUS, tgt.IdDecyzjiAdminUsuwajacejPozycje=src.IdDecyzjiAdminUsuwajacejPozycje, tgt.OpisNieprawidlowosci=src.OpisNieprawidlowosci, tgt.EAD=src.EAD, tgt.EMCSNumerARC=src.EMCSNumerARC, tgt.EMCSKodCN=src.EMCSKodCN, tgt.EMCSMasaNetto=src.EMCSMasaNetto, tgt.EMCSStatusPrzetwarzaniaPozycji=src.EMCSStatusPrzetwarzaniaPozycji, tgt.EMCSTryb=src.EMCSTryb, tgt.MasaBrutto=src.MasaBrutto, tgt.ZarejestrowaneZabezpieczenie=src.ZarejestrowaneZabezpieczenie, tgt.IdPozycjiZdefiniowanejPDS=src.IdPozycjiZdefiniowanejPDS, tgt.IdDanychCelnychPozycjiPDS=src.IdDanychCelnychPozycjiPDS, tgt.DataUniewaznienia=src.DataUniewaznienia, tgt.UniewaznionoPozycjeManualnie=src.UniewaznionoPozycjeManualnie, tgt.PowodUniewaznieniaPozycji=src.PowodUniewaznieniaPozycji, tgt.PowodOdrzuceniaUniewaznieniaPozycji=src.PowodOdrzuceniaUniewaznieniaPozycji, tgt.NumerWlasnyWnioskuOUniewaznienie=src.NumerWlasnyWnioskuOUniewaznienie, tgt.KodTowarowy=src.KodTowarowy, tgt.OpisPozycji=src.OpisPozycji, tgt.NumerPozycji=src.NumerPozycji, tgt.Wartosc=src.Wartosc, tgt.TrescAdnotacjiUrzedowych=src.TrescAdnotacjiUrzedowych, tgt.NrPozycjiSrodkaTARIC=src.NrPozycjiSrodkaTARIC, tgt.KodTypuSrodkaTARIC=src.KodTypuSrodkaTARIC, tgt.MasaNetto=src.MasaNetto, tgt.RzeczywistaMasaNetto=src.RzeczywistaMasaNetto, tgt.Adnotacje=src.Adnotacje, tgt.IdKupujacegoPodmiotGospodarczy=src.IdKupujacegoPodmiotGospodarczy, tgt.IdOsobyDoKontaktu=src.IdOsobyDoKontaktu, tgt.IdOdbiorcyOsobaFizyczna=src.IdOdbiorcyOsobaFizyczna, tgt.IdSprzedajacegoOsobaFizyczna=src.IdSprzedajacegoOsobaFizyczna, tgt.IdNadawcyOsobaFizyczna=src.IdNadawcyOsobaFizyczna, tgt.ZaksiegowanoZerowePlatnosciZEFIR=src.ZaksiegowanoZerowePlatnosciZEFIR, tgt.KodKrajuPreferencyjnegoPochodzenia=src.KodKrajuPreferencyjnegoPochodzenia, tgt.KodKrajuPreferencyjnegoPochodzeniaPid=src.KodKrajuPreferencyjnegoPochodzeniaPid, tgt.NumerReferencyjnyPrzesylki=src.NumerReferencyjnyPrzesylki, tgt.PlatnoscZarejestrowana=src.PlatnoscZarejestrowana, tgt.KodPreferencji=src.KodPreferencji, tgt.KodPreferencjiPid=src.KodPreferencjiPid, tgt.KodProceduryPoprzedniej=src.KodProceduryPoprzedniej, tgt.KodProceduryPoprzedniejPid=src.KodProceduryPoprzedniejPid, tgt.KodProceduryWnioskowanej=src.KodProceduryWnioskowanej, tgt.KodProceduryWnioskowanejPid=src.KodProceduryWnioskowanejPid, tgt.ZrealizowanePlatnosciZEFIR=src.ZrealizowanePlatnosciZEFIR, tgt.IloscTowaru=src.IloscTowaru, tgt.IloscTowaruUzupelniajacaJednostkaMiary=src.IloscTowaruUzupelniajacaJednostkaMiary, tgt.DataZwolnieniaTowaru=src.DataZwolnieniaTowaru, tgt.PodstawaUregulowaniaStatusu=src.PodstawaUregulowaniaStatusu, tgt.TerminUregulowaniaStatusu=src.TerminUregulowaniaStatusu, tgt.SposobUregulowaniaStatusu=src.SposobUregulowaniaStatusu,
 tgt.StatusWyslaniaPozycjiDoOSOZ=src.StatusWyslaniaPozycjiDoOSOZ, tgt.StatusWyslaniaPozycjiDoZEFIR=src.StatusWyslaniaPozycjiDoZEFIR, tgt.WyslanoKomunikatZC272=src.WyslanoKomunikatZC272, tgt.EMCSOczekiwanie=src.EMCSOczekiwanie, tgt.KodTARIC=src.KodTARIC, tgt.TQSOdrzucenie=src.TQSOdrzucenie, tgt.RodzajTransakcji=src.RodzajTransakcji, tgt.RodzajTransakcjiPid=src.RodzajTransakcjiPid, tgt.IdZgloszeniaUzupelniajacego=src.IdZgloszeniaUzupelniajacego, tgt.VAT7DecyzjaAdministracyjna=src.VAT7DecyzjaAdministracyjna, tgt.VAT7Zamkniecia=src.VAT7Zamkniecia, tgt.VAT7DataCzasZaplaty=src.VAT7DataCzasZaplaty, tgt.WynikWeryfikacji=src.WynikWeryfikacji, tgt.DanePokontrolne=src.DanePokontrolne, tgt.StatusPozycji=src.StatusPozycji, tgt.LiczbaSprostowanWyslanychDoZEFIR=src.LiczbaSprostowanWyslanychDoZEFIR
WHEN NOT MATCHED
THEN INSERT (IdPozycji, IdDok, AGRIM, SaldoARR, StatusPrzetwarzaniaPozycjiARR, IdKupujacegoOsobaFizyczna, IdPodmiotuDoKontaktu, IdOdbiorcyPodmiotGospodarczy, IdSprzedajacegoPodmiotGospodarczy, IdNadawcyPodmiotGospodarczy, DataDoKalkulacji1, DataDoKalkulacji2, KodCN, RzeczywistyKodTowarowy, IdPodmiotuZPozwNaSamoobslugeCelna, KontynuacjaProcesu, KrajPrzeznaczenia, KrajPrzeznaczeniaPid, KrajPrzeznaczeniaRegion, KrajPrzeznaczeniaRegionPid, KrajWysylki, KrajWysylkiPid, KrajPochodzenia, KrajPochodzeniaPid, WynikWalidacjiCRX_REX, KodWaluty, KodWalutyPid, KodCUS, IdDecyzjiAdminUsuwajacejPozycje, OpisNieprawidlowosci, EAD, EMCSNumerARC, EMCSKodCN, EMCSMasaNetto, EMCSStatusPrzetwarzaniaPozycji, EMCSTryb, MasaBrutto, ZarejestrowaneZabezpieczenie, IdPozycjiZdefiniowanejPDS, IdDanychCelnychPozycjiPDS, DataUniewaznienia, UniewaznionoPozycjeManualnie, PowodUniewaznieniaPozycji, PowodOdrzuceniaUniewaznieniaPozycji, NumerWlasnyWnioskuOUniewaznienie, KodTowarowy, OpisPozycji, NumerPozycji, Wartosc, TrescAdnotacjiUrzedowych, NrPozycjiSrodkaTARIC, KodTypuSrodkaTARIC, MasaNetto, RzeczywistaMasaNetto, Adnotacje, IdKupujacegoPodmiotGospodarczy, IdOsobyDoKontaktu, IdOdbiorcyOsobaFizyczna, IdSprzedajacegoOsobaFizyczna, IdNadawcyOsobaFizyczna, ZaksiegowanoZerowePlatnosciZEFIR, KodKrajuPreferencyjnegoPochodzenia, KodKrajuPreferencyjnegoPochodzeniaPid, NumerReferencyjnyPrzesylki, PlatnoscZarejestrowana, KodPreferencji, KodPreferencjiPid, KodProceduryPoprzedniej, KodProceduryPoprzedniejPid, KodProceduryWnioskowanej, KodProceduryWnioskowanejPid, ZrealizowanePlatnosciZEFIR, IloscTowaru, IloscTowaruUzupelniajacaJednostkaMiary, DataZwolnieniaTowaru, PodstawaUregulowaniaStatusu, TerminUregulowaniaStatusu, SposobUregulowaniaStatusu, StatusWyslaniaPozycjiDoOSOZ, StatusWyslaniaPozycjiDoZEFIR, WyslanoKomunikatZC272, EMCSOczekiwanie, KodTARIC, TQSOdrzucenie, RodzajTransakcji, RodzajTransakcjiPid, IdZgloszeniaUzupelniajacego, VAT7DecyzjaAdministracyjna, VAT7Zamkniecia, VAT7DataCzasZaplaty, WynikWeryfikacji, DanePokontrolne, StatusPozycji, LiczbaSprostowanWyslanychDoZEFIR)
VALUES (src.IdPozycji, src.IdDok, src.AGRIM, src.SaldoARR, src.StatusPrzetwarzaniaPozycjiARR, src.IdKupujacegoOsobaFizyczna, src.IdPodmiotuDoKontaktu, src.IdOdbiorcyPodmiotGospodarczy, src.IdSprzedajacegoPodmiotGospodarczy, src.IdNadawcyPodmiotGospodarczy, src.DataDoKalkulacji1, src.DataDoKalkulacji2, src.KodCN, src.RzeczywistyKodTowarowy, src.IdPodmiotuZPozwNaSamoobslugeCelna, src.KontynuacjaProcesu, src.KrajPrzeznaczenia, src.KrajPrzeznaczeniaPid, src.KrajPrzeznaczeniaRegion, src.KrajPrzeznaczeniaRegionPid, src.KrajWysylki, src.KrajWysylkiPid, src.KrajPochodzenia, src.KrajPochodzeniaPid, src.WynikWalidacjiCRX_REX, src.KodWaluty, src.KodWalutyPid, src.KodCUS, src.IdDecyzjiAdminUsuwajacejPozycje, src.OpisNieprawidlowosci, src.EAD, src.EMCSNumerARC, src.EMCSKodCN, src.EMCSMasaNetto, src.EMCSStatusPrzetwarzaniaPozycji, src.EMCSTryb, src.MasaBrutto, src.ZarejestrowaneZabezpieczenie, src.IdPozycjiZdefiniowanejPDS, src.IdDanychCelnychPozycjiPDS, src.DataUniewaznienia, src.UniewaznionoPozycjeManualnie, src.PowodUniewaznieniaPozycji, src.PowodOdrzuceniaUniewaznieniaPozycji, src.NumerWlasnyWnioskuOUniewaznienie, src.KodTowarowy, src.OpisPozycji, src.NumerPozycji, src.Wartosc, src.TrescAdnotacjiUrzedowych, src.NrPozycjiSrodkaTARIC, src.KodTypuSrodkaTARIC, src.MasaNetto, src.RzeczywistaMasaNetto, src.Adnotacje, src.IdKupujacegoPodmiotGospodarczy, src.IdOsobyDoKontaktu, src.IdOdbiorcyOsobaFizyczna, src.IdSprzedajacegoOsobaFizyczna, src.IdNadawcyOsobaFizyczna, src.ZaksiegowanoZerowePlatnosciZEFIR, src.KodKrajuPreferencyjnegoPochodzenia, src.KodKrajuPreferencyjnegoPochodzeniaPid, src.NumerReferencyjnyPrzesylki, src.PlatnoscZarejestrowana, src.KodPreferencji, src.KodPreferencjiPid, src.KodProceduryPoprzedniej, src.KodProceduryPoprzedniejPid, src.KodProceduryWnioskowanej, src.KodProceduryWnioskowanejPid, src.ZrealizowanePlatnosciZEFIR, src.IloscTowaru, src.IloscTowaruUzupelniajacaJednostkaMiary, src.DataZwolnieniaTowaru, src.PodstawaUregulowaniaStatusu, src.TerminUregulowaniaStatusu, src.SposobUregulowaniaStatusu, src.StatusWyslaniaPozycjiDoOSOZ, src.StatusWyslaniaPozycjiDoZEFIR, src.WyslanoKomunikatZC272, src.EMCSOczekiwanie, src.KodTARIC, src.TQSOdrzucenie, src.RodzajTransakcji, src.RodzajTransakcjiPid, src.IdZgloszeniaUzupelniajacego, src.VAT7DecyzjaAdministracyjna, src.VAT7Zamkniecia, src.VAT7DataCzasZaplaty, src.WynikWeryfikacji, src.DanePokontrolne, src.StatusPozycji, src.LiczbaSprostowanWyslanychDoZEFIR);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_TransportNaGranicy' BEGIN
MERGE INTO aimp2.PWD_TransportNaGranicy AS tgt
USING WA_StageHurtownia.aimp2.PWD_TransportNaGranicy AS src
ON (tgt.IdTransportu=src.IdTransportu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.RodzajTransportu=src.RodzajTransportu, tgt.RodzajTransportuPid=src.RodzajTransportuPid, tgt.ZnakiSrodkaTransportu=src.ZnakiSrodkaTransportu, tgt.PrzynaleznoscPanstwowaSrodkaTransportu=src.PrzynaleznoscPanstwowaSrodkaTransportu, tgt.PrzynaleznoscPanstwowaSrodkaTransportuPid=src.PrzynaleznoscPanstwowaSrodkaTransportuPid, tgt.OznaczenieSrodkaTransportu=src.OznaczenieSrodkaTransportu, tgt.OznaczenieSrodkaTransportuPid=src.OznaczenieSrodkaTransportuPid
WHEN NOT MATCHED
THEN INSERT (IdTransportu, IdDok, RodzajTransportu, RodzajTransportuPid, ZnakiSrodkaTransportu, PrzynaleznoscPanstwowaSrodkaTransportu, PrzynaleznoscPanstwowaSrodkaTransportuPid, OznaczenieSrodkaTransportu, OznaczenieSrodkaTransportuPid)
VALUES (src.IdTransportu, src.IdDok, src.RodzajTransportu, src.RodzajTransportuPid, src.ZnakiSrodkaTransportu, src.PrzynaleznoscPanstwowaSrodkaTransportu, src.PrzynaleznoscPanstwowaSrodkaTransportuPid, src.OznaczenieSrodkaTransportu, src.OznaczenieSrodkaTransportuPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'PWD_TransportWewnetrzny' BEGIN
MERGE INTO aimp2.PWD_TransportWewnetrzny AS tgt
USING WA_StageHurtownia.aimp2.PWD_TransportWewnetrzny AS src
ON (tgt.IdTransportu=src.IdTransportu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.RodzajTransportu=src.RodzajTransportu, tgt.RodzajTransportuPid=src.RodzajTransportuPid, tgt.ZnakiSrodkaTransportu=src.ZnakiSrodkaTransportu, tgt.PrzynaleznoscPanstwowaSrodkaTransportu=src.PrzynaleznoscPanstwowaSrodkaTransportu, tgt.PrzynaleznoscPanstwowaSrodkaTransportuPid=src.PrzynaleznoscPanstwowaSrodkaTransportuPid, tgt.OznaczenieSrodkaTransportu=src.OznaczenieSrodkaTransportu, tgt.OznaczenieSrodkaTransportuPid=src.OznaczenieSrodkaTransportuPid
WHEN NOT MATCHED
THEN INSERT (IdTransportu, IdDok, RodzajTransportu, RodzajTransportuPid, ZnakiSrodkaTransportu, PrzynaleznoscPanstwowaSrodkaTransportu, PrzynaleznoscPanstwowaSrodkaTransportuPid, OznaczenieSrodkaTransportu, OznaczenieSrodkaTransportuPid)
VALUES (src.IdTransportu, src.IdDok, src.RodzajTransportu, src.RodzajTransportuPid, src.ZnakiSrodkaTransportu, src.PrzynaleznoscPanstwowaSrodkaTransportu, src.PrzynaleznoscPanstwowaSrodkaTransportuPid, src.OznaczenieSrodkaTransportu, src.OznaczenieSrodkaTransportuPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_DecyzjaAdministracyjna' BEGIN
MERGE INTO aimp2.ZCP_DecyzjaAdministracyjna AS tgt
USING WA_StageHurtownia.aimp2.ZCP_DecyzjaAdministracyjna AS src
ON (tgt.IdDecyzji=src.IdDecyzji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.DataDecyzji=src.DataDecyzji, tgt.NumerDecyzji=src.NumerDecyzji, tgt.TrescUzasadnienia=src.TrescUzasadnienia, tgt.MRN=src.MRN, tgt.NumerPozycji=src.NumerPozycji, tgt.NumeryPozycjiTowarowych=src.NumeryPozycjiTowarowych, tgt.TypDecyzjiAdministracyjnej=src.TypDecyzjiAdministracyjnej, tgt.IdOperacjiNaZCP=src.IdOperacjiNaZCP
WHEN NOT MATCHED
THEN INSERT (IdDecyzji, IdDok, DataDecyzji, NumerDecyzji, TrescUzasadnienia, MRN, NumerPozycji, NumeryPozycjiTowarowych, TypDecyzjiAdministracyjnej, IdOperacjiNaZCP)
VALUES (src.IdDecyzji, src.IdDok, src.DataDecyzji, src.NumerDecyzji, src.TrescUzasadnienia, src.MRN, src.NumerPozycji, src.NumeryPozycjiTowarowych, src.TypDecyzjiAdministracyjnej, src.IdOperacjiNaZCP);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Dokument' BEGIN
MERGE INTO aimp2.ZCP_Dokument AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Dokument AS src
ON (tgt.IdDok=src.IdDok)
WHEN MATCHED
THEN UPDATE SET
tgt.TypDeklaracji=src.TypDeklaracji, tgt.PodmiotAEO=src.PodmiotAEO, tgt.EksportDanych=src.EksportDanych, tgt.AwaryjnaRejestracja=src.AwaryjnaRejestracja, tgt.FlagaDeklaracji=src.FlagaDeklaracji, tgt.PrzyjetaRecznie=src.PrzyjetaRecznie, tgt.MRN=src.MRN, tgt.IdEwidencjaPapierowa=src.IdEwidencjaPapierowa, tgt.EmailPodmiotu=src.EmailPodmiotu, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.SegmentacjaZISAR=src.SegmentacjaZISAR, tgt.NumerWlasny=src.NumerWlasny, tgt.PodpisanaCyfrowo=src.PodpisanaCyfrowo, tgt.DataPrzyjecia=src.DataPrzyjecia, tgt.DodatkowyTypZgloszenia=src.DodatkowyTypZgloszenia, tgt.DodatkowyTypZgloszeniaPid=src.DodatkowyTypZgloszeniaPid, tgt.DataKalkulacji=src.DataKalkulacji, tgt.DataAnulowania=src.DataAnulowania, tgt.CzyKontenery=src.CzyKontenery, tgt.UrzadCelnyKontrolny=src.UrzadCelnyKontrolny, tgt.UrzadCelnyKontrolnyPid=src.UrzadCelnyKontrolnyPid, tgt.KrajPrzeznaczenia=src.KrajPrzeznaczenia, tgt.KrajPrzeznaczeniaPid=src.KrajPrzeznaczeniaPid, tgt.KrajPrzeznaczeniaRegion=src.KrajPrzeznaczeniaRegion, tgt.KrajPrzeznaczeniaRegionPid=src.KrajPrzeznaczeniaRegionPid, tgt.KrajWysylki=src.KrajWysylki, tgt.KrajWysylkiPid=src.KrajWysylkiPid, tgt.KodWaluty=src.KodWaluty, tgt.KodWalutyPid=src.KodWalutyPid, tgt.UrzadCelnyZgloszenia=src.UrzadCelnyZgloszenia, tgt.UrzadCelnyZgloszeniaPid=src.UrzadCelnyZgloszeniaPid, tgt.PlatnoscOdroczona=src.PlatnoscOdroczona, tgt.DataWydaniaPrzesylkiDPZ=src.DataWydaniaPrzesylkiDPZ, tgt.WynikiKontroliDPZ=src.WynikiKontroliDPZ, tgt.NumerPrzesylkiDPZ=src.NumerPrzesylkiDPZ, tgt.DataPowiadomieniaDlugDPZ=src.DataPowiadomieniaDlugDPZ, tgt.ZwyklyPocztowyDPZ=src.ZwyklyPocztowyDPZ, tgt.TypZabezpieczeniaDPZ=src.TypZabezpieczeniaDPZ, tgt.OplacenieZabezpieczenieNaleznosci=src.OplacenieZabezpieczenieNaleznosci, tgt.SposobUregulowaniaTowaruDPZ=src.SposobUregulowaniaTowaruDPZ, tgt.DataZwolnieniaDPZ=src.DataZwolnieniaDPZ, tgt.PodpisElektroniczny=src.PodpisElektroniczny, tgt.StatusObslugiEMCS=src.StatusObslugiEMCS, tgt.UrzadCelnyWprowadzania=src.UrzadCelnyWprowadzania, tgt.UrzadCelnyWprowadzaniaPid=src.UrzadCelnyWprowadzaniaPid, tgt.MasaBrutto=src.MasaBrutto, tgt.IdDanychCelnychPTW=src.IdDanychCelnychPTW, tgt.TypDokumentu=src.TypDokumentu, tgt.TypDokumentuPid=src.TypDokumentuPid, tgt.AdnotacjePrawne=src.AdnotacjePrawne, tgt.LiczbaPozycjiTowarowych=src.LiczbaPozycjiTowarowych, tgt.NumerPozwolenia=src.NumerPozwolenia, tgt.LiczbaOpakowan=src.LiczbaOpakowan, tgt.NumerReferencyjnyPrzesylki=src.NumerReferencyjnyPrzesylki, tgt.DataPrzedstawieniaTowaru=src.DataPrzedstawieniaTowaru, tgt.PrzedstawienieTowaru=src.PrzedstawienieTowaru, tgt.UrzadCelnyPrzedstawieniaTowaru=src.UrzadCelnyPrzedstawieniaTowaru, tgt.NumerDokPoprzedniego=src.NumerDokPoprzedniego, tgt.ZawartoscZC213ObslugaSprostowania=src.ZawartoscZC213ObslugaSprostowania, tgt.DataRejestracji=src.DataRejestracji, tgt.NumerRejestru=src.NumerRejestru, tgt.TerminZwolnieniaTowaru=src.TerminZwolnieniaTowaru, tgt.DataOdrzucenia=src.DataOdrzucenia, tgt.OgolnaWartoscFaktur=src.OgolnaWartoscFaktur, tgt.CzyWyslanodeklaracjeDoTQS=src.CzyWyslanodeklaracjeDoTQS, tgt.LicznikWysylkiDoTQS=src.LicznikWysylkiDoTQS, tgt.IdZgloszeniaUZP=src.IdZgloszeniaUZP, tgt.DanePokontrolne=src.DanePokontrolne, tgt.TypZgloszenia=src.TypZgloszenia, tgt.OsobaPodpisujacaDokument=src.OsobaPodpisujacaDokument, tgt.StatusDeklaracjiZCP=src.StatusDeklaracjiZCP, tgt.NumerSystemowyAIS=src.NumerSystemowyAIS, tgt.DataGranicznaZlozeniaZgloszeniaUZP=src.DataGranicznaZlozeniaZgloszeniaUZP, tgt.VAT7=src.VAT7
WHEN NOT MATCHED
THEN INSERT (IdDok, TypDeklaracji, PodmiotAEO, EksportDanych, AwaryjnaRejestracja, FlagaDeklaracji, PrzyjetaRecznie, MRN, IdEwidencjaPapierowa, EmailPodmiotu, PlacowkaPodmiotu, SegmentacjaZISAR, NumerWlasny, PodpisanaCyfrowo, DataPrzyjecia, DodatkowyTypZgloszenia, DodatkowyTypZgloszeniaPid, DataKalkulacji, DataAnulowania, CzyKontenery, UrzadCelnyKontrolny, UrzadCelnyKontrolnyPid, KrajPrzeznaczenia, KrajPrzeznaczeniaPid, KrajPrzeznaczeniaRegion, KrajPrzeznaczeniaRegionPid, KrajWysylki, KrajWysylkiPid, KodWaluty, KodWalutyPid, UrzadCelnyZgloszenia, UrzadCelnyZgloszeniaPid, PlatnoscOdroczona, DataWydaniaPrzesylkiDPZ, WynikiKontroliDPZ, NumerPrzesylkiDPZ, DataPowiadomieniaDlugDPZ, ZwyklyPocztowyDPZ, TypZabezpieczeniaDPZ, OplacenieZabezpieczenieNaleznosci, SposobUregulowaniaTowaruDPZ, DataZwolnieniaDPZ, PodpisElektroniczny, StatusObslugiEMCS, UrzadCelnyWprowadzania, UrzadCelnyWprowadzaniaPid, MasaBrutto, IdDanychCelnychPTW, TypDokumentu, TypDokumentuPid, AdnotacjePrawne, LiczbaPozycjiTowarowych, NumerPozwolenia, LiczbaOpakowan, NumerReferencyjnyPrzesylki, DataPrzedstawieniaTowaru, PrzedstawienieTowaru, UrzadCelnyPrzedstawieniaTowaru, NumerDokPoprzedniego, ZawartoscZC213ObslugaSprostowania, DataRejestracji, NumerRejestru, TerminZwolnieniaTowaru, DataOdrzucenia, OgolnaWartoscFaktur, CzyWyslanodeklaracjeDoTQS, LicznikWysylkiDoTQS, IdZgloszeniaUZP, DanePokontrolne, TypZgloszenia, OsobaPodpisujacaDokument, StatusDeklaracjiZCP, NumerSystemowyAIS, DataGranicznaZlozeniaZgloszeniaUZP, VAT7)
VALUES (src.IdDok, src.TypDeklaracji, src.PodmiotAEO, src.EksportDanych, src.AwaryjnaRejestracja, src.FlagaDeklaracji, src.PrzyjetaRecznie, src.MRN, src.IdEwidencjaPapierowa, src.EmailPodmiotu, src.PlacowkaPodmiotu, src.SegmentacjaZISAR, src.NumerWlasny, src.PodpisanaCyfrowo, src.DataPrzyjecia, src.DodatkowyTypZgloszenia, src.DodatkowyTypZgloszeniaPid, src.DataKalkulacji, src.DataAnulowania, src.CzyKontenery, src.UrzadCelnyKontrolny, src.UrzadCelnyKontrolnyPid, src.KrajPrzeznaczenia, src.KrajPrzeznaczeniaPid, src.KrajPrzeznaczeniaRegion, src.KrajPrzeznaczeniaRegionPid, src.KrajWysylki, src.KrajWysylkiPid, src.KodWaluty, src.KodWalutyPid, src.UrzadCelnyZgloszenia, src.UrzadCelnyZgloszeniaPid, src.PlatnoscOdroczona, src.DataWydaniaPrzesylkiDPZ, src.WynikiKontroliDPZ, src.NumerPrzesylkiDPZ, src.DataPowiadomieniaDlugDPZ, src.ZwyklyPocztowyDPZ, src.TypZabezpieczeniaDPZ, src.OplacenieZabezpieczenieNaleznosci, src.SposobUregulowaniaTowaruDPZ, src.DataZwolnieniaDPZ, src.PodpisElektroniczny, src.StatusObslugiEMCS, src.UrzadCelnyWprowadzania, src.UrzadCelnyWprowadzaniaPid, src.MasaBrutto, src.IdDanychCelnychPTW, src.TypDokumentu, src.TypDokumentuPid, src.AdnotacjePrawne, src.LiczbaPozycjiTowarowych, src.NumerPozwolenia, src.LiczbaOpakowan, src.NumerReferencyjnyPrzesylki, src.DataPrzedstawieniaTowaru, src.PrzedstawienieTowaru, src.UrzadCelnyPrzedstawieniaTowaru, src.NumerDokPoprzedniego, src.ZawartoscZC213ObslugaSprostowania, src.DataRejestracji, src.NumerRejestru, src.TerminZwolnieniaTowaru, src.DataOdrzucenia, src.OgolnaWartoscFaktur, src.CzyWyslanodeklaracjeDoTQS, src.LicznikWysylkiDoTQS, src.IdZgloszeniaUZP, src.DanePokontrolne, src.TypZgloszenia, src.OsobaPodpisujacaDokument, src.StatusDeklaracjiZCP, src.NumerSystemowyAIS, src.DataGranicznaZlozeniaZgloszeniaUZP, src.VAT7);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_DokumentPoprzedni' BEGIN
MERGE INTO aimp2.ZCP_DokumentPoprzedni AS tgt
USING WA_StageHurtownia.aimp2.ZCP_DokumentPoprzedni AS src
ON (tgt.IdDokPoprzed=src.IdDokPoprzed)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.Kategoria=src.Kategoria, tgt.KategoriaPid=src.KategoriaPid, tgt.KodDokPoprz=src.KodDokPoprz, tgt.KodDokPoprzPid=src.KodDokPoprzPid, tgt.Numer=src.Numer, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdDokPoprzed, IdDok, Kategoria, KategoriaPid, KodDokPoprz, KodDokPoprzPid, Numer, DanePokontrolne)
VALUES (src.IdDokPoprzed, src.IdDok, src.Kategoria, src.KategoriaPid, src.KodDokPoprz, src.KodDokPoprzPid, src.Numer, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_DokumentPoprzedniPozycje' BEGIN
MERGE INTO aimp2.ZCP_DokumentPoprzedniPozycje AS tgt
USING WA_StageHurtownia.aimp2.ZCP_DokumentPoprzedniPozycje AS src
ON (tgt.IdPozycji=src.IdPozycji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDokPoprzed=src.IdDokPoprzed, tgt.NumerPozycji=src.NumerPozycji
WHEN NOT MATCHED
THEN INSERT (IdPozycji, IdDokPoprzed, NumerPozycji)
VALUES (src.IdPozycji, src.IdDokPoprzed, src.NumerPozycji);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_DokumentWymagany' BEGIN
MERGE INTO aimp2.ZCP_DokumentWymagany AS tgt
USING WA_StageHurtownia.aimp2.ZCP_DokumentWymagany AS src
ON (tgt.IdDokWym=src.IdDokWym)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.AGRIMOpisNiezgodnosci=src.AGRIMOpisNiezgodnosci, tgt.AGRIMWynik=src.AGRIMWynik, tgt.KodDokumentu=src.KodDokumentu, tgt.KodDokumentuPid=src.KodDokumentuPid, tgt.UwagiDoDokumentu=src.UwagiDoDokumentu, tgt.NumerDokumentu=src.NumerDokumentu, tgt.DataWygasniecia=src.DataWygasniecia, tgt.NazwaInstytucji=src.NazwaInstytucji, tgt.IloscTowaru=src.IloscTowaru, tgt.NumerPozycji=src.NumerPozycji, tgt.JednostkaMiary=src.JednostkaMiary, tgt.JednostkaMiaryPid=src.JednostkaMiaryPid, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdDokWym, IdTowarZCP, AGRIMOpisNiezgodnosci, AGRIMWynik, KodDokumentu, KodDokumentuPid, UwagiDoDokumentu, NumerDokumentu, DataWygasniecia, NazwaInstytucji, IloscTowaru, NumerPozycji, JednostkaMiary, JednostkaMiaryPid, DanePokontrolne)
VALUES (src.IdDokWym, src.IdTowarZCP, src.AGRIMOpisNiezgodnosci, src.AGRIMWynik, src.KodDokumentu, src.KodDokumentuPid, src.UwagiDoDokumentu, src.NumerDokumentu, src.DataWygasniecia, src.NazwaInstytucji, src.IloscTowaru, src.NumerPozycji, src.JednostkaMiary, src.JednostkaMiaryPid, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_InformacjaDodatkowa' BEGIN
MERGE INTO aimp2.ZCP_InformacjaDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.ZCP_InformacjaDodatkowa AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.KodInfDodatk=src.KodInfDodatk, tgt.KodInfDodatkPid=src.KodInfDodatkPid, tgt.OpisInfDodatk=src.OpisInfDodatk
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdDok, KodInfDodatk, KodInfDodatkPid, OpisInfDodatk)
VALUES (src.IdInformacji, src.IdDok, src.KodInfDodatk, src.KodInfDodatkPid, src.OpisInfDodatk);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_InformacjaPOD' BEGIN
MERGE INTO aimp2.ZCP_InformacjaPOD AS tgt
USING WA_StageHurtownia.aimp2.ZCP_InformacjaPOD AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.DataStworzenia=src.DataStworzenia, tgt.DataPoznaniaDluguPrzezPodmiot=src.DataPoznaniaDluguPrzezPodmiot, tgt.IdKomunikatuZC291=src.IdKomunikatuZC291, tgt.StatusPOD=src.StatusPOD, tgt.IdDecyzjiAdministracyjnej=src.IdDecyzjiAdministracyjnej
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdDok, DataStworzenia, DataPoznaniaDluguPrzezPodmiot, IdKomunikatuZC291, StatusPOD, IdDecyzjiAdministracyjnej)
VALUES (src.IdInformacji, src.IdDok, src.DataStworzenia, src.DataPoznaniaDluguPrzezPodmiot, src.IdKomunikatuZC291, src.StatusPOD, src.IdDecyzjiAdministracyjnej);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_InformacjaPODZ' BEGIN
MERGE INTO aimp2.ZCP_InformacjaPODZ AS tgt
USING WA_StageHurtownia.aimp2.ZCP_InformacjaPODZ AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.KwotaPODZ=src.KwotaPODZ, tgt.UzytaKwota=src.UzytaKwota, tgt.KomentarzDoPODZ=src.KomentarzDoPODZ, tgt.KodDostepu=src.KodDostepu, tgt.KodInnegoRodzajuZabezpieczenia=src.KodInnegoRodzajuZabezpieczenia, tgt.KodGRN=src.KodGRN, tgt.MRN=src.MRN, tgt.NumerPODZ=src.NumerPODZ, tgt.NumerWlasnyPODZ=src.NumerWlasnyPODZ, tgt.IdKontyngentu=src.IdKontyngentu, tgt.StatusWyslaniaDoOSOZ=src.StatusWyslaniaDoOSOZ, tgt.StatusWyslaniaDoZefir=src.StatusWyslaniaDoZefir, tgt.WyslanoKomunikatZC272=src.WyslanoKomunikatZC272, tgt.StatusPODZ=src.StatusPODZ, tgt.TIN=src.TIN
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdTowarZCP, KwotaPODZ, UzytaKwota, KomentarzDoPODZ, KodDostepu, KodInnegoRodzajuZabezpieczenia, KodGRN, MRN, NumerPODZ, NumerWlasnyPODZ, IdKontyngentu, StatusWyslaniaDoOSOZ, StatusWyslaniaDoZefir, WyslanoKomunikatZC272, StatusPODZ, TIN)
VALUES (src.IdInformacji, src.IdTowarZCP, src.KwotaPODZ, src.UzytaKwota, src.KomentarzDoPODZ, src.KodDostepu, src.KodInnegoRodzajuZabezpieczenia, src.KodGRN, src.MRN, src.NumerPODZ, src.NumerWlasnyPODZ, src.IdKontyngentu, src.StatusWyslaniaDoOSOZ, src.StatusWyslaniaDoZefir, src.WyslanoKomunikatZC272, src.StatusPODZ, src.TIN);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_InformacjaWDZ' BEGIN
MERGE INTO aimp2.ZCP_InformacjaWDZ AS tgt
USING WA_StageHurtownia.aimp2.ZCP_InformacjaWDZ AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.Autor=src.Autor, tgt.Komentarz=src.Komentarz, tgt.MRN=src.MRN, tgt.NumerWlasnyWDZ=src.NumerWlasnyWDZ, tgt.NumerWlasnyKomunikatuZC282=src.NumerWlasnyKomunikatuZC282, tgt.NumerWlasnyKomunikatuZC283=src.NumerWlasnyKomunikatuZC283, tgt.StatusWDZ=src.StatusWDZ, tgt.TIN=src.TIN, tgt.NumerWDZ=src.NumerWDZ
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdDok, Autor, Komentarz, MRN, NumerWlasnyWDZ, NumerWlasnyKomunikatuZC282, NumerWlasnyKomunikatuZC283, StatusWDZ, TIN, NumerWDZ)
VALUES (src.IdInformacji, src.IdDok, src.Autor, src.Komentarz, src.MRN, src.NumerWlasnyWDZ, src.NumerWlasnyKomunikatuZC282, src.NumerWlasnyKomunikatuZC283, src.StatusWDZ, src.TIN, src.NumerWDZ);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Kontener' BEGIN
MERGE INTO aimp2.ZCP_Kontener AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Kontener AS src
ON (tgt.IdKontenera=src.IdKontenera)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.NumerKontenera=src.NumerKontenera, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdKontenera, IdDok, NumerKontenera, DanePokontrolne)
VALUES (src.IdKontenera, src.IdDok, src.NumerKontenera, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Kontrakt' BEGIN
MERGE INTO aimp2.ZCP_Kontrakt AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Kontrakt AS src
ON (tgt.IdKontraktu=src.IdKontraktu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.DataKontraktu=src.DataKontraktu, tgt.NumerKontraktu=src.NumerKontraktu
WHEN NOT MATCHED
THEN INSERT (IdKontraktu, IdDok, DataKontraktu, NumerKontraktu)
VALUES (src.IdKontraktu, src.IdDok, src.DataKontraktu, src.NumerKontraktu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Kontyngent' BEGIN
MERGE INTO aimp2.ZCP_Kontyngent AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Kontyngent AS src
ON (tgt.IdKontyngentu=src.IdKontyngentu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.JednostkaMiaryWnioskowanejIlosci=src.JednostkaMiaryWnioskowanejIlosci, tgt.JednostkaMiaryWnioskowanejIlosciPid=src.JednostkaMiaryWnioskowanejIlosciPid, tgt.WnioskowanaIloscWRamachKontyngentu=src.WnioskowanaIloscWRamachKontyngentu, tgt.NumerPozycji=src.NumerPozycji, tgt.KwalifikatorJednostkiMiary=src.KwalifikatorJednostkiMiary, tgt.KwalifikatorJednostkiMiaryPid=src.KwalifikatorJednostkiMiaryPid, tgt.OpisKontyngentu=src.OpisKontyngentu, tgt.NumerKontyngentu=src.NumerKontyngentu, tgt.WniosekRetrospektywny=src.WniosekRetrospektywny, tgt.WyslanoDoTQS=src.WyslanoDoTQS, tgt.Status=src.Status, tgt.StatusOgolny=src.StatusOgolny, tgt.StatusSzczegolowy=src.StatusSzczegolowy, tgt.DanePokontrolne=src.DanePokontrolne, tgt.IdDefinicjiKontyngentu=src.IdDefinicjiKontyngentu
WHEN NOT MATCHED
THEN INSERT (IdKontyngentu, IdTowarZCP, JednostkaMiaryWnioskowanejIlosci, JednostkaMiaryWnioskowanejIlosciPid, WnioskowanaIloscWRamachKontyngentu, NumerPozycji, KwalifikatorJednostkiMiary, KwalifikatorJednostkiMiaryPid, OpisKontyngentu, NumerKontyngentu, WniosekRetrospektywny, WyslanoDoTQS, Status, StatusOgolny, StatusSzczegolowy, DanePokontrolne, IdDefinicjiKontyngentu)
VALUES (src.IdKontyngentu, src.IdTowarZCP, src.JednostkaMiaryWnioskowanejIlosci, src.JednostkaMiaryWnioskowanejIlosciPid, src.WnioskowanaIloscWRamachKontyngentu, src.NumerPozycji, src.KwalifikatorJednostkiMiary, src.KwalifikatorJednostkiMiaryPid, src.OpisKontyngentu, src.NumerKontyngentu, src.WniosekRetrospektywny, src.WyslanoDoTQS, src.Status, src.StatusOgolny, src.StatusSzczegolowy, src.DanePokontrolne, src.IdDefinicjiKontyngentu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_LokalizacjaTowarow' BEGIN
MERGE INTO aimp2.ZCP_LokalizacjaTowarow AS tgt
USING WA_StageHurtownia.aimp2.ZCP_LokalizacjaTowarow AS src
ON (tgt.IdLokalizacji=src.IdLokalizacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.DodatkowyIdLokalizacji=src.DodatkowyIdLokalizacji, tgt.KodMiejscaLokalizacji=src.KodMiejscaLokalizacji, tgt.KrajLokalizacji=src.KrajLokalizacji, tgt.OpisMiejscaLokalizacji=src.OpisMiejscaLokalizacji, tgt.UrzadCelnyLokalizacji=src.UrzadCelnyLokalizacji, tgt.KwalifikatorLokalizacji=src.KwalifikatorLokalizacji, tgt.TypLokalizacji=src.TypLokalizacji, tgt.IdentyfikatorAdresu=src.IdentyfikatorAdresu
WHEN NOT MATCHED
THEN INSERT (IdLokalizacji, IdDok, DodatkowyIdLokalizacji, KodMiejscaLokalizacji, KrajLokalizacji, OpisMiejscaLokalizacji, UrzadCelnyLokalizacji, KwalifikatorLokalizacji, TypLokalizacji, IdentyfikatorAdresu)
VALUES (src.IdLokalizacji, src.IdDok, src.DodatkowyIdLokalizacji, src.KodMiejscaLokalizacji, src.KrajLokalizacji, src.OpisMiejscaLokalizacji, src.UrzadCelnyLokalizacji, src.KwalifikatorLokalizacji, src.TypLokalizacji, src.IdentyfikatorAdresu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_MetodaPlatnosci' BEGIN
MERGE INTO aimp2.ZCP_MetodaPlatnosci AS tgt
USING WA_StageHurtownia.aimp2.ZCP_MetodaPlatnosci AS src
ON (tgt.IdMetodyPlatnosci=src.IdMetodyPlatnosci)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.Kwota=src.Kwota, tgt.KwotaZaplacona=src.KwotaZaplacona, tgt.KwotaDoZabezpieczenia=src.KwotaDoZabezpieczenia, tgt.PodstawaOplaty=src.PodstawaOplaty, tgt.DataPowiadomienia=src.DataPowiadomienia, tgt.DataNotyfikacji=src.DataNotyfikacji, tgt.IdPODZ=src.IdPODZ, tgt.KwotaZabezpieczona=src.KwotaZabezpieczona, tgt.MetodaPlatnosci=src.MetodaPlatnosci, tgt.MetodaPlatnosciPid=src.MetodaPlatnosciPid, tgt.Stawka=src.Stawka, tgt.StylWiersza=src.StylWiersza, tgt.TypOplaty=src.TypOplaty, tgt.TypOplatyPid=src.TypOplatyPid, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdMetodyPlatnosci, IdTowarZCP, Kwota, KwotaZaplacona, KwotaDoZabezpieczenia, PodstawaOplaty, DataPowiadomienia, DataNotyfikacji, IdPODZ, KwotaZabezpieczona, MetodaPlatnosci, MetodaPlatnosciPid, Stawka, StylWiersza, TypOplaty, TypOplatyPid, DanePokontrolne)
VALUES (src.IdMetodyPlatnosci, src.IdTowarZCP, src.Kwota, src.KwotaZaplacona, src.KwotaDoZabezpieczenia, src.PodstawaOplaty, src.DataPowiadomienia, src.DataNotyfikacji, src.IdPODZ, src.KwotaZabezpieczona, src.MetodaPlatnosci, src.MetodaPlatnosciPid, src.Stawka, src.StylWiersza, src.TypOplaty, src.TypOplatyPid, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Opakowanie' BEGIN
MERGE INTO aimp2.ZCP_Opakowanie AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Opakowanie AS src
ON (tgt.IdOpakowania=src.IdOpakowania)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.NumeryZnakiOpakowan=src.NumeryZnakiOpakowan, tgt.LiczbaOpakowan=src.LiczbaOpakowan, tgt.RodzajOpakowania=src.RodzajOpakowania, tgt.RodzajOpakowaniaPid=src.RodzajOpakowaniaPid, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdOpakowania, IdTowarZCP, NumeryZnakiOpakowan, LiczbaOpakowan, RodzajOpakowania, RodzajOpakowaniaPid, DanePokontrolne)
VALUES (src.IdOpakowania, src.IdTowarZCP, src.NumeryZnakiOpakowan, src.LiczbaOpakowan, src.RodzajOpakowania, src.RodzajOpakowaniaPid, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Oplaty' BEGIN
MERGE INTO aimp2.ZCP_Oplaty AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Oplaty AS src
ON (tgt.IdOplaty=src.IdOplaty)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDecyzjiAdmin=src.IdDecyzjiAdmin, tgt.IdPODZ=src.IdPODZ, tgt.Kwota=src.Kwota, tgt.KwotaDoZabezpieczenia=src.KwotaDoZabezpieczenia, tgt.PodstawaOplaty=src.PodstawaOplaty, tgt.DataOtrzymaniaPowiadomienia=src.DataOtrzymaniaPowiadomienia, tgt.DataPowiadomieniaODlugu=src.DataPowiadomieniaODlugu, tgt.KwotaZabezpieczona=src.KwotaZabezpieczona, tgt.KwotaZaplacona=src.KwotaZaplacona, tgt.MetodaPlatnosci=src.MetodaPlatnosci, tgt.MetodaPlatnosciPid=src.MetodaPlatnosciPid, tgt.Stawka=src.Stawka, tgt.TypOplaty=src.TypOplaty, tgt.TypOplatyPid=src.TypOplatyPid
WHEN NOT MATCHED
THEN INSERT (IdOplaty, IdDecyzjiAdmin, IdPODZ, Kwota, KwotaDoZabezpieczenia, PodstawaOplaty, DataOtrzymaniaPowiadomienia, DataPowiadomieniaODlugu, KwotaZabezpieczona, KwotaZaplacona, MetodaPlatnosci, MetodaPlatnosciPid, Stawka, TypOplaty, TypOplatyPid)
VALUES (src.IdOplaty, src.IdDecyzjiAdmin, src.IdPODZ, src.Kwota, src.KwotaDoZabezpieczenia, src.PodstawaOplaty, src.DataOtrzymaniaPowiadomienia, src.DataPowiadomieniaODlugu, src.KwotaZabezpieczona, src.KwotaZaplacona, src.MetodaPlatnosci, src.MetodaPlatnosciPid, src.Stawka, src.TypOplaty, src.TypOplatyPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_OsobaFizyczna' BEGIN
MERGE INTO aimp2.ZCP_OsobaFizyczna AS tgt
USING WA_StageHurtownia.aimp2.ZCP_OsobaFizyczna AS src
ON (tgt.IdKontrahenta=src.IdKontrahenta)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.RodzajOsoby=src.RodzajOsoby, tgt.NumerIdentyfikacyjny=src.NumerIdentyfikacyjny, tgt.IdentyfikatorOsoby=src.IdentyfikatorOsoby, tgt.Imie=src.Imie, tgt.Nazwisko=src.Nazwisko, tgt.PESEL=src.PESEL, tgt.RodzajReprezentanta=src.RodzajReprezentanta, tgt.DanePokontrolne=src.DanePokontrolne, tgt.IdAdresu=src.IdAdresu, tgt.IdOsobyPodpisujacejDok=src.IdOsobyPodpisujacejDok
WHEN NOT MATCHED
THEN INSERT (IdKontrahenta, IdDok, PlacowkaPodmiotu, RodzajOsoby, NumerIdentyfikacyjny, IdentyfikatorOsoby, Imie, Nazwisko, PESEL, RodzajReprezentanta, DanePokontrolne, IdAdresu, IdOsobyPodpisujacejDok)
VALUES (src.IdKontrahenta, src.IdDok, src.PlacowkaPodmiotu, src.RodzajOsoby, src.NumerIdentyfikacyjny, src.IdentyfikatorOsoby, src.Imie, src.Nazwisko, src.PESEL, src.RodzajReprezentanta, src.DanePokontrolne, src.IdAdresu, src.IdOsobyPodpisujacejDok);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_OsobaFizycznaInfDodatkowa' BEGIN
MERGE INTO aimp2.ZCP_OsobaFizycznaInfDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.ZCP_OsobaFizycznaInfDodatkowa AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdOsobyFizycznej=src.IdOsobyFizycznej, tgt.KodInfDodatk=src.KodInfDodatk, tgt.KodInfDodatkPid=src.KodInfDodatkPid
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdOsobyFizycznej, KodInfDodatk, KodInfDodatkPid)
VALUES (src.IdInformacji, src.IdOsobyFizycznej, src.KodInfDodatk, src.KodInfDodatkPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Podmiot' BEGIN
MERGE INTO aimp2.ZCP_Podmiot AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Podmiot AS src
ON (tgt.IdKontrahenta=src.IdKontrahenta)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.IdGrupyCertyfAEO=src.IdGrupyCertyfAEO, tgt.PlacowkaPodmiotu=src.PlacowkaPodmiotu, tgt.RolaPodmiotu=src.RolaPodmiotu, tgt.Email=src.Email, tgt.EORI=src.EORI, tgt.IdSISC=src.IdSISC, tgt.IdPodmiotuGospodarczego=src.IdPodmiotuGospodarczego, tgt.NazwaPodmiotu=src.NazwaPodmiotu, tgt.REGON=src.REGON, tgt.TypReprezentacji=src.TypReprezentacji, tgt.TIN=src.TIN, tgt.IdAdresu=src.IdAdresu, tgt.IdOsobyPodpisujacejDok=src.IdOsobyPodpisujacejDok
WHEN NOT MATCHED
THEN INSERT (IdKontrahenta, IdDok, IdGrupyCertyfAEO, PlacowkaPodmiotu, RolaPodmiotu, Email, EORI, IdSISC, IdPodmiotuGospodarczego, NazwaPodmiotu, REGON, TypReprezentacji, TIN, IdAdresu, IdOsobyPodpisujacejDok)
VALUES (src.IdKontrahenta, src.IdDok, src.IdGrupyCertyfAEO, src.PlacowkaPodmiotu, src.RolaPodmiotu, src.Email, src.EORI, src.IdSISC, src.IdPodmiotuGospodarczego, src.NazwaPodmiotu, src.REGON, src.TypReprezentacji, src.TIN, src.IdAdresu, src.IdOsobyPodpisujacejDok);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_PodmiotAdres' BEGIN
MERGE INTO aimp2.ZCP_PodmiotAdres AS tgt
USING WA_StageHurtownia.aimp2.ZCP_PodmiotAdres AS src
ON (tgt.IdAdresu=src.IdAdresu)
WHEN MATCHED
THEN UPDATE SET
tgt.Miasto=src.Miasto, tgt.Kraj=src.Kraj, tgt.KrajPid=src.KrajPid, tgt.UlicaNumer=src.UlicaNumer, tgt.KodPocztowy=src.KodPocztowy
WHEN NOT MATCHED
THEN INSERT (IdAdresu, Miasto, Kraj, KrajPid, UlicaNumer, KodPocztowy)
VALUES (src.IdAdresu, src.Miasto, src.Kraj, src.KrajPid, src.UlicaNumer, src.KodPocztowy);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_PodmiotInfDodatkowa' BEGIN
MERGE INTO aimp2.ZCP_PodmiotInfDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.ZCP_PodmiotInfDodatkowa AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdPodmiotuGospodarczego=src.IdPodmiotuGospodarczego, tgt.KodInfDodPodm=src.KodInfDodPodm
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdPodmiotuGospodarczego, KodInfDodPodm)
VALUES (src.IdInformacji, src.IdPodmiotuGospodarczego, src.KodInfDodPodm);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Procedura' BEGIN
MERGE INTO aimp2.ZCP_Procedura AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Procedura AS src
ON (tgt.IdProcedury=src.IdProcedury)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.Kod=src.Kod, tgt.KodPid=src.KodPid, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdProcedury, IdTowarZCP, Kod, KodPid, DanePokontrolne)
VALUES (src.IdProcedury, src.IdTowarZCP, src.Kod, src.KodPid, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Samochody' BEGIN
MERGE INTO aimp2.ZCP_Samochody AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Samochody AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.NumerNadwozia=src.NumerNadwozia, tgt.Pojemnosc=src.Pojemnosc, tgt.NumerSilnika=src.NumerSilnika, tgt.RodzajPaliwa=src.RodzajPaliwa, tgt.RodzajPaliwaPid=src.RodzajPaliwaPid, tgt.Marka=src.Marka, tgt.MarkaPid=src.MarkaPid, tgt.Model=src.Model, tgt.RokProdukcji=src.RokProdukcji
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdTowarZCP, NumerNadwozia, Pojemnosc, NumerSilnika, RodzajPaliwa, RodzajPaliwaPid, Marka, MarkaPid, Model, RokProdukcji)
VALUES (src.IdWpisu, src.IdTowarZCP, src.NumerNadwozia, src.Pojemnosc, src.NumerSilnika, src.RodzajPaliwa, src.RodzajPaliwaPid, src.Marka, src.MarkaPid, src.Model, src.RokProdukcji);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_SrodekTaryfowy' BEGIN
MERGE INTO aimp2.ZCP_SrodekTaryfowy AS tgt
USING WA_StageHurtownia.aimp2.ZCP_SrodekTaryfowy AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.SrodeArchiwalny=src.SrodeArchiwalny, tgt.Przypisy=src.Przypisy, tgt.ObszarGeograficzny=src.ObszarGeograficzny, tgt.IdSrodka=src.IdSrodka, tgt.DataRejestracji=src.DataRejestracji, tgt.NumerWpisu=src.NumerWpisu, tgt.Seria=src.Seria, tgt.SID=src.SID, tgt.Typ=src.Typ, tgt.KodUAM=src.KodUAM, tgt.KwalifikatorUAM=src.KwalifikatorUAM
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdTowarZCP, SrodeArchiwalny, Przypisy, ObszarGeograficzny, IdSrodka, DataRejestracji, NumerWpisu, Seria, SID, Typ, KodUAM, KwalifikatorUAM)
VALUES (src.IdWpisu, src.IdTowarZCP, src.SrodeArchiwalny, src.Przypisy, src.ObszarGeograficzny, src.IdSrodka, src.DataRejestracji, src.NumerWpisu, src.Seria, src.SID, src.Typ, src.KodUAM, src.KwalifikatorUAM);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Towar' BEGIN
MERGE INTO aimp2.ZCP_Towar AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Towar AS src
ON (tgt.IdPozycji=src.IdPozycji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.AGRIM=src.AGRIM, tgt.SaldoARR=src.SaldoARR, tgt.StatusPrzetwarzaniaPozycjiARR=src.StatusPrzetwarzaniaPozycjiARR, tgt.IdKupujacegoOsobaFizyczna=src.IdKupujacegoOsobaFizyczna, tgt.IdPodmiotuDoKontaktu=src.IdPodmiotuDoKontaktu, tgt.IdOdbiorcyPodmiotGospodarczy=src.IdOdbiorcyPodmiotGospodarczy, tgt.IdSprzedajacegoPodmiotGospodarczy=src.IdSprzedajacegoPodmiotGospodarczy, tgt.IdNadawcyPodmiotGospodarczy=src.IdNadawcyPodmiotGospodarczy, tgt.DataDoKalkulacji1=src.DataDoKalkulacji1, tgt.DataDoKalkulacji2=src.DataDoKalkulacji2, tgt.KodCN=src.KodCN, tgt.RzeczywistyKodTowarowy=src.RzeczywistyKodTowarowy, tgt.IdPodmiotuZPozwNaSamoobslugeCelna=src.IdPodmiotuZPozwNaSamoobslugeCelna, tgt.KontynuacjaProcesu=src.KontynuacjaProcesu, tgt.KrajPrzeznaczenia=src.KrajPrzeznaczenia, tgt.KrajPrzeznaczeniaPid=src.KrajPrzeznaczeniaPid, tgt.KrajPrzeznaczeniaRegion=src.KrajPrzeznaczeniaRegion, tgt.KrajPrzeznaczeniaRegionPid=src.KrajPrzeznaczeniaRegionPid, tgt.KrajWysylki=src.KrajWysylki, tgt.KrajWysylkiPid=src.KrajWysylkiPid, tgt.KrajPochodzenia=src.KrajPochodzenia, tgt.KrajPochodzeniaPid=src.KrajPochodzeniaPid, tgt.WynikWalidacjiCRX_REX=src.WynikWalidacjiCRX_REX, tgt.KodWaluty=src.KodWaluty, tgt.KodWalutyPid=src.KodWalutyPid, tgt.KodCUS=src.KodCUS, tgt.IdDecyzjiAdminUsuwajacejPozycje=src.IdDecyzjiAdminUsuwajacejPozycje, tgt.OpisNieprawidlowosci=src.OpisNieprawidlowosci, tgt.EAD=src.EAD, tgt.EMCSNumerARC=src.EMCSNumerARC, tgt.EMCSKodCN=src.EMCSKodCN, tgt.EMCSMasaNetto=src.EMCSMasaNetto, tgt.EMCSStatusPrzetwarzaniaPozycji=src.EMCSStatusPrzetwarzaniaPozycji, tgt.EMCSTryb=src.EMCSTryb, tgt.MasaBrutto=src.MasaBrutto, tgt.ZarejestrowaneZabezpieczenie=src.ZarejestrowaneZabezpieczenie, tgt.IdPozycjiZdefiniowanejPDS=src.IdPozycjiZdefiniowanejPDS, tgt.IdDanychCelnychPozycjiPDS=src.IdDanychCelnychPozycjiPDS, tgt.DataUniewaznienia=src.DataUniewaznienia, tgt.UniewaznionoPozycjeManualnie=src.UniewaznionoPozycjeManualnie, tgt.PowodUniewaznieniaPozycji=src.PowodUniewaznieniaPozycji, tgt.PowodOdrzuceniaUniewaznieniaPozycji=src.PowodOdrzuceniaUniewaznieniaPozycji, tgt.NumerWlasnyWnioskuOUniewaznienie=src.NumerWlasnyWnioskuOUniewaznienie, tgt.KodTowarowy=src.KodTowarowy, tgt.OpisPozycji=src.OpisPozycji, tgt.NumerPozycji=src.NumerPozycji, tgt.Wartosc=src.Wartosc, tgt.TrescAdnotacjiUrzedowych=src.TrescAdnotacjiUrzedowych, tgt.NrPozycjiSrodkaTARIC=src.NrPozycjiSrodkaTARIC, tgt.KodTypuSrodkaTARIC=src.KodTypuSrodkaTARIC, tgt.MasaNetto=src.MasaNetto, tgt.RzeczywistaMasaNetto=src.RzeczywistaMasaNetto, tgt.Adnotacje=src.Adnotacje, tgt.IdKupujacegoPodmiotGospodarczy=src.IdKupujacegoPodmiotGospodarczy, tgt.IdOsobyDoKontaktu=src.IdOsobyDoKontaktu, tgt.IdOdbiorcyOsobaFizyczna=src.IdOdbiorcyOsobaFizyczna, tgt.IdSprzedajacegoOsobaFizyczna=src.IdSprzedajacegoOsobaFizyczna, tgt.IdNadawcyOsobaFizyczna=src.IdNadawcyOsobaFizyczna, tgt.ZaksiegowanoZerowePlatnosciZEFIR=src.ZaksiegowanoZerowePlatnosciZEFIR, tgt.KodKrajuPreferencyjnegoPochodzenia=src.KodKrajuPreferencyjnegoPochodzenia, tgt.KodKrajuPreferencyjnegoPochodzeniaPid=src.KodKrajuPreferencyjnegoPochodzeniaPid, tgt.NumerReferencyjnyPrzesylki=src.NumerReferencyjnyPrzesylki, tgt.PlatnoscZarejestrowana=src.PlatnoscZarejestrowana, tgt.KodPreferencji=src.KodPreferencji, tgt.KodPreferencjiPid=src.KodPreferencjiPid, tgt.KodProceduryPoprzedniej=src.KodProceduryPoprzedniej, tgt.KodProceduryPoprzedniejPid=src.KodProceduryPoprzedniejPid, tgt.KodProceduryWnioskowanej=src.KodProceduryWnioskowanej, tgt.KodProceduryWnioskowanejPid=src.KodProceduryWnioskowanejPid, tgt.ZrealizowanePlatnosciZEFIR=src.ZrealizowanePlatnosciZEFIR, tgt.IloscTowaru=src.IloscTowaru, tgt.IloscTowaruUzupelniajacaJednostkaMiary=src.IloscTowaruUzupelniajacaJednostkaMiary, tgt.DataZwolnieniaTowaru=src.DataZwolnieniaTowaru, tgt.PodstawaUregulowaniaStatusu=src.PodstawaUregulowaniaStatusu, tgt.TerminUregulowaniaStatusu=src.TerminUregulowaniaStatusu, tgt.SposobUregulowaniaStatusu=src.SposobUregulowaniaStatusu, 
 tgt.StatusWyslaniaPozycjiDoOSOZ=src.StatusWyslaniaPozycjiDoOSOZ, tgt.StatusWyslaniaPozycjiDoZEFIR=src.StatusWyslaniaPozycjiDoZEFIR, tgt.WyslanoKomunikatZC272=src.WyslanoKomunikatZC272, tgt.EMCSOczekiwanie=src.EMCSOczekiwanie, tgt.KodTARIC=src.KodTARIC, tgt.TQSOdrzucenie=src.TQSOdrzucenie, tgt.IdZgloszeniaUzupelniajacego=src.IdZgloszeniaUzupelniajacego, tgt.VAT7DecyzjaAdministracyjna=src.VAT7DecyzjaAdministracyjna, tgt.VAT7Zamkniecia=src.VAT7Zamkniecia, tgt.VAT7DataCzasZaplaty=src.VAT7DataCzasZaplaty, tgt.WynikWeryfikacji=src.WynikWeryfikacji, tgt.DanePokontrolne=src.DanePokontrolne, tgt.StatusPozycji=src.StatusPozycji, tgt.LiczbaSprostowanWyslanychDoZEFIR=src.LiczbaSprostowanWyslanychDoZEFIR
WHEN NOT MATCHED
THEN INSERT (IdPozycji, IdDok, AGRIM, SaldoARR, StatusPrzetwarzaniaPozycjiARR, IdKupujacegoOsobaFizyczna, IdPodmiotuDoKontaktu, IdOdbiorcyPodmiotGospodarczy, IdSprzedajacegoPodmiotGospodarczy, IdNadawcyPodmiotGospodarczy, DataDoKalkulacji1, DataDoKalkulacji2, KodCN, RzeczywistyKodTowarowy, IdPodmiotuZPozwNaSamoobslugeCelna, KontynuacjaProcesu, KrajPrzeznaczenia, KrajPrzeznaczeniaPid, KrajPrzeznaczeniaRegion, KrajPrzeznaczeniaRegionPid, KrajWysylki, KrajWysylkiPid, KrajPochodzenia, KrajPochodzeniaPid, WynikWalidacjiCRX_REX, KodWaluty, KodWalutyPid, KodCUS, IdDecyzjiAdminUsuwajacejPozycje, OpisNieprawidlowosci, EAD, EMCSNumerARC, EMCSKodCN, EMCSMasaNetto, EMCSStatusPrzetwarzaniaPozycji, EMCSTryb, MasaBrutto, ZarejestrowaneZabezpieczenie, IdPozycjiZdefiniowanejPDS, IdDanychCelnychPozycjiPDS, DataUniewaznienia, UniewaznionoPozycjeManualnie, PowodUniewaznieniaPozycji, PowodOdrzuceniaUniewaznieniaPozycji, NumerWlasnyWnioskuOUniewaznienie, KodTowarowy, OpisPozycji, NumerPozycji, Wartosc, TrescAdnotacjiUrzedowych, NrPozycjiSrodkaTARIC, KodTypuSrodkaTARIC, MasaNetto, RzeczywistaMasaNetto, Adnotacje, IdKupujacegoPodmiotGospodarczy, IdOsobyDoKontaktu, IdOdbiorcyOsobaFizyczna, IdSprzedajacegoOsobaFizyczna, IdNadawcyOsobaFizyczna, ZaksiegowanoZerowePlatnosciZEFIR, KodKrajuPreferencyjnegoPochodzenia, KodKrajuPreferencyjnegoPochodzeniaPid, NumerReferencyjnyPrzesylki, PlatnoscZarejestrowana, KodPreferencji, KodPreferencjiPid, KodProceduryPoprzedniej, KodProceduryPoprzedniejPid, KodProceduryWnioskowanej, KodProceduryWnioskowanejPid, ZrealizowanePlatnosciZEFIR, IloscTowaru, IloscTowaruUzupelniajacaJednostkaMiary, DataZwolnieniaTowaru, PodstawaUregulowaniaStatusu, TerminUregulowaniaStatusu, SposobUregulowaniaStatusu, StatusWyslaniaPozycjiDoOSOZ, StatusWyslaniaPozycjiDoZEFIR, WyslanoKomunikatZC272, EMCSOczekiwanie, KodTARIC, TQSOdrzucenie, IdZgloszeniaUzupelniajacego, VAT7DecyzjaAdministracyjna, VAT7Zamkniecia, VAT7DataCzasZaplaty, WynikWeryfikacji, DanePokontrolne, StatusPozycji, LiczbaSprostowanWyslanychDoZEFIR)
VALUES (src.IdPozycji, src.IdDok, src.AGRIM, src.SaldoARR, src.StatusPrzetwarzaniaPozycjiARR, src.IdKupujacegoOsobaFizyczna, src.IdPodmiotuDoKontaktu, src.IdOdbiorcyPodmiotGospodarczy, src.IdSprzedajacegoPodmiotGospodarczy, src.IdNadawcyPodmiotGospodarczy, src.DataDoKalkulacji1, src.DataDoKalkulacji2, src.KodCN, src.RzeczywistyKodTowarowy, src.IdPodmiotuZPozwNaSamoobslugeCelna, src.KontynuacjaProcesu, src.KrajPrzeznaczenia, src.KrajPrzeznaczeniaPid, src.KrajPrzeznaczeniaRegion, src.KrajPrzeznaczeniaRegionPid, src.KrajWysylki, src.KrajWysylkiPid, src.KrajPochodzenia, src.KrajPochodzeniaPid, src.WynikWalidacjiCRX_REX, src.KodWaluty, src.KodWalutyPid, src.KodCUS, src.IdDecyzjiAdminUsuwajacejPozycje, src.OpisNieprawidlowosci, src.EAD, src.EMCSNumerARC, src.EMCSKodCN, src.EMCSMasaNetto, src.EMCSStatusPrzetwarzaniaPozycji, src.EMCSTryb, src.MasaBrutto, src.ZarejestrowaneZabezpieczenie, src.IdPozycjiZdefiniowanejPDS, src.IdDanychCelnychPozycjiPDS, src.DataUniewaznienia, src.UniewaznionoPozycjeManualnie, src.PowodUniewaznieniaPozycji, src.PowodOdrzuceniaUniewaznieniaPozycji, src.NumerWlasnyWnioskuOUniewaznienie, src.KodTowarowy, src.OpisPozycji, src.NumerPozycji, src.Wartosc, src.TrescAdnotacjiUrzedowych, src.NrPozycjiSrodkaTARIC, src.KodTypuSrodkaTARIC, src.MasaNetto, src.RzeczywistaMasaNetto, src.Adnotacje, src.IdKupujacegoPodmiotGospodarczy, src.IdOsobyDoKontaktu, src.IdOdbiorcyOsobaFizyczna, src.IdSprzedajacegoOsobaFizyczna, src.IdNadawcyOsobaFizyczna, src.ZaksiegowanoZerowePlatnosciZEFIR, src.KodKrajuPreferencyjnegoPochodzenia, src.KodKrajuPreferencyjnegoPochodzeniaPid, src.NumerReferencyjnyPrzesylki, src.PlatnoscZarejestrowana, src.KodPreferencji, src.KodPreferencjiPid, src.KodProceduryPoprzedniej, src.KodProceduryPoprzedniejPid, src.KodProceduryWnioskowanej, src.KodProceduryWnioskowanejPid, src.ZrealizowanePlatnosciZEFIR, src.IloscTowaru, src.IloscTowaruUzupelniajacaJednostkaMiary, src.DataZwolnieniaTowaru, src.PodstawaUregulowaniaStatusu, src.TerminUregulowaniaStatusu, src.SposobUregulowaniaStatusu, src.StatusWyslaniaPozycjiDoOSOZ, src.StatusWyslaniaPozycjiDoZEFIR, src.WyslanoKomunikatZC272, src.EMCSOczekiwanie, src.KodTARIC, src.TQSOdrzucenie, src.IdZgloszeniaUzupelniajacego, src.VAT7DecyzjaAdministracyjna, src.VAT7Zamkniecia, src.VAT7DataCzasZaplaty, src.WynikWeryfikacji, src.DanePokontrolne, src.StatusPozycji, src.LiczbaSprostowanWyslanychDoZEFIR);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_TowarDokumentPoprzedni' BEGIN
MERGE INTO aimp2.ZCP_TowarDokumentPoprzedni AS tgt
USING WA_StageHurtownia.aimp2.ZCP_TowarDokumentPoprzedni AS src
ON (tgt.IdDokPoprzed=src.IdDokPoprzed)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.Kategoria=src.Kategoria, tgt.KategoriaPid=src.KategoriaPid, tgt.KodDokPoprz=src.KodDokPoprz, tgt.KodDokPoprzPid=src.KodDokPoprzPid, tgt.Numer=src.Numer, tgt.NumerDokumentu=src.NumerDokumentu, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdDokPoprzed, IdTowarZCP, Kategoria, KategoriaPid, KodDokPoprz, KodDokPoprzPid, Numer, NumerDokumentu, DanePokontrolne)
VALUES (src.IdDokPoprzed, src.IdTowarZCP, src.Kategoria, src.KategoriaPid, src.KodDokPoprz, src.KodDokPoprzPid, src.Numer, src.NumerDokumentu, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_TowarDokumentPoprzedniPozycje' BEGIN
MERGE INTO aimp2.ZCP_TowarDokumentPoprzedniPozycje AS tgt
USING WA_StageHurtownia.aimp2.ZCP_TowarDokumentPoprzedniPozycje AS src
ON (tgt.IdPozycji=src.IdPozycji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDokPoprzed=src.IdDokPoprzed, tgt.NumerPozycji=src.NumerPozycji
WHEN NOT MATCHED
THEN INSERT (IdPozycji, IdDokPoprzed, NumerPozycji)
VALUES (src.IdPozycji, src.IdDokPoprzed, src.NumerPozycji);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_TowarInformacjaDodatkowa' BEGIN
MERGE INTO aimp2.ZCP_TowarInformacjaDodatkowa AS tgt
USING WA_StageHurtownia.aimp2.ZCP_TowarInformacjaDodatkowa AS src
ON (tgt.IdInfDod=src.IdInfDod)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.KodInfDodatk=src.KodInfDodatk, tgt.KodInfDodatkPid=src.KodInfDodatkPid, tgt.OpisInfDodatk=src.OpisInfDodatk, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdInfDod, IdTowarZCP, KodInfDodatk, KodInfDodatkPid, OpisInfDodatk, DanePokontrolne)
VALUES (src.IdInfDod, src.IdTowarZCP, src.KodInfDodatk, src.KodInfDodatkPid, src.OpisInfDodatk, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_TowarInformacjaWDZ' BEGIN
MERGE INTO aimp2.ZCP_TowarInformacjaWDZ AS tgt
USING WA_StageHurtownia.aimp2.ZCP_TowarInformacjaWDZ AS src
ON (tgt.IdInformacji=src.IdInformacji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.KwotaWDZ=src.KwotaWDZ, tgt.UzytaKwotaZabezpieczenia=src.UzytaKwotaZabezpieczenia, tgt.KomentarzDoWDZ=src.KomentarzDoWDZ, tgt.KodDostepu=src.KodDostepu, tgt.KodInnegoRodzajuZabezpieczenia=src.KodInnegoRodzajuZabezpieczenia, tgt.KodGRN=src.KodGRN, tgt.MRN=src.MRN, tgt.NumerKolejnegoWDZ=src.NumerKolejnegoWDZ, tgt.IdKontyngentu=src.IdKontyngentu, tgt.StatusWyslaniaDoOSOZ=src.StatusWyslaniaDoOSOZ, tgt.StatusWyslaniaDoZefira=src.StatusWyslaniaDoZefira, tgt.WyslanoKomunikatZC272=src.WyslanoKomunikatZC272, tgt.StatusWDZ=src.StatusWDZ, tgt.TIN=src.TIN, tgt.NumerWDZ=src.NumerWDZ
WHEN NOT MATCHED
THEN INSERT (IdInformacji, IdTowarZCP, KwotaWDZ, UzytaKwotaZabezpieczenia, KomentarzDoWDZ, KodDostepu, KodInnegoRodzajuZabezpieczenia, KodGRN, MRN, NumerKolejnegoWDZ, IdKontyngentu, StatusWyslaniaDoOSOZ, StatusWyslaniaDoZefira, WyslanoKomunikatZC272, StatusWDZ, TIN, NumerWDZ)
VALUES (src.IdInformacji, src.IdTowarZCP, src.KwotaWDZ, src.UzytaKwotaZabezpieczenia, src.KomentarzDoWDZ, src.KodDostepu, src.KodInnegoRodzajuZabezpieczenia, src.KodGRN, src.MRN, src.NumerKolejnegoWDZ, src.IdKontyngentu, src.StatusWyslaniaDoOSOZ, src.StatusWyslaniaDoZefira, src.WyslanoKomunikatZC272, src.StatusWDZ, src.TIN, src.NumerWDZ);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_TowarKontener' BEGIN
MERGE INTO aimp2.ZCP_TowarKontener AS tgt
USING WA_StageHurtownia.aimp2.ZCP_TowarKontener AS src
ON (tgt.IdKontenera=src.IdKontenera)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.NumerKontenera=src.NumerKontenera, tgt.DanePokontrolne=src.DanePokontrolne
WHEN NOT MATCHED
THEN INSERT (IdKontenera, IdTowarZCP, NumerKontenera, DanePokontrolne)
VALUES (src.IdKontenera, src.IdTowarZCP, src.NumerKontenera, src.DanePokontrolne);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_TowarKontrakt' BEGIN
MERGE INTO aimp2.ZCP_TowarKontrakt AS tgt
USING WA_StageHurtownia.aimp2.ZCP_TowarKontrakt AS src
ON (tgt.IdKontraktu=src.IdKontraktu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.DataKontraktu=src.DataKontraktu, tgt.NumerKontraktu=src.NumerKontraktu
WHEN NOT MATCHED
THEN INSERT (IdKontraktu, IdTowarZCP, DataKontraktu, NumerKontraktu)
VALUES (src.IdKontraktu, src.IdTowarZCP, src.DataKontraktu, src.NumerKontraktu);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_Transakcje' BEGIN
MERGE INTO aimp2.ZCP_Transakcje AS tgt
USING WA_StageHurtownia.aimp2.ZCP_Transakcje AS src
ON (tgt.IdTransakcji=src.IdTransakcji)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.KursWaluty=src.KursWaluty, tgt.WalutaFaktur=src.WalutaFaktur, tgt.WalutaFakturPid=src.WalutaFakturPid, tgt.RodzajTransakcji=src.RodzajTransakcji, tgt.RodzajTransakcjiPid=src.RodzajTransakcjiPid, tgt.SzczegolyWartosci=src.SzczegolyWartosci
WHEN NOT MATCHED
THEN INSERT (IdTransakcji, IdDok, KursWaluty, WalutaFaktur, WalutaFakturPid, RodzajTransakcji, RodzajTransakcjiPid, SzczegolyWartosci)
VALUES (src.IdTransakcji, src.IdDok, src.KursWaluty, src.WalutaFaktur, src.WalutaFakturPid, src.RodzajTransakcji, src.RodzajTransakcjiPid, src.SzczegolyWartosci);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_TransportNaGranicy' BEGIN
MERGE INTO aimp2.ZCP_TransportNaGranicy AS tgt
USING WA_StageHurtownia.aimp2.ZCP_TransportNaGranicy AS src
ON (tgt.IdTransportu=src.IdTransportu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.RodzajTransportu=src.RodzajTransportu, tgt.RodzajTransportuPid=src.RodzajTransportuPid, tgt.ZnakiSrodkaTransportu=src.ZnakiSrodkaTransportu, tgt.PrzynaleznoscPanstwowaSrodkaTransportu=src.PrzynaleznoscPanstwowaSrodkaTransportu, tgt.PrzynaleznoscPanstwowaSrodkaTransportuPid=src.PrzynaleznoscPanstwowaSrodkaTransportuPid, tgt.OznaczenieSrodkaTransportu=src.OznaczenieSrodkaTransportu, tgt.OznaczenieSrodkaTransportuPid=src.OznaczenieSrodkaTransportuPid
WHEN NOT MATCHED
THEN INSERT (IdTransportu, IdDok, RodzajTransportu, RodzajTransportuPid, ZnakiSrodkaTransportu, PrzynaleznoscPanstwowaSrodkaTransportu, PrzynaleznoscPanstwowaSrodkaTransportuPid, OznaczenieSrodkaTransportu, OznaczenieSrodkaTransportuPid)
VALUES (src.IdTransportu, src.IdDok, src.RodzajTransportu, src.RodzajTransportuPid, src.ZnakiSrodkaTransportu, src.PrzynaleznoscPanstwowaSrodkaTransportu, src.PrzynaleznoscPanstwowaSrodkaTransportuPid, src.OznaczenieSrodkaTransportu, src.OznaczenieSrodkaTransportuPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_TransportWewnetrzny' BEGIN
MERGE INTO aimp2.ZCP_TransportWewnetrzny AS tgt
USING WA_StageHurtownia.aimp2.ZCP_TransportWewnetrzny AS src
ON (tgt.IdTransportu=src.IdTransportu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.RodzajTransportu=src.RodzajTransportu, tgt.RodzajTransportuPid=src.RodzajTransportuPid, tgt.ZnakiSrodkaTransportu=src.ZnakiSrodkaTransportu, tgt.PrzynaleznoscPanstwowaSrodkaTransportu=src.PrzynaleznoscPanstwowaSrodkaTransportu, tgt.PrzynaleznoscPanstwowaSrodkaTransportuPid=src.PrzynaleznoscPanstwowaSrodkaTransportuPid, tgt.OznaczenieSrodkaTransportu=src.OznaczenieSrodkaTransportu, tgt.OznaczenieSrodkaTransportuPid=src.OznaczenieSrodkaTransportuPid
WHEN NOT MATCHED
THEN INSERT (IdTransportu, IdDok, RodzajTransportu, RodzajTransportuPid, ZnakiSrodkaTransportu, PrzynaleznoscPanstwowaSrodkaTransportu, PrzynaleznoscPanstwowaSrodkaTransportuPid, OznaczenieSrodkaTransportu, OznaczenieSrodkaTransportuPid)
VALUES (src.IdTransportu, src.IdDok, src.RodzajTransportu, src.RodzajTransportuPid, src.ZnakiSrodkaTransportu, src.PrzynaleznoscPanstwowaSrodkaTransportu, src.PrzynaleznoscPanstwowaSrodkaTransportuPid, src.OznaczenieSrodkaTransportu, src.OznaczenieSrodkaTransportuPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_WartoscTowarow' BEGIN
MERGE INTO aimp2.ZCP_WartoscTowarow AS tgt
USING WA_StageHurtownia.aimp2.ZCP_WartoscTowarow AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdTowarZCP=src.IdTowarZCP, tgt.WartoscTowaru=src.WartoscTowaru, tgt.WartoscStatystyczna=src.WartoscStatystyczna, tgt.MetodaWartosciowania=src.MetodaWartosciowania, tgt.MetodaWartosciowaniaPid=src.MetodaWartosciowaniaPid
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdTowarZCP, WartoscTowaru, WartoscStatystyczna, MetodaWartosciowania, MetodaWartosciowaniaPid)
VALUES (src.IdWpisu, src.IdTowarZCP, src.WartoscTowaru, src.WartoscStatystyczna, src.MetodaWartosciowania, src.MetodaWartosciowaniaPid);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZCP_WarunkiDostawy' BEGIN
MERGE INTO aimp2.ZCP_WarunkiDostawy AS tgt
USING WA_StageHurtownia.aimp2.ZCP_WarunkiDostawy AS src
ON (tgt.IdWpisu=src.IdWpisu)
WHEN MATCHED
THEN UPDATE SET
tgt.IdDok=src.IdDok, tgt.Kod=src.Kod, tgt.KodPid=src.KodPid, tgt.Kraj=src.Kraj, tgt.KrajPid=src.KrajPid, tgt.Miejsce=src.Miejsce, tgt.KodPolozeniaMiejscaDostawy=src.KodPolozeniaMiejscaDostawy, tgt.KodPolozeniaMiejscaDostawyPid=src.KodPolozeniaMiejscaDostawyPid, tgt.KodBlokady=src.KodBlokady
WHEN NOT MATCHED
THEN INSERT (IdWpisu, IdDok, Kod, KodPid, Kraj, KrajPid, Miejsce, KodPolozeniaMiejscaDostawy, KodPolozeniaMiejscaDostawyPid, KodBlokady)
VALUES (src.IdWpisu, src.IdDok, src.Kod, src.KodPid, src.Kraj, src.KrajPid, src.Miejsce, src.KodPolozeniaMiejscaDostawy, src.KodPolozeniaMiejscaDostawyPid, src.KodBlokady);
SET @Merged = 1;
END






	IF (@Merged = 0)
	BEGIN
		DECLARE @Info VARCHAR(500) = 'W procedurze nie znaleziono bloku odpowiadającego tabeli [' + @TableName + '] z parametru @TableName.';
		THROW 51002, @Info, 0;
	END


END