
-- ==============================================
-- Author:		
-- Create date: 2015-11-26
-- Description:	
-- ===============================================

CREATE PROCEDURE [zef2].[MergeTableFromStageHurtownia] (@TableName VARCHAR(50) = NULL)
AS
BEGIN
	SET NOCOUNT ON;
	DECLARE @Merged BIT = 0;

	IF (@TableName IS NULL) BEGIN
		;THROW 51001, 'Nie wskazano nazwy tabeli w parametrze @TableName procedury.', 0;
		END


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'AtrybutyKlasyfikacji' BEGIN
MERGE INTO zef2.AtrybutyKlasyfikacji AS tgt
USING WA_StageHurtownia.zef2.AtrybutyKlasyfikacji AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.KodAtrybutu=src.KodAtrybutu, tgt.Nazwa=src.Nazwa, tgt.CzyZablokowane=src.CzyZablokowane, tgt.TypAtrybutuKlasyfikacji=src.TypAtrybutuKlasyfikacji, tgt.RodzajWydatku=src.RodzajWydatku, tgt.OdwolanieDoAtrybutuNadrzednego=src.OdwolanieDoAtrybutuNadrzednego, tgt.CzyWymaganyProgram=src.CzyWymaganyProgram, tgt.CzyWymaganyProjekt=src.CzyWymaganyProjekt, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.GrupaEkonomicznaOgolna=src.GrupaEkonomicznaOgolna, tgt.CzyWidocznyWWymiarze=src.CzyWidocznyWWymiarze, tgt.RodzajBudzetu=src.RodzajBudzetu, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.CzyWymaganaGrupaZatrDlaLimitow=src.CzyWymaganaGrupaZatrDlaLimitow, tgt.CzyRozdzialMacierzystyIC=src.CzyRozdzialMacierzystyIC, tgt.CzyRozdzialMacierzystyIS=src.CzyRozdzialMacierzystyIS, tgt.CzyRozdzialMacierzystyUKS=src.CzyRozdzialMacierzystyUKS
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (KodAtrybutu, Nazwa, CzyZablokowane, TypAtrybutuKlasyfikacji, RodzajWydatku, OdwolanieDoAtrybutuNadrzednego, CzyWymaganyProgram, CzyWymaganyProjekt, KodGrupyZatrudnienia, GrupaEkonomicznaOgolna, CzyWidocznyWWymiarze, RodzajBudzetu, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, CzyWymaganaGrupaZatrDlaLimitow, CzyRozdzialMacierzystyIC, CzyRozdzialMacierzystyIS, CzyRozdzialMacierzystyUKS)
VALUES (src.KodAtrybutu, src.Nazwa, src.CzyZablokowane, src.TypAtrybutuKlasyfikacji, src.RodzajWydatku, src.OdwolanieDoAtrybutuNadrzednego, src.CzyWymaganyProgram, src.CzyWymaganyProjekt, src.KodGrupyZatrudnienia, src.GrupaEkonomicznaOgolna, src.CzyWidocznyWWymiarze, src.RodzajBudzetu, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.CzyWymaganaGrupaZatrDlaLimitow, src.CzyRozdzialMacierzystyIC, src.CzyRozdzialMacierzystyIS, src.CzyRozdzialMacierzystyUKS)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'Bilans_Dokument' BEGIN
MERGE INTO zef2.Bilans_Dokument AS tgt
USING WA_StageHurtownia.zef2.Bilans_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.TypSprawozdania=src.TypSprawozdania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatorRekordu, NumerSprawozdania, OkresSprawozdawczy, Opis, Zalacznik, ZalacznikStornowania, CzyZaksiegowane, PrzetwarzanyProfilKsiegowania, TypSprawozdania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, OpisWyjasnienie, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, KodGrupyDefinicji)
VALUES (src.IdentyfikatorRekordu, src.NumerSprawozdania, src.OkresSprawozdawczy, src.Opis, src.Zalacznik, src.ZalacznikStornowania, src.CzyZaksiegowane, src.PrzetwarzanyProfilKsiegowania, src.TypSprawozdania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.OpisWyjasnienie, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'Bilans_Pozycje' BEGIN
MERGE INTO zef2.Bilans_Pozycje AS tgt
USING WA_StageHurtownia.zef2.Bilans_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.IdSprawozdania=src.IdSprawozdania, tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.StanNaKoniecRokuPoprzedniego=src.StanNaKoniecRokuPoprzedniego, tgt.StanNaKoniecRokuBiezacego=src.StanNaKoniecRokuBiezacego, tgt.KodWiersza=src.KodWiersza, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Paragraf=src.Paragraf, tgt.Czesc=src.Czesc, tgt.IdProgramu=src.IdProgramu, tgt.KodProjektu=src.KodProjektu, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Dzialanie=src.Dzialanie, tgt.Wymiar=src.Wymiar, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.NazwaProgramu=src.NazwaProgramu, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.Uwagi=src.Uwagi, tgt.PowodUmorzenia=src.PowodUmorzenia
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatoRekordu, IdSprawozdania, Opis, NumerWiersza, StanNaKoniecRokuPoprzedniego, StanNaKoniecRokuBiezacego, KodWiersza, KodPozycjiTrezor, KodSekcjiTrezor, WersjaRekordu, Partycja, IdUzytkownikaTworzacego, DataGodzUtworzeniaRekordu, IdTransakcjiUtworzeniaRekordu, AdresOdbiorcy, NazwaOdbiorcy, KodGrupyZatrudnienia, Klasyfikacja, Paragraf, Czesc, IdProgramu, KodProjektu, Dzial, Rozdzial, Dzialanie, Wymiar, KontoKsiegowe, IdUzytkownikaOstatnModyfikujacego, DataGodzOstatnModyfikacji, IdTransakcjiModyfikacji, NazwaProgramu, PrzyczynyDecyzjiUmorzenia, Uwagi, PowodUmorzenia)
VALUES (src.IdentyfikatoRekordu, src.IdSprawozdania, src.Opis, src.NumerWiersza, src.StanNaKoniecRokuPoprzedniego, src.StanNaKoniecRokuBiezacego, src.KodWiersza, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.WersjaRekordu, src.Partycja, src.IdUzytkownikaTworzacego, src.DataGodzUtworzeniaRekordu, src.IdTransakcjiUtworzeniaRekordu, src.AdresOdbiorcy, src.NazwaOdbiorcy, src.KodGrupyZatrudnienia, src.Klasyfikacja, src.Paragraf, src.Czesc, src.IdProgramu, src.KodProjektu, src.Dzial, src.Rozdzial, src.Dzialanie, src.Wymiar, src.KontoKsiegowe, src.IdUzytkownikaOstatnModyfikujacego, src.DataGodzOstatnModyfikacji, src.IdTransakcjiModyfikacji, src.NazwaProgramu, src.PrzyczynyDecyzjiUmorzenia, src.Uwagi, src.PowodUmorzenia)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DefinicjaEtapowZatwierdzen' BEGIN
MERGE INTO zef2.DefinicjaEtapowZatwierdzen AS tgt
USING WA_StageHurtownia.zef2.DefinicjaEtapowZatwierdzen AS src
ON (tgt.WartoscStanu=src.WartoscStanu AND tgt.GrupaZatwierdzen=src.GrupaZatwierdzen AND tgt.Partycja=src.Partycja)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.CzyGotowyDoKsiegowania=src.CzyGotowyDoKsiegowania, tgt.Grupa=src.Grupa, tgt.CzySprawdzArkusz=src.CzySprawdzArkusz, tgt.CzyEdycja=src.CzyEdycja, tgt.CzyZatwierdzenieZaksiegowanie=src.CzyZatwierdzenieZaksiegowanie, tgt.Sekwencja=src.Sekwencja, tgt.AkceptacjaOdKwoty=src.AkceptacjaOdKwoty, tgt.AkceptacjaDoKwoty=src.AkceptacjaDoKwoty, tgt.CzyGotowyDoAkceptacjiCRU=src.CzyGotowyDoAkceptacjiCRU, tgt.CzyKasowanieUmowyCRU=src.CzyKasowanieUmowyCRU, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.CzyWyslanoDoJednostkiNadrzednej=src.CzyWyslanoDoJednostkiNadrzednej, tgt.CzyAktywneAnulowanie=src.CzyAktywneAnulowanie, tgt.CzyPrzekazaneDoNadrzednego=src.CzyPrzekazaneDoNadrzednego, tgt.CzyPrzekazaneDoPodrzednego=src.CzyPrzekazaneDoPodrzednego, tgt.GrupaUprawnionaDoEdytowania=src.GrupaUprawnionaDoEdytowania, tgt.CzyWygenerowaneDoTrezora=src.CzyWygenerowaneDoTrezora, tgt.CzyZerowanieStatusu=src.CzyZerowanieStatusu, tgt.GrupaUprawnionaDoZerowaniaStatusuDok=src.GrupaUprawnionaDoZerowaniaStatusuDok, tgt.GrupaUprawnionaDoCofnieciaStatusuDok=src.GrupaUprawnionaDoCofnieciaStatusuDok, tgt.CzyCofanieDoPoprzStatusu=src.CzyCofanieDoPoprzStatusu, tgt.CzyWylaczenieMozliwosciZmianyStatusu=src.CzyWylaczenieMozliwosciZmianyStatusu, tgt.CzyKomentarzPrzyUstawianiuNaTenStatus=src.CzyKomentarzPrzyUstawianiuNaTenStatus, tgt.CzyKomentarzPrzyCofaniuZTegoStatus=src.CzyKomentarzPrzyCofaniuZTegoStatus, tgt.CzyKomentarzPrzyZerowaniuZTegoStatus=src.CzyKomentarzPrzyZerowaniuZTegoStatus, tgt.CzyPrzekazaneDoDecyzji=src.CzyPrzekazaneDoDecyzji, tgt.CzyPrzekazaneDoDecyzjiNadrzednego=src.CzyPrzekazaneDoDecyzjiNadrzednego, tgt.CzyBladPrzerywaPrzetwarzanie=src.CzyBladPrzerywaPrzetwarzanie, tgt.AutomatycznyStatusNastepny=src.AutomatycznyStatusNastepny, tgt.CzyNiePrzerywacPrzetwarzanieJesliBladPlanu=src.CzyNiePrzerywacPrzetwarzanieJesliBladPlanu, tgt.CzyEdycjaDatyKsiegowania=src.CzyEdycjaDatyKsiegowania, tgt.CzyAutomatycznaAkceptacja=src.CzyAutomatycznaAkceptacja, tgt.CzyCofnieteZJednostkiNadrzednej=src.CzyCofnieteZJednostkiNadrzednej, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzySprawdzacCzyPrzyjete=src.CzySprawdzacCzyPrzyjete, tgt.AutomatycznyStatusPoczatkowy=src.AutomatycznyStatusPoczatkowy, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu, tgt.CzyAnulowanieWniosku=src.CzyAnulowanieWniosku, tgt.CzyEdycjaPolaPrzetarg=src.CzyEdycjaPolaPrzetarg, tgt.CzyJednostkaInicjujaca=src.CzyJednostkaInicjujaca, tgt.CzyJednostkaPotwierdzajaca=src.CzyJednostkaPotwierdzajaca, tgt.WartoscStanuZewnetrzna=src.WartoscStanuZewnetrzna, tgt.CzyAktywnaListaWeryfikacyjna=src.CzyAktywnaListaWeryfikacyjna, tgt.ListaWeryfikacyjnaDefinicjaDlaGrupy=src.ListaWeryfikacyjnaDefinicjaDlaGrupy, tgt.CzyEdycjaZleceniaDoKasy=src.CzyEdycjaZleceniaDoKasy, tgt.CzyPrzyjety=src.CzyPrzyjety
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (WartoscStanu, CzyGotowyDoKsiegowania, Grupa, CzySprawdzArkusz, CzyEdycja, GrupaZatwierdzen, CzyZatwierdzenieZaksiegowanie, Sekwencja, AkceptacjaOdKwoty, AkceptacjaDoKwoty, CzyGotowyDoAkceptacjiCRU, CzyKasowanieUmowyCRU, CzyZatwierdzony, CzyWyslanoDoJednostkiNadrzednej, CzyAktywneAnulowanie, CzyPrzekazaneDoNadrzednego, CzyPrzekazaneDoPodrzednego, GrupaUprawnionaDoEdytowania, CzyWygenerowaneDoTrezora, CzyZerowanieStatusu, GrupaUprawnionaDoZerowaniaStatusuDok, GrupaUprawnionaDoCofnieciaStatusuDok, CzyCofanieDoPoprzStatusu, CzyWylaczenieMozliwosciZmianyStatusu, CzyKomentarzPrzyUstawianiuNaTenStatus, CzyKomentarzPrzyCofaniuZTegoStatus, CzyKomentarzPrzyZerowaniuZTegoStatus, CzyPrzekazaneDoDecyzji, CzyPrzekazaneDoDecyzjiNadrzednego, CzyBladPrzerywaPrzetwarzanie, AutomatycznyStatusNastepny, CzyNiePrzerywacPrzetwarzanieJesliBladPlanu, CzyEdycjaDatyKsiegowania, CzyAutomatycznaAkceptacja, CzyCofnieteZJednostkiNadrzednej, CzyPrzyjete, CzySprawdzacCzyPrzyjete, AutomatycznyStatusPoczatkowy, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, CzyAnulowanieWniosku, CzyEdycjaPolaPrzetarg, CzyJednostkaInicjujaca, CzyJednostkaPotwierdzajaca, WartoscStanuZewnetrzna, CzyAktywnaListaWeryfikacyjna, ListaWeryfikacyjnaDefinicjaDlaGrupy, CzyEdycjaZleceniaDoKasy, CzyPrzyjety)
VALUES (src.WartoscStanu, src.CzyGotowyDoKsiegowania, src.Grupa, src.CzySprawdzArkusz, src.CzyEdycja, src.GrupaZatwierdzen, src.CzyZatwierdzenieZaksiegowanie, src.Sekwencja, src.AkceptacjaOdKwoty, src.AkceptacjaDoKwoty, src.CzyGotowyDoAkceptacjiCRU, src.CzyKasowanieUmowyCRU, src.CzyZatwierdzony, src.CzyWyslanoDoJednostkiNadrzednej, src.CzyAktywneAnulowanie, src.CzyPrzekazaneDoNadrzednego, src.CzyPrzekazaneDoPodrzednego, src.GrupaUprawnionaDoEdytowania, src.CzyWygenerowaneDoTrezora, src.CzyZerowanieStatusu, src.GrupaUprawnionaDoZerowaniaStatusuDok, src.GrupaUprawnionaDoCofnieciaStatusuDok, src.CzyCofanieDoPoprzStatusu, src.CzyWylaczenieMozliwosciZmianyStatusu, src.CzyKomentarzPrzyUstawianiuNaTenStatus, src.CzyKomentarzPrzyCofaniuZTegoStatus, src.CzyKomentarzPrzyZerowaniuZTegoStatus, src.CzyPrzekazaneDoDecyzji, src.CzyPrzekazaneDoDecyzjiNadrzednego, src.CzyBladPrzerywaPrzetwarzanie, src.AutomatycznyStatusNastepny, src.CzyNiePrzerywacPrzetwarzanieJesliBladPlanu, src.CzyEdycjaDatyKsiegowania, src.CzyAutomatycznaAkceptacja, src.CzyCofnieteZJednostkiNadrzednej, src.CzyPrzyjete, src.CzySprawdzacCzyPrzyjete, src.AutomatycznyStatusPoczatkowy, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.CzyAnulowanieWniosku, src.CzyEdycjaPolaPrzetarg, src.CzyJednostkaInicjujaca, src.CzyJednostkaPotwierdzajaca, src.WartoscStanuZewnetrzna, src.CzyAktywnaListaWeryfikacyjna, src.ListaWeryfikacyjnaDefinicjaDlaGrupy, src.CzyEdycjaZleceniaDoKasy, src.CzyPrzyjety)
;SET @Merged = 1;
 END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DefinicjaGrupZatwierdzen' BEGIN
MERGE INTO zef2.DefinicjaGrupZatwierdzen AS tgt
USING WA_StageHurtownia.zef2.DefinicjaGrupZatwierdzen AS src
ON (tgt.GrupaZatwierdzen=src.GrupaZatwierdzen AND tgt.Partycja=src.Partycja)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Nazwa=src.Nazwa, tgt.StatusPoczatkowy=src.StatusPoczatkowy, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Nazwa, GrupaZatwierdzen, StatusPoczatkowy, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu)
VALUES (src.Nazwa, src.GrupaZatwierdzen, src.StatusPoczatkowy, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DefinicjaPolaSprawozdania' BEGIN
MERGE INTO zef2.DefinicjaPolaSprawozdania AS tgt
USING WA_StageHurtownia.zef2.DefinicjaPolaSprawozdania AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.EtykietaPola=src.EtykietaPola, tgt.CzyDoEdycji=src.CzyDoEdycji, tgt.IndeksPola=src.IndeksPola, tgt.Sekwencja=src.Sekwencja, tgt.CzyPlanFinansowy=src.CzyPlanFinansowy, tgt.CzyWykonanie=src.CzyWykonanie, tgt.CzyWyliczeniowe=src.CzyWyliczeniowe, tgt.TagXML=src.TagXML, tgt.PoleSumowane=src.PoleSumowane, tgt.KodWiersza=src.KodWiersza, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzenia=src.DataGodzUtworzenia, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.TagMRDOS=src.TagMRDOS, tgt.Zaokraglenie=src.Zaokraglenie, tgt.CzyWykluczZTrezora=src.CzyWykluczZTrezora
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (EtykietaPola, CzyDoEdycji, IndeksPola, Sekwencja, CzyPlanFinansowy, CzyWykonanie, CzyWyliczeniowe, TagXML, PoleSumowane, KodWiersza, IdentyfikatorSprawozdania, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzenia, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, TagMRDOS, Zaokraglenie, CzyWykluczZTrezora)
VALUES (src.EtykietaPola, src.CzyDoEdycji, src.IndeksPola, src.Sekwencja, src.CzyPlanFinansowy, src.CzyWykonanie, src.CzyWyliczeniowe, src.TagXML, src.PoleSumowane, src.KodWiersza, src.IdentyfikatorSprawozdania, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzenia, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.TagMRDOS, src.Zaokraglenie, src.CzyWykluczZTrezora)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DefinicjaSprawozdania' BEGIN
MERGE INTO zef2.DefinicjaSprawozdania AS tgt
USING WA_StageHurtownia.zef2.DefinicjaSprawozdania AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.CzyGenerowaneAutomatyczne=src.CzyGenerowaneAutomatyczne, tgt.CzyZablokowane=src.CzyZablokowane, tgt.PlanTylkoDlaNiezerowych=src.PlanTylkoDlaNiezerowych, tgt.Klasa=src.Klasa, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.NazwaKlasy=src.NazwaKlasy, tgt.ObowiazujeOd=src.ObowiazujeOd, tgt.DomyslnyTypSprawozdZbiorczego=src.DomyslnyTypSprawozdZbiorczego, tgt.DomyslnyTypSprawozdSkonsolidowanego=src.DomyslnyTypSprawozdSkonsolidowanego, tgt.DomyslnyTypSprawozd=src.DomyslnyTypSprawozd, tgt.Opis=src.Opis, tgt.TypDokumentu=src.TypDokumentu, tgt.CzyDynamiczneWiersze=src.CzyDynamiczneWiersze, tgt.GrupyZatrudnienia=src.GrupyZatrudnienia, tgt.IndeksPola=src.IndeksPola, tgt.JednostkaNadrzedna=src.JednostkaNadrzedna, tgt.SeriaSprawozdZbiorczych=src.SeriaSprawozdZbiorczych, tgt.IdentyfikatorWersjiSprawozdania=src.IdentyfikatorWersjiSprawozdania, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji, tgt.TypSprawozdania=src.TypSprawozdania, tgt.WymaganaKlasyfikacja=src.WymaganaKlasyfikacja, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.CzyImportMRDOS=src.CzyImportMRDOS, tgt.CzyParagraf=src.CzyParagraf, tgt.Partycja=src.Partycja, tgt.CzyCzesc=src.CzyCzesc, tgt.Czesc=src.Czesc, tgt.PoziomKsiegowania=src.PoziomKsiegowania, tgt.CzyKsiegowaneNaKonta=src.CzyKsiegowaneNaKonta, tgt.CzyKsiegowanieDoTransakcjiFinansowych=src.CzyKsiegowanieDoTransakcjiFinansowych, tgt.CzyKodProgramu=src.CzyKodProgramu, tgt.CzyDostepnyKodProjektu=src.CzyDostepnyKodProjektu, tgt.TypDokumentuChronionego=src.TypDokumentuChronionego, tgt.Adresat=src.Adresat, tgt.WersjaRekordu=src.WersjaRekordu, tgt.CzyKolumnaUwagi=src.CzyKolumnaUwagi, tgt.NazwaElementuMenu=src.NazwaElementuMenu, tgt.CzyKodWiersza=src.CzyKodWiersza, tgt.CzyDzial=src.CzyDzial, tgt.CzyRozdzial=src.CzyRozdzial, tgt.NazwaKlasyImportuTrezor=src.NazwaKlasyImportuTrezor, tgt.SeriaZalacznikow=src.SeriaZalacznikow, tgt.CzyDzialanie=src.CzyDzialanie, tgt.DokumentXML=src.DokumentXML, tgt.PrzedzialXML=src.PrzedzialXML, tgt.DokumentPodrzednyXML=src.DokumentPodrzednyXML, tgt.TAGXML=src.TAGXML
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (CzyGenerowaneAutomatyczne, CzyZablokowane, PlanTylkoDlaNiezerowych, Klasa, IdUzytkownikaTworzacego, DataGodzUtworzeniaRekordu, IdTransakcjiUtworzeniaRekordu, NazwaKlasy, ObowiazujeOd, DomyslnyTypSprawozdZbiorczego, DomyslnyTypSprawozdSkonsolidowanego, DomyslnyTypSprawozd, Opis, TypDokumentu, CzyDynamiczneWiersze, GrupyZatrudnienia, IndeksPola, JednostkaNadrzedna, SeriaSprawozdZbiorczych, IdentyfikatorWersjiSprawozdania, KodGrupyDefinicji, TypSprawozdania, WymaganaKlasyfikacja, IdUzytkownikaOstatnModyfikujacego, DataGodzOstatnModyfikacji, IdTransakcjiModyfikacji, CzyImportMRDOS, CzyParagraf, Partycja, CzyCzesc, Czesc, PoziomKsiegowania, CzyKsiegowaneNaKonta, CzyKsiegowanieDoTransakcjiFinansowych, CzyKodProgramu, CzyDostepnyKodProjektu, TypDokumentuChronionego, IdentyfikatorRekordu, Adresat, WersjaRekordu, CzyKolumnaUwagi, NazwaElementuMenu, CzyKodWiersza, CzyDzial, CzyRozdzial, NazwaKlasyImportuTrezor, SeriaZalacznikow, CzyDzialanie, DokumentXML, PrzedzialXML, DokumentPodrzednyXML, TAGXML)
VALUES (src.CzyGenerowaneAutomatyczne, src.CzyZablokowane, src.PlanTylkoDlaNiezerowych, src.Klasa, src.IdUzytkownikaTworzacego, src.DataGodzUtworzeniaRekordu, src.IdTransakcjiUtworzeniaRekordu, src.NazwaKlasy, src.ObowiazujeOd, src.DomyslnyTypSprawozdZbiorczego, src.DomyslnyTypSprawozdSkonsolidowanego, src.DomyslnyTypSprawozd, src.Opis, src.TypDokumentu, src.CzyDynamiczneWiersze, src.GrupyZatrudnienia, src.IndeksPola, src.JednostkaNadrzedna, src.SeriaSprawozdZbiorczych, src.IdentyfikatorWersjiSprawozdania, src.KodGrupyDefinicji, src.TypSprawozdania, src.WymaganaKlasyfikacja, src.IdUzytkownikaOstatnModyfikujacego, src.DataGodzOstatnModyfikacji, src.IdTransakcjiModyfikacji, src.CzyImportMRDOS, src.CzyParagraf, src.Partycja, src.CzyCzesc, src.Czesc, src.PoziomKsiegowania, src.CzyKsiegowaneNaKonta, src.CzyKsiegowanieDoTransakcjiFinansowych, src.CzyKodProgramu, src.CzyDostepnyKodProjektu, src.TypDokumentuChronionego, src.IdentyfikatorRekordu, src.Adresat, src.WersjaRekordu, src.CzyKolumnaUwagi, src.NazwaElementuMenu, src.CzyKodWiersza, src.CzyDzial, src.CzyRozdzial, src.NazwaKlasyImportuTrezor, src.SeriaZalacznikow, src.CzyDzialanie, src.DokumentXML, src.PrzedzialXML, src.DokumentPodrzednyXML, src.TAGXML)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'DefinicjaWierszySprawozdania' BEGIN
MERGE INTO zef2.DefinicjaWierszySprawozdania AS tgt
USING WA_StageHurtownia.zef2.DefinicjaWierszySprawozdania AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.KodWiersza=src.KodWiersza, tgt.Opis=src.Opis, tgt.Kolejnosc=src.Kolejnosc, tgt.TagXML=src.TagXML, tgt.WierszSumowany=src.WierszSumowany, tgt.WierszDynamiczny=src.WierszDynamiczny, tgt.NaDzien=src.NaDzien, tgt.KodWierszaSprawozdSkonsolidowanego=src.KodWierszaSprawozdSkonsolidowanego, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.WierszNaglowkowy=src.WierszNaglowkowy, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.TypWierszaKonsolidacja=src.TypWierszaKonsolidacja, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (KodWiersza, Opis, Kolejnosc, TagXML, WierszSumowany, WierszDynamiczny, NaDzien, KodWierszaSprawozdSkonsolidowanego, IdentyfikatorSprawozdania, WierszNaglowkowy, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, TypWierszaKonsolidacja, KodSekcjiTrezor, KodPozycjiTrezor)
VALUES (src.KodWiersza, src.Opis, src.Kolejnosc, src.TagXML, src.WierszSumowany, src.WierszDynamiczny, src.NaDzien, src.KodWierszaSprawozdSkonsolidowanego, src.IdentyfikatorSprawozdania, src.WierszNaglowkowy, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.TypWierszaKonsolidacja, src.KodSekcjiTrezor, src.KodPozycjiTrezor)
;SET @Merged = 1; 

END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'GrupaDefinicjiSprawozdan' BEGIN
MERGE INTO zef2.GrupaDefinicjiSprawozdan AS tgt
USING WA_StageHurtownia.zef2.GrupaDefinicjiSprawozdan AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.TypDefSprawozdania=src.TypDefSprawozdania, tgt.Opis=src.Opis, tgt.TypSprawozdania=src.TypSprawozdania, tgt.RodzajSprawozdania=src.RodzajSprawozdania, tgt.TypJednostkiSprawozdania=src.TypJednostkiSprawozdania, tgt.RodzajOkresu=src.RodzajOkresu, tgt.RodzajDokMRDOS=src.RodzajDokMRDOS, tgt.CzyImportMRDOS=src.CzyImportMRDOS, tgt.CzySprawozdKonsolidacyjne=src.CzySprawozdKonsolidacyjne, tgt.Modul=src.Modul, tgt.CzyNaWszystkieIzby=src.CzyNaWszystkieIzby, tgt.KodDokumentu=src.KodDokumentu, tgt.CzyWysylkaDoTrezora=src.CzyWysylkaDoTrezora, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.GrupaUzytkowWidocznosciSprawozd=src.GrupaUzytkowWidocznosciSprawozd, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatorRekordu, TypDefSprawozdania, Opis, TypSprawozdania, RodzajSprawozdania, TypJednostkiSprawozdania, RodzajOkresu, RodzajDokMRDOS, CzyImportMRDOS, CzySprawozdKonsolidacyjne, Modul, CzyNaWszystkieIzby, KodDokumentu, CzyWysylkaDoTrezora, KodProcesuTrezor, IdUzytkownikaTworzacego, DataGodzUtworzeniaRekordu, IdTransakcjiUtworzeniaRekordu, IdUzytkownikaOstatnModyfikujacego, DataGodzOstatnModyfikacji, IdTransakcjiModyfikacji, GrupaUzytkowWidocznosciSprawozd, WersjaRekordu, Partycja)
VALUES (src.IdentyfikatorRekordu, src.TypDefSprawozdania, src.Opis, src.TypSprawozdania, src.RodzajSprawozdania, src.TypJednostkiSprawozdania, src.RodzajOkresu, src.RodzajDokMRDOS, src.CzyImportMRDOS, src.CzySprawozdKonsolidacyjne, src.Modul, src.CzyNaWszystkieIzby, src.KodDokumentu, src.CzyWysylkaDoTrezora, src.KodProcesuTrezor, src.IdUzytkownikaTworzacego, src.DataGodzUtworzeniaRekordu, src.IdTransakcjiUtworzeniaRekordu, src.IdUzytkownikaOstatnModyfikujacego, src.DataGodzOstatnModyfikacji, src.IdTransakcjiModyfikacji, src.GrupaUzytkowWidocznosciSprawozd, src.WersjaRekordu, src.Partycja)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'GrupyZatrudnienia' BEGIN
MERGE INTO zef2.GrupyZatrudnienia AS tgt
USING WA_StageHurtownia.zef2.GrupyZatrudnienia AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.NazwaGrupyZatrudnienia=src.NazwaGrupyZatrudnienia, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.KodGrupyDlaSprawozdan=src.KodGrupyDlaSprawozdan, tgt.CzyZablokowane=src.CzyZablokowane
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (KodGrupyZatrudnienia, NazwaGrupyZatrudnienia, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, KodGrupyDlaSprawozdan, CzyZablokowane)
VALUES (src.KodGrupyZatrudnienia, src.NazwaGrupyZatrudnienia, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.KodGrupyDlaSprawozdan, src.CzyZablokowane)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'JednostkiOrganizacyjne' BEGIN
MERGE INTO zef2.JednostkiOrganizacyjne AS tgt
USING WA_StageHurtownia.zef2.JednostkiOrganizacyjne AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.KodJednostki=src.KodJednostki, tgt.Nazwa=src.Nazwa, tgt.CzyZablokowane=src.CzyZablokowane, tgt.CzyDysponentIstopnia=src.CzyDysponentIstopnia, tgt.CzyDysponentIIstopnia=src.CzyDysponentIIstopnia, tgt.CzyDysponentIIIstopnia=src.CzyDysponentIIIstopnia, tgt.CzyDysponentIVstopnia=src.CzyDysponentIVstopnia, tgt.CzyDysponentVstopnia=src.CzyDysponentVstopnia, tgt.JednostkaNadrzedna=src.JednostkaNadrzedna, tgt.Firma=src.Firma, tgt.PionMF=src.PionMF, tgt.CzyOrganEgzekucyjny=src.CzyOrganEgzekucyjny, tgt.KodDysponenta=src.KodDysponenta, tgt.Czesc=src.Czesc, tgt.CzyOrganPodatkowy=src.CzyOrganPodatkowy, tgt.KodDysponentaOrganPodatkowy=src.KodDysponentaOrganPodatkowy, tgt.IdentyfikatorDanychAdresowych=src.IdentyfikatorDanychAdresowych, tgt.AdresDecyzjiNaOdsetki=src.AdresDecyzjiNaOdsetki, tgt.SzablonEmailZadaniaZaplaty=src.SzablonEmailZadaniaZaplaty, tgt.AdresEgzekucji=src.AdresEgzekucji, tgt.UzytkownicyEgzekucji=src.UzytkownicyEgzekucji, tgt.NazwaSprawozdania=src.NazwaSprawozdania, tgt.REGON=src.REGON, tgt.CzyWidocznyWwymiarze=src.CzyWidocznyWwymiarze, tgt.NazwaNaWydrukuTytulu=src.NazwaNaWydrukuTytulu, tgt.SzablonEmailWniosekOzarachowanie=src.SzablonEmailWniosekOzarachowanie, tgt.AdresWnioskuOzarachowanie=src.AdresWnioskuOzarachowanie, tgt.NumeracjaOdbiorcy=src.NumeracjaOdbiorcy, tgt.KontoOdbiorcy=src.KontoOdbiorcy, tgt.CzyWidocznyNaZarzadzZab=src.CzyWidocznyNaZarzadzZab, tgt.SkrotDysponentaMF=src.SkrotDysponentaMF, tgt.CzyJestAdresatem=src.CzyJestAdresatem, tgt.NazwaLimity=src.NazwaLimity, tgt.IdentyfikatorDanychKontaktowych=src.IdentyfikatorDanychKontaktowych, tgt.KodJednBudzetTrezor=src.KodJednBudzetTrezor, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatorRekordu, KodJednostki, Nazwa, CzyZablokowane, CzyDysponentIstopnia, CzyDysponentIIstopnia, CzyDysponentIIIstopnia, CzyDysponentIVstopnia, CzyDysponentVstopnia, JednostkaNadrzedna, Firma, PionMF, CzyOrganEgzekucyjny, KodDysponenta, Czesc, CzyOrganPodatkowy, KodDysponentaOrganPodatkowy, IdentyfikatorDanychAdresowych, AdresDecyzjiNaOdsetki, SzablonEmailZadaniaZaplaty, AdresEgzekucji, UzytkownicyEgzekucji, NazwaSprawozdania, REGON, CzyWidocznyWwymiarze, NazwaNaWydrukuTytulu, SzablonEmailWniosekOzarachowanie, AdresWnioskuOzarachowanie, NumeracjaOdbiorcy, KontoOdbiorcy, CzyWidocznyNaZarzadzZab, SkrotDysponentaMF, CzyJestAdresatem, NazwaLimity, IdentyfikatorDanychKontaktowych, KodJednBudzetTrezor, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja)
VALUES (src.IdentyfikatorRekordu, src.KodJednostki, src.Nazwa, src.CzyZablokowane, src.CzyDysponentIstopnia, src.CzyDysponentIIstopnia, src.CzyDysponentIIIstopnia, src.CzyDysponentIVstopnia, src.CzyDysponentVstopnia, src.JednostkaNadrzedna, src.Firma, src.PionMF, src.CzyOrganEgzekucyjny, src.KodDysponenta, src.Czesc, src.CzyOrganPodatkowy, src.KodDysponentaOrganPodatkowy, src.IdentyfikatorDanychAdresowych, src.AdresDecyzjiNaOdsetki, src.SzablonEmailZadaniaZaplaty, src.AdresEgzekucji, src.UzytkownicyEgzekucji, src.NazwaSprawozdania, src.REGON, src.CzyWidocznyWwymiarze, src.NazwaNaWydrukuTytulu, src.SzablonEmailWniosekOzarachowanie, src.AdresWnioskuOzarachowanie, src.NumeracjaOdbiorcy, src.KontoOdbiorcy, src.CzyWidocznyNaZarzadzZab, src.SkrotDysponentaMF, src.CzyJestAdresatem, src.NazwaLimity, src.IdentyfikatorDanychKontaktowych, src.KodJednBudzetTrezor, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'Meldunek_Dokument' BEGIN
MERGE INTO zef2.Meldunek_Dokument AS tgt
USING WA_StageHurtownia.zef2.Meldunek_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, IdentyfikatorSprawozdania, KodJednostki, Status, GrupaZatwierdzen, IdentyfikatorSprawozdaniaLacznego, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, KodGrupyDefinicji, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, IdentyfikatorOdrzuconegoSprawozdania, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.IdentyfikatorSprawozdania, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.IdentyfikatorSprawozdaniaLacznego, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.KodGrupyDefinicji, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.IdentyfikatorOdrzuconegoSprawozdania, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor)
;SET @Merged = 1;
 END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'Meldunek_Pozycje' BEGIN
MERGE INTO zef2.Meldunek_Pozycje AS tgt
USING WA_StageHurtownia.zef2.Meldunek_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.StanNaTenMiesiac=src.StanNaTenMiesiac, tgt.StanNarastajaco=src.StanNarastajaco, tgt.KodWiersza=src.KodWiersza, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, StanNaTenMiesiac, StanNarastajaco, KodWiersza, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.StanNaTenMiesiac, src.StanNarastajaco, src.KodWiersza, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'Programy' BEGIN
MERGE INTO zef2.Programy AS tgt
USING WA_StageHurtownia.zef2.Programy AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NazwaProgramu=src.NazwaProgramu, tgt.KodProgramu=src.KodProgramu, tgt.CzyZablokowane=src.CzyZablokowane, tgt.WaznyOdDnia=src.WaznyOdDnia, tgt.CzyWidocznyWWymiarze=src.CzyWidocznyWWymiarze, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.GrupaProgramow=src.GrupaProgramow, tgt.NazwaProgramuDlaSprawozdan=src.NazwaProgramuDlaSprawozdan
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NazwaProgramu, KodProgramu, CzyZablokowane, WaznyOdDnia, CzyWidocznyWWymiarze, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, GrupaProgramow, NazwaProgramuDlaSprawozdan)
VALUES (src.Opis, src.NazwaProgramu, src.KodProgramu, src.CzyZablokowane, src.WaznyOdDnia, src.CzyWidocznyWWymiarze, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.GrupaProgramow, src.NazwaProgramuDlaSprawozdan)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB23_Dokument' BEGIN
MERGE INTO zef2.RB23_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB23_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.TypSprawozdania=src.TypSprawozdania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatorRekordu, NumerSprawozdania, OkresSprawozdawczy, Opis, Zalacznik, ZalacznikStornowania, CzyZaksiegowane, PrzetwarzanyProfilKsiegowania, TypSprawozdania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, OpisWyjasnienie, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, KodGrupyDefinicji)
VALUES (src.IdentyfikatorRekordu, src.NumerSprawozdania, src.OkresSprawozdawczy, src.Opis, src.Zalacznik, src.ZalacznikStornowania, src.CzyZaksiegowane, src.PrzetwarzanyProfilKsiegowania, src.TypSprawozdania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.OpisWyjasnienie, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB23_Pozycje' BEGIN
MERGE INTO zef2.RB23_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB23_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.IdSprawozdania=src.IdSprawozdania, tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.Kwota=src.Kwota, tgt.KodWiersza=src.KodWiersza, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Paragraf=src.Paragraf, tgt.Czesc=src.Czesc, tgt.IdProgramu=src.IdProgramu, tgt.KodProjektu=src.KodProjektu, tgt.Dzial=src.Dzial, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.UtworzonePrzez=src.UtworzonePrzez, tgt.Rozdzial=src.Rozdzial, tgt.Dzialanie=src.Dzialanie, tgt.Wymiar=src.Wymiar, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.NazwaProgramu=src.NazwaProgramu, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.Uwagi=src.Uwagi, tgt.PowodUmorzenia=src.PowodUmorzenia
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatoRekordu, IdSprawozdania, Opis, NumerWiersza, Kwota, KodWiersza, KodPozycjiTrezor, KodSekcjiTrezor, WersjaRekordu, Partycja, IdTransakcjiUtworzeniaRekordu, AdresOdbiorcy, NazwaOdbiorcy, KodGrupyZatrudnienia, Klasyfikacja, Paragraf, Czesc, IdProgramu, KodProjektu, Dzial, DataGodzUtworzeniaRekordu, UtworzonePrzez, Rozdzial, Dzialanie, Wymiar, KontoKsiegowe, IdUzytkownikaOstatnModyfikujacego, DataGodzOstatnModyfikacji, IdTransakcjiModyfikacji, NazwaProgramu, PrzyczynyDecyzjiUmorzenia, Uwagi, PowodUmorzenia)
VALUES (src.IdentyfikatoRekordu, src.IdSprawozdania, src.Opis, src.NumerWiersza, src.Kwota, src.KodWiersza, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.WersjaRekordu, src.Partycja, src.IdTransakcjiUtworzeniaRekordu, src.AdresOdbiorcy, src.NazwaOdbiorcy, src.KodGrupyZatrudnienia, src.Klasyfikacja, src.Paragraf, src.Czesc, src.IdProgramu, src.KodProjektu, src.Dzial, src.DataGodzUtworzeniaRekordu, src.UtworzonePrzez, src.Rozdzial, src.Dzialanie, src.Wymiar, src.KontoKsiegowe, src.IdUzytkownikaOstatnModyfikujacego, src.DataGodzOstatnModyfikacji, src.IdTransakcjiModyfikacji, src.NazwaProgramu, src.PrzyczynyDecyzjiUmorzenia, src.Uwagi, src.PowodUmorzenia)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB23A_Dokument' BEGIN
MERGE INTO zef2.RB23A_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB23A_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.TypSprawozdania=src.TypSprawozdania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatorRekordu, NumerSprawozdania, OkresSprawozdawczy, Opis, Zalacznik, ZalacznikStornowania, CzyZaksiegowane, PrzetwarzanyProfilKsiegowania, TypSprawozdania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, OpisWyjasnienie, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, KodGrupyDefinicji)
VALUES (src.IdentyfikatorRekordu, src.NumerSprawozdania, src.OkresSprawozdawczy, src.Opis, src.Zalacznik, src.ZalacznikStornowania, src.CzyZaksiegowane, src.PrzetwarzanyProfilKsiegowania, src.TypSprawozdania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.OpisWyjasnienie, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB23A_Pozycje' BEGIN
MERGE INTO zef2.RB23A_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB23A_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.IdSprawozdania=src.IdSprawozdania, tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.Kwota=src.Kwota, tgt.KodWiersza=src.KodWiersza, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Paragraf=src.Paragraf, tgt.Czesc=src.Czesc, tgt.IdProgramu=src.IdProgramu, tgt.KodProjektu=src.KodProjektu, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Dzialanie=src.Dzialanie, tgt.Wymiar=src.Wymiar, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.NazwaProgramu=src.NazwaProgramu, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.Uwagi=src.Uwagi, tgt.PowodUmorzenia=src.PowodUmorzenia
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatoRekordu, IdSprawozdania, Opis, NumerWiersza, Kwota, KodWiersza, KodPozycjiTrezor, KodSekcjiTrezor, WersjaRekordu, Partycja, IdUzytkownikaTworzacego, DataGodzUtworzeniaRekordu, IdTransakcjiUtworzeniaRekordu, AdresOdbiorcy, NazwaOdbiorcy, KodGrupyZatrudnienia, Klasyfikacja, Paragraf, Czesc, IdProgramu, KodProjektu, Dzial, Rozdzial, Dzialanie, Wymiar, KontoKsiegowe, IdUzytkownikaOstatnModyfikujacego, DataGodzOstatnModyfikacji, IdTransakcjiModyfikacji, NazwaProgramu, PrzyczynyDecyzjiUmorzenia, Uwagi, PowodUmorzenia)
VALUES (src.IdentyfikatoRekordu, src.IdSprawozdania, src.Opis, src.NumerWiersza, src.Kwota, src.KodWiersza, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.WersjaRekordu, src.Partycja, src.IdUzytkownikaTworzacego, src.DataGodzUtworzeniaRekordu, src.IdTransakcjiUtworzeniaRekordu, src.AdresOdbiorcy, src.NazwaOdbiorcy, src.KodGrupyZatrudnienia, src.Klasyfikacja, src.Paragraf, src.Czesc, src.IdProgramu, src.KodProjektu, src.Dzial, src.Rozdzial, src.Dzialanie, src.Wymiar, src.KontoKsiegowe, src.IdUzytkownikaOstatnModyfikujacego, src.DataGodzOstatnModyfikacji, src.IdTransakcjiModyfikacji, src.NazwaProgramu, src.PrzyczynyDecyzjiUmorzenia, src.Uwagi, src.PowodUmorzenia)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB23B_Dokument' BEGIN
MERGE INTO zef2.RB23B_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB23B_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.TypSprawozdania=src.TypSprawozdania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatorRekordu, NumerSprawozdania, OkresSprawozdawczy, Opis, Zalacznik, ZalacznikStornowania, CzyZaksiegowane, PrzetwarzanyProfilKsiegowania, TypSprawozdania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorSprawozdaniaLacznego, IdentyfikatorOdrzuconegoSprawozdania, OpisWyjasnienie, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, KodGrupyDefinicji)
VALUES (src.IdentyfikatorRekordu, src.NumerSprawozdania, src.OkresSprawozdawczy, src.Opis, src.Zalacznik, src.ZalacznikStornowania, src.CzyZaksiegowane, src.PrzetwarzanyProfilKsiegowania, src.TypSprawozdania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.IdentyfikatorOdrzuconegoSprawozdania, src.OpisWyjasnienie, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB23B_Pozycje' BEGIN
MERGE INTO zef2.RB23B_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB23B_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.IdSprawozdania=src.IdSprawozdania, tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.Kwota=src.Kwota, tgt.KodWiersza=src.KodWiersza, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.UtworzonePrzez=src.UtworzonePrzez, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Paragraf=src.Paragraf, tgt.Czesc=src.Czesc, tgt.IdProgramu=src.IdProgramu, tgt.KodProjektu=src.KodProjektu, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Dzialanie=src.Dzialanie, tgt.Wymiar=src.Wymiar, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.NazwaProgramu=src.NazwaProgramu, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatoRekordu, IdSprawozdania, Opis, NumerWiersza, Kwota, KodWiersza, KodPozycjiTrezor, KodSekcjiTrezor, WersjaRekordu, Partycja, UtworzonePrzez, DataGodzUtworzeniaRekordu, IdTransakcjiUtworzeniaRekordu, AdresOdbiorcy, NazwaOdbiorcy, KodGrupyZatrudnienia, Klasyfikacja, Paragraf, Czesc, IdProgramu, KodProjektu, Dzial, Rozdzial, Dzialanie, Wymiar, KontoKsiegowe, IdUzytkownikaOstatnModyfikujacego, DataGodzOstatnModyfikacji, IdTransakcjiModyfikacji, NazwaProgramu, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia)
VALUES (src.IdentyfikatoRekordu, src.IdSprawozdania, src.Opis, src.NumerWiersza, src.Kwota, src.KodWiersza, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.WersjaRekordu, src.Partycja, src.UtworzonePrzez, src.DataGodzUtworzeniaRekordu, src.IdTransakcjiUtworzeniaRekordu, src.AdresOdbiorcy, src.NazwaOdbiorcy, src.KodGrupyZatrudnienia, src.Klasyfikacja, src.Paragraf, src.Czesc, src.IdProgramu, src.KodProjektu, src.Dzial, src.Rozdzial, src.Dzialanie, src.Wymiar, src.KontoKsiegowe, src.IdUzytkownikaOstatnModyfikujacego, src.DataGodzOstatnModyfikacji, src.IdTransakcjiModyfikacji, src.NazwaProgramu, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB27_Dokument' BEGIN
MERGE INTO zef2.RB27_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB27_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.TypSprawozdania=src.TypSprawozdania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatorRekordu, NumerSprawozdania, OkresSprawozdawczy, Opis, Zalacznik, ZalacznikStornowania, CzyZaksiegowane, PrzetwarzanyProfilKsiegowania, TypSprawozdania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, OpisWyjasnienie, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, KodGrupyDefinicji)
VALUES (src.IdentyfikatorRekordu, src.NumerSprawozdania, src.OkresSprawozdawczy, src.Opis, src.Zalacznik, src.ZalacznikStornowania, src.CzyZaksiegowane, src.PrzetwarzanyProfilKsiegowania, src.TypSprawozdania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.OpisWyjasnienie, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB27_Pozycje' BEGIN
MERGE INTO zef2.RB27_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB27_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.IdSprawozdania=src.IdSprawozdania, tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.[Plan]=src.[Plan], tgt.Naleznosci=src.Naleznosci, tgt.Potracenia=src.Potracenia, tgt.DochodyWykonane=src.DochodyWykonane, tgt.DochodyPrzekazane=src.DochodyPrzekazane, tgt.NaleznosciDoZaplatyOgolem=src.NaleznosciDoZaplatyOgolem, tgt.NaleznosciDoZaplatyWTymNetto=src.NaleznosciDoZaplatyWTymNetto, tgt.Nadplaty=src.Nadplaty, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Czesc=src.Czesc, tgt.Dzialanie=src.Dzialanie, tgt.Wymiar=src.Wymiar, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.KodWiersza=src.KodWiersza, tgt.NazwaProgramu=src.NazwaProgramu, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.Uwagi=src.Uwagi, tgt.PowodUmorzenia=src.PowodUmorzenia
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatoRekordu, IdSprawozdania, Opis, NumerWiersza, [Plan], Naleznosci, Potracenia, DochodyWykonane, DochodyPrzekazane, NaleznosciDoZaplatyOgolem, NaleznosciDoZaplatyWTymNetto, Nadplaty, KodPozycjiTrezor, KodSekcjiTrezor, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, WersjaRekordu, Partycja, IdUzytkownikaTworzacego, DataGodzUtworzeniaRekordu, IdTransakcjiUtworzeniaRekordu, AdresOdbiorcy, NazwaOdbiorcy, Klasyfikacja, Czesc, Dzialanie, Wymiar, IdUzytkownikaOstatnModyfikujacego, DataGodzOstatnModyfikacji, IdTransakcjiModyfikacji, KodWiersza, NazwaProgramu, PrzyczynyDecyzjiUmorzenia, Uwagi, PowodUmorzenia)
VALUES (src.IdentyfikatoRekordu, src.IdSprawozdania, src.Opis, src.NumerWiersza, src.[Plan], src.Naleznosci, src.Potracenia, src.DochodyWykonane, src.DochodyPrzekazane, src.NaleznosciDoZaplatyOgolem, src.NaleznosciDoZaplatyWTymNetto, src.Nadplaty, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.WersjaRekordu, src.Partycja, src.IdUzytkownikaTworzacego, src.DataGodzUtworzeniaRekordu, src.IdTransakcjiUtworzeniaRekordu, src.AdresOdbiorcy, src.NazwaOdbiorcy, src.Klasyfikacja, src.Czesc, src.Dzialanie, src.Wymiar, src.IdUzytkownikaOstatnModyfikujacego, src.DataGodzOstatnModyfikacji, src.IdTransakcjiModyfikacji, src.KodWiersza, src.NazwaProgramu, src.PrzyczynyDecyzjiUmorzenia, src.Uwagi, src.PowodUmorzenia)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28_Dokument' BEGIN
MERGE INTO zef2.RB28_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB28_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.DataWyslania=src.DataWyslania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, DataWyslania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, DataGodzWygenerowania, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.DataWyslania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.DataGodzWygenerowania, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28_Pozycje' BEGIN
MERGE INTO zef2.RB28_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB28_Pozycje AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.PlanPoZmianach=src.PlanPoZmianach, tgt.Zaangazowanie=src.Zaangazowanie, tgt.WykonanieWydatkow=src.WykonanieWydatkow, tgt.OgolemZobowiazania=src.OgolemZobowiazania, tgt.ZobowLatUbieglych=src.ZobowLatUbieglych, tgt.ZobowBiezacegoRoku=src.ZobowBiezacegoRoku, tgt.WydatkiNiewygasle=src.WydatkiNiewygasle, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.KodWiersza=src.KodWiersza, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, PlanPoZmianach, Zaangazowanie, WykonanieWydatkow, OgolemZobowiazania, ZobowLatUbieglych, ZobowBiezacegoRoku, WydatkiNiewygasle, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, KodWiersza, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.PlanPoZmianach, src.Zaangazowanie, src.WykonanieWydatkow, src.OgolemZobowiazania, src.ZobowLatUbieglych, src.ZobowBiezacegoRoku, src.WydatkiNiewygasle, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.KodWiersza, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28NW_Dokument' BEGIN
MERGE INTO zef2.RB28NW_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB28NW_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28NW_Pozycje' BEGIN
MERGE INTO zef2.RB28NW_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB28NW_Pozycje AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.[Plan]=src.[Plan], tgt.Wykonanie=src.Wykonanie, tgt.KodWiersza=src.KodWiersza, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzenia=src.DataGodzUtworzenia, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, [Plan], Wykonanie, KodWiersza, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzenia, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.[Plan], src.Wykonanie, src.KodWiersza, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzenia, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28Programy_Dokument' BEGIN
MERGE INTO zef2.RB28Programy_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB28Programy_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28Programy_Pozycje' BEGIN
MERGE INTO zef2.RB28Programy_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB28Programy_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.UtworzonePrzez=src.UtworzonePrzez, tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.PlanPoZmianachUE=src.PlanPoZmianachUE, tgt.PlanPoZmianachBP=src.PlanPoZmianachBP, tgt.ZaangazowanieUE=src.ZaangazowanieUE, tgt.ZaangazowanieBP=src.ZaangazowanieBP, tgt.WykonanieWydatkowUE=src.WykonanieWydatkowUE, tgt.WykonanieWydatkowBP=src.WykonanieWydatkowBP, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.KodWiersza=src.KodWiersza, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (UtworzonePrzez, Opis, NumerWiersza, PlanPoZmianachUE, PlanPoZmianachBP, ZaangazowanieUE, ZaangazowanieBP, WykonanieWydatkowUE, WykonanieWydatkowBP, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, KodWiersza, DataGodzUtworzeniaRekordu, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.UtworzonePrzez, src.Opis, src.NumerWiersza, src.PlanPoZmianachUE, src.PlanPoZmianachBP, src.ZaangazowanieUE, src.ZaangazowanieBP, src.WykonanieWydatkowUE, src.WykonanieWydatkowBP, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.KodWiersza, src.DataGodzUtworzeniaRekordu, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28ProgramyWPR_Dokument' BEGIN
MERGE INTO zef2.RB28ProgramyWPR_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB28ProgramyWPR_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28ProgramyWPR_Pozycje' BEGIN
MERGE INTO zef2.RB28ProgramyWPR_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB28ProgramyWPR_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.PlanPoZmianachUE=src.PlanPoZmianachUE, tgt.PlanPoZmianachBP=src.PlanPoZmianachBP, tgt.ZaangazowanieUE=src.ZaangazowanieUE, tgt.ZaangazowanieBP=src.ZaangazowanieBP, tgt.WykonanieWydatkowUE=src.WykonanieWydatkowUE, tgt.WykonanieWydatkowBP=src.WykonanieWydatkowBP, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.KodWiersza=src.KodWiersza, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, PlanPoZmianachUE, PlanPoZmianachBP, ZaangazowanieUE, ZaangazowanieBP, WykonanieWydatkowUE, WykonanieWydatkowBP, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, KodWiersza, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.PlanPoZmianachUE, src.PlanPoZmianachBP, src.ZaangazowanieUE, src.ZaangazowanieBP, src.WykonanieWydatkowUE, src.WykonanieWydatkowBP, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.KodWiersza, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28UE_Dokument' BEGIN
MERGE INTO zef2.RB28UE_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB28UE_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, IdentyfikatorSprawozdania, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.IdentyfikatorSprawozdania, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28UE_Pozycje' BEGIN
MERGE INTO zef2.RB28UE_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB28UE_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.PlanPoZmianach=src.PlanPoZmianach, tgt.Zaangazowanie=src.Zaangazowanie, tgt.PlatnNarastPoczRoku=src.PlatnNarastPoczRoku, tgt.ZwrotyNarastPoczRokuPlatnBiez=src.ZwrotyNarastPoczRokuPlatnBiez, tgt.WykonanieWydatkow=src.WykonanieWydatkow, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.KodWiersza=src.KodWiersza, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, PlanPoZmianach, Zaangazowanie, PlatnNarastPoczRoku, ZwrotyNarastPoczRokuPlatnBiez, WykonanieWydatkow, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, KodWiersza, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.PlanPoZmianach, src.Zaangazowanie, src.PlatnNarastPoczRoku, src.ZwrotyNarastPoczRokuPlatnBiez, src.WykonanieWydatkow, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.KodWiersza, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28UEWPR_Dokument' BEGIN
MERGE INTO zef2.RB28UEWPR_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB28UEWPR_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorSprawozdaniaLacznego, IdentyfikatorOdrzuconegoSprawozdania, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.IdentyfikatorOdrzuconegoSprawozdania, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB28UEWPR_Pozycje' BEGIN
MERGE INTO zef2.RB28UEWPR_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB28UEWPR_Pozycje AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.PlanPoZmianach=src.PlanPoZmianach, tgt.Zaangazowanie=src.Zaangazowanie, tgt.IdSprawozdania=src.IdSprawozdania, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KodWiersza=src.KodWiersza, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.UtworzonePrzez=src.UtworzonePrzez, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi, tgt.Wymiar=src.Wymiar
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, PlanPoZmianach, Zaangazowanie, IdSprawozdania, KontoKsiegowe, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KodWiersza, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, UtworzonePrzez, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi, Wymiar)
VALUES (src.Opis, src.NumerWiersza, src.PlanPoZmianach, src.Zaangazowanie, src.IdSprawozdania, src.KontoKsiegowe, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KodWiersza, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.UtworzonePrzez, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi, src.Wymiar)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB70_Dokument' BEGIN
MERGE INTO zef2.RB70_Dokument AS tgt
USING WA_StageHurtownia.zef2.RB70_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, WersjaRekordu, Partycja, IdentyfikatorRekordu, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RB70_Pozycje' BEGIN
MERGE INTO zef2.RB70_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RB70_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.PlanPoZmianach=src.PlanPoZmianach, tgt.PrzecietneWykonanieWokresieSprawozdaw=src.PrzecietneWykonanieWokresieSprawozdaw, tgt.StanNaKoniecOkresuSprawodaw=src.StanNaKoniecOkresuSprawodaw, tgt.PlanOsoboweUposazenia=src.PlanOsoboweUposazenia, tgt.PlanDodatkoweWynagrodzenieRoczne=src.PlanDodatkoweWynagrodzenieRoczne, tgt.WykonanieOsoboweUposazenia=src.WykonanieOsoboweUposazenia, tgt.DodatkoweWynagrodzenieRoczne=src.DodatkoweWynagrodzenieRoczne, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.KodWiersza=src.KodWiersza, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, PlanPoZmianach, PrzecietneWykonanieWokresieSprawozdaw, StanNaKoniecOkresuSprawodaw, PlanOsoboweUposazenia, PlanDodatkoweWynagrodzenieRoczne, WykonanieOsoboweUposazenia, DodatkoweWynagrodzenieRoczne, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, KodWiersza, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.PlanPoZmianach, src.PrzecietneWykonanieWokresieSprawozdaw, src.StanNaKoniecOkresuSprawodaw, src.PlanOsoboweUposazenia, src.PlanDodatkoweWynagrodzenieRoczne, src.WykonanieOsoboweUposazenia, src.DodatkoweWynagrodzenieRoczne, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.KodWiersza, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RBBZ1_Dokument' BEGIN
MERGE INTO zef2.RBBZ1_Dokument AS tgt
USING WA_StageHurtownia.zef2.RBBZ1_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, IdentyfikatorSprawozdania, KodJednostki, Status, GrupaZatwierdzen, IdentyfikatorSprawozdaniaLacznego, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, KodGrupyDefinicji, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, IdentyfikatorOdrzuconegoSprawozdania, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.IdentyfikatorSprawozdania, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.IdentyfikatorSprawozdaniaLacznego, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.KodGrupyDefinicji, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.IdentyfikatorOdrzuconegoSprawozdania, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RBBZ1_Pozycje' BEGIN
MERGE INTO zef2.RBBZ1_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RBBZ1_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.KwotaPlanuWgUstawyBudzetowej=src.KwotaPlanuWgUstawyBudzetowej, tgt.PlanPoZmianach=src.PlanPoZmianach, tgt.Wykonanie=src.Wykonanie, tgt.Zobowiazania=src.Zobowiazania, tgt.KodWiersza=src.KodWiersza, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, KwotaPlanuWgUstawyBudzetowej, PlanPoZmianach, Wykonanie, Zobowiazania, KodWiersza, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.KwotaPlanuWgUstawyBudzetowej, src.PlanPoZmianach, src.Wykonanie, src.Zobowiazania, src.KodWiersza, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RBN_Dokument' BEGIN
MERGE INTO zef2.RBN_Dokument AS tgt
USING WA_StageHurtownia.zef2.RBN_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, IdentyfikatorSprawozdania, KodJednostki, Status, GrupaZatwierdzen, IdentyfikatorSprawozdaniaLacznego, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, KodGrupyDefinicji, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, IdentyfikatorOdrzuconegoSprawozdania, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.IdentyfikatorSprawozdania, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.IdentyfikatorSprawozdaniaLacznego, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.KodGrupyDefinicji, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.IdentyfikatorOdrzuconegoSprawozdania, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RBN_Pozycje' BEGIN
MERGE INTO zef2.RBN_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RBN_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.KwotaNaleznosciOgolem=src.KwotaNaleznosciOgolem, tgt.OgolemKolumna3=src.OgolemKolumna3, tgt.SektorFinansowPublicznych=src.SektorFinansowPublicznych, tgt.GrupaI=src.GrupaI, tgt.GrupaII=src.GrupaII, tgt.GrupaIII=src.GrupaIII, tgt.GrupaIV=src.GrupaIV, tgt.BankCentralny=src.BankCentralny, tgt.Banki=src.Banki, tgt.PozostaleKrajoweInstytFinans=src.PozostaleKrajoweInstytFinans, tgt.PrzedsiebiorstwaNiefinansowe=src.PrzedsiebiorstwaNiefinansowe, tgt.GospodarstwaDomowe=src.GospodarstwaDomowe, tgt.InstytNiekomercNaRzeczGospodarstwDom=src.InstytNiekomercNaRzeczGospodarstwDom, tgt.OgolemKolumna15=src.OgolemKolumna15, tgt.PodmiotyNalezaceDoStrefyEuro=src.PodmiotyNalezaceDoStrefyEuro, tgt.PozostalePodmiotyZagraniczne=src.PozostalePodmiotyZagraniczne, tgt.KodWiersza=src.KodWiersza, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, KwotaNaleznosciOgolem, OgolemKolumna3, SektorFinansowPublicznych, GrupaI, GrupaII, GrupaIII, GrupaIV, BankCentralny, Banki, PozostaleKrajoweInstytFinans, PrzedsiebiorstwaNiefinansowe, GospodarstwaDomowe, InstytNiekomercNaRzeczGospodarstwDom, OgolemKolumna15, PodmiotyNalezaceDoStrefyEuro, PozostalePodmiotyZagraniczne, KodWiersza, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.KwotaNaleznosciOgolem, src.OgolemKolumna3, src.SektorFinansowPublicznych, src.GrupaI, src.GrupaII, src.GrupaIII, src.GrupaIV, src.BankCentralny, src.Banki, src.PozostaleKrajoweInstytFinans, src.PrzedsiebiorstwaNiefinansowe, src.GospodarstwaDomowe, src.InstytNiekomercNaRzeczGospodarstwDom, src.OgolemKolumna15, src.PodmiotyNalezaceDoStrefyEuro, src.PozostalePodmiotyZagraniczne, src.KodWiersza, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RBWSB_Dokument' BEGIN
MERGE INTO zef2.RBWSB_Dokument AS tgt
USING WA_StageHurtownia.zef2.RBWSB_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, IdentyfikatorSprawozdaniaLacznego, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, IdentyfikatorOdrzuconegoSprawozdania, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.IdentyfikatorSprawozdaniaLacznego, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.IdentyfikatorOdrzuconegoSprawozdania, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RBWSB_Pozycje' BEGIN
MERGE INTO zef2.RBWSB_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RBWSB_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.Kwota=src.Kwota, tgt.KodWiersza=src.KodWiersza, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.Program=src.Program, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, Kwota, KodWiersza, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, Program, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.Kwota, src.KodWiersza, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.Program, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RBZ_Dokument' BEGIN
MERGE INTO zef2.RBZ_Dokument AS tgt
USING WA_StageHurtownia.zef2.RBZ_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, IdentyfikatorSprawozdania, KodJednostki, Status, GrupaZatwierdzen, IdentyfikatorSprawozdaniaLacznego, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, KodGrupyDefinicji, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, IdentyfikatorOdrzuconegoSprawozdania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.IdentyfikatorSprawozdania, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.IdentyfikatorSprawozdaniaLacznego, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.KodGrupyDefinicji, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.IdentyfikatorOdrzuconegoSprawozdania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RBZ_Pozycje' BEGIN
MERGE INTO zef2.RBZ_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RBZ_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.KwotaZadluzeniaOgolem=src.KwotaZadluzeniaOgolem, tgt.OgolemKolumna3=src.OgolemKolumna3, tgt.SektorFinansowPublicznych=src.SektorFinansowPublicznych, tgt.GrupaI=src.GrupaI, tgt.GrupaII=src.GrupaII, tgt.GrupaIII=src.GrupaIII, tgt.GrupaIV=src.GrupaIV, tgt.BankCentralny=src.BankCentralny, tgt.Banki=src.Banki, tgt.PozostaleKrajoweInstytFinans=src.PozostaleKrajoweInstytFinans, tgt.PrzedsiebiorstwaNiefinansowe=src.PrzedsiebiorstwaNiefinansowe, tgt.GospodarstwaDomowe=src.GospodarstwaDomowe, tgt.InstytNiekomercNaRzeczGospodDom=src.InstytNiekomercNaRzeczGospodDom, tgt.OgolemKolumna15=src.OgolemKolumna15, tgt.PodmiotyNalezaceDoStrefyEuro=src.PodmiotyNalezaceDoStrefyEuro, tgt.PozostalePodmiotyZagraniczne=src.PozostalePodmiotyZagraniczne, tgt.KodWiersza=src.KodWiersza, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, KwotaZadluzeniaOgolem, OgolemKolumna3, SektorFinansowPublicznych, GrupaI, GrupaII, GrupaIII, GrupaIV, BankCentralny, Banki, PozostaleKrajoweInstytFinans, PrzedsiebiorstwaNiefinansowe, GospodarstwaDomowe, InstytNiekomercNaRzeczGospodDom, OgolemKolumna15, PodmiotyNalezaceDoStrefyEuro, PozostalePodmiotyZagraniczne, KodWiersza, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.KwotaZadluzeniaOgolem, src.OgolemKolumna3, src.SektorFinansowPublicznych, src.GrupaI, src.GrupaII, src.GrupaIII, src.GrupaIV, src.BankCentralny, src.Banki, src.PozostaleKrajoweInstytFinans, src.PrzedsiebiorstwaNiefinansowe, src.GospodarstwaDomowe, src.InstytNiekomercNaRzeczGospodDom, src.OgolemKolumna15, src.PodmiotyNalezaceDoStrefyEuro, src.PozostalePodmiotyZagraniczne, src.KodWiersza, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RZIS_Dokument' BEGIN
MERGE INTO zef2.RZIS_Dokument AS tgt
USING WA_StageHurtownia.zef2.RZIS_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, IdentyfikatorSprawozdaniaLacznego, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, IdentyfikatorOdrzuconegoSprawozdania, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, KodGrupyDefinicji)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.IdentyfikatorSprawozdaniaLacznego, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.IdentyfikatorOdrzuconegoSprawozdania, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'RZIS_Pozycje' BEGIN
MERGE INTO zef2.RZIS_Pozycje AS tgt
USING WA_StageHurtownia.zef2.RZIS_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.StanNaKoniecRokuPoprzedniego=src.StanNaKoniecRokuPoprzedniego, tgt.StanNaKoniecRokuBiezacego=src.StanNaKoniecRokuBiezacego, tgt.KodWiersza=src.KodWiersza, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, StanNaKoniecRokuPoprzedniego, StanNaKoniecRokuBiezacego, KodWiersza, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.StanNaKoniecRokuPoprzedniego, src.StanNaKoniecRokuBiezacego, src.KodWiersza, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'SC4_Dokument' BEGIN
MERGE INTO zef2.SC4_Dokument AS tgt
USING WA_StageHurtownia.zef2.SC4_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.TypSprawozdania=src.TypSprawozdania, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.Uwagi=src.Uwagi, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (OkresSprawozdawczy, NumerSprawozdania, Opis, Zalacznik, CzyZaksiegowane, TypSprawozdania, PrzetwarzanyProfilKsiegowania, Uwagi, IdentyfikatorSprawozdania, KodJednostki, Status, GrupaZatwierdzen, IdentyfikatorSprawozdaniaLacznego, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, KodGrupyDefinicji, OpisWyjasnienie, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatorRekordu, IdentyfikatorOdrzuconegoSprawozdania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, ZalacznikStornowania, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor)
VALUES (src.OkresSprawozdawczy, src.NumerSprawozdania, src.Opis, src.Zalacznik, src.CzyZaksiegowane, src.TypSprawozdania, src.PrzetwarzanyProfilKsiegowania, src.Uwagi, src.IdentyfikatorSprawozdania, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.IdentyfikatorSprawozdaniaLacznego, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.KodGrupyDefinicji, src.OpisWyjasnienie, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatorRekordu, src.IdentyfikatorOdrzuconegoSprawozdania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.ZalacznikStornowania, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'SC4_Pozycje' BEGIN
MERGE INTO zef2.SC4_Pozycje AS tgt
USING WA_StageHurtownia.zef2.SC4_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.Paragraf4010=src.Paragraf4010, tgt.Paragraf4020=src.Paragraf4020, tgt.Paragraf4050=src.Paragraf4050, tgt.Paragraf4060=src.Paragraf4060, tgt.LiczbaFunkcjonariuszy=src.LiczbaFunkcjonariuszy, tgt.LiczbaWyplaconychSwiadczen=src.LiczbaWyplaconychSwiadczen, tgt.KodWiersza=src.KodWiersza, tgt.IdSprawozdania=src.IdSprawozdania, tgt.Wymiar=src.Wymiar, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Paragraf=src.Paragraf, tgt.KodProjektu=src.KodProjektu, tgt.IdProgramu=src.IdProgramu, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.Dzialanie=src.Dzialanie, tgt.Czesc=src.Czesc, tgt.NazwaProgramu=src.NazwaProgramu, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.PowodUmorzenia=src.PowodUmorzenia, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.Uwagi=src.Uwagi
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (Opis, NumerWiersza, Paragraf4010, Paragraf4020, Paragraf4050, Paragraf4060, LiczbaFunkcjonariuszy, LiczbaWyplaconychSwiadczen, KodWiersza, IdSprawozdania, Wymiar, Klasyfikacja, Dzial, Rozdzial, Paragraf, KodProjektu, IdProgramu, KodGrupyZatrudnienia, KontoKsiegowe, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, IdentyfikatoRekordu, Dzialanie, Czesc, NazwaProgramu, NazwaOdbiorcy, AdresOdbiorcy, PrzyczynyDecyzjiUmorzenia, PowodUmorzenia, KodPozycjiTrezor, KodSekcjiTrezor, Uwagi)
VALUES (src.Opis, src.NumerWiersza, src.Paragraf4010, src.Paragraf4020, src.Paragraf4050, src.Paragraf4060, src.LiczbaFunkcjonariuszy, src.LiczbaWyplaconychSwiadczen, src.KodWiersza, src.IdSprawozdania, src.Wymiar, src.Klasyfikacja, src.Dzial, src.Rozdzial, src.Paragraf, src.KodProjektu, src.IdProgramu, src.KodGrupyZatrudnienia, src.KontoKsiegowe, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.IdentyfikatoRekordu, src.Dzialanie, src.Czesc, src.NazwaProgramu, src.NazwaOdbiorcy, src.AdresOdbiorcy, src.PrzyczynyDecyzjiUmorzenia, src.PowodUmorzenia, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.Uwagi)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'WersjaZefir' BEGIN
MERGE INTO zef2.WersjaZefir AS tgt
USING WA_StageHurtownia.zef2.WersjaZefir AS src
ON (tgt.id=src.id)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.data_aktualizacji=src.data_aktualizacji, tgt.wersja=src.wersja, tgt.baza_zrodlowa=src.baza_zrodlowa, tgt.czy_powodzenie=src.czy_powodzenie
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (id, data_aktualizacji, wersja, baza_zrodlowa, czy_powodzenie)
VALUES (src.id, src.data_aktualizacji, src.wersja, src.baza_zrodlowa, src.czy_powodzenie)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZZFJ_Dokument' BEGIN
MERGE INTO zef2.ZZFJ_Dokument AS tgt
USING WA_StageHurtownia.zef2.ZZFJ_Dokument AS src
ON (tgt.IdentyfikatorRekordu=src.IdentyfikatorRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.NumerSprawozdania=src.NumerSprawozdania, tgt.OkresSprawozdawczy=src.OkresSprawozdawczy, tgt.Opis=src.Opis, tgt.Zalacznik=src.Zalacznik, tgt.ZalacznikStornowania=src.ZalacznikStornowania, tgt.CzyZaksiegowane=src.CzyZaksiegowane, tgt.PrzetwarzanyProfilKsiegowania=src.PrzetwarzanyProfilKsiegowania, tgt.TypSprawozdania=src.TypSprawozdania, tgt.Uwagi=src.Uwagi, tgt.KodJednostki=src.KodJednostki, tgt.Status=src.Status, tgt.GrupaZatwierdzen=src.GrupaZatwierdzen, tgt.CzyAgregat=src.CzyAgregat, tgt.CzyWyslanoDoJednNadrzed=src.CzyWyslanoDoJednNadrzed, tgt.CzyZatwierdzony=src.CzyZatwierdzony, tgt.SciezkaAgregacji=src.SciezkaAgregacji, tgt.Czesc=src.Czesc, tgt.CzyWygenerowaneCzyWprowRecznie=src.CzyWygenerowaneCzyWprowRecznie, tgt.Poziom=src.Poziom, tgt.PoziomDysponentaSprawozd=src.PoziomDysponentaSprawozd, tgt.Adresat=src.Adresat, tgt.CzyPrzyjete=src.CzyPrzyjete, tgt.CzyOdrzuconePrzezJednNadrzed=src.CzyOdrzuconePrzezJednNadrzed, tgt.IdentyfikatorSprawozdania=src.IdentyfikatorSprawozdania, tgt.IdentyfikatorOdrzuconegoSprawozdania=src.IdentyfikatorOdrzuconegoSprawozdania, tgt.IdentyfikatorSprawozdaniaLacznego=src.IdentyfikatorSprawozdaniaLacznego, tgt.OpisWyjasnienie=src.OpisWyjasnienie, tgt.DataWyslania=src.DataWyslania, tgt.DataGodzWygenerowania=src.DataGodzWygenerowania, tgt.DataZaksiegowania=src.DataZaksiegowania, tgt.CzyWystornowano=src.CzyWystornowano, tgt.DataStornowania=src.DataStornowania, tgt.WystornowanoPrzez=src.WystornowanoPrzez, tgt.KodProcesuTrezor=src.KodProcesuTrezor, tgt.TypDefinicjiSprawozdaniaTrezor=src.TypDefinicjiSprawozdaniaTrezor, tgt.KodJednostkiTrezor=src.KodJednostkiTrezor, tgt.OkresBudzetowyTrezor=src.OkresBudzetowyTrezor, tgt.TrezorXML=src.TrezorXML, tgt.StatusDokumentuTrezor=src.StatusDokumentuTrezor, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.KodGrupyDefinicji=src.KodGrupyDefinicji
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatorRekordu, NumerSprawozdania, OkresSprawozdawczy, Opis, Zalacznik, ZalacznikStornowania, CzyZaksiegowane, PrzetwarzanyProfilKsiegowania, TypSprawozdania, Uwagi, KodJednostki, Status, GrupaZatwierdzen, CzyAgregat, CzyWyslanoDoJednNadrzed, CzyZatwierdzony, SciezkaAgregacji, Czesc, CzyWygenerowaneCzyWprowRecznie, Poziom, PoziomDysponentaSprawozd, Adresat, CzyPrzyjete, CzyOdrzuconePrzezJednNadrzed, IdentyfikatorSprawozdania, IdentyfikatorOdrzuconegoSprawozdania, IdentyfikatorSprawozdaniaLacznego, OpisWyjasnienie, DataWyslania, DataGodzWygenerowania, DataZaksiegowania, CzyWystornowano, DataStornowania, WystornowanoPrzez, KodProcesuTrezor, TypDefinicjiSprawozdaniaTrezor, KodJednostkiTrezor, OkresBudzetowyTrezor, TrezorXML, StatusDokumentuTrezor, DataGodzOstatnModyfikacji, IdUzytkownikaOstatnModyfikujacego, IdTransakcjiModyfikacji, DataGodzUtworzeniaRekordu, IdUzytkownikaTworzacego, IdTransakcjiUtworzeniaRekordu, WersjaRekordu, Partycja, KodGrupyDefinicji)
VALUES (src.IdentyfikatorRekordu, src.NumerSprawozdania, src.OkresSprawozdawczy, src.Opis, src.Zalacznik, src.ZalacznikStornowania, src.CzyZaksiegowane, src.PrzetwarzanyProfilKsiegowania, src.TypSprawozdania, src.Uwagi, src.KodJednostki, src.Status, src.GrupaZatwierdzen, src.CzyAgregat, src.CzyWyslanoDoJednNadrzed, src.CzyZatwierdzony, src.SciezkaAgregacji, src.Czesc, src.CzyWygenerowaneCzyWprowRecznie, src.Poziom, src.PoziomDysponentaSprawozd, src.Adresat, src.CzyPrzyjete, src.CzyOdrzuconePrzezJednNadrzed, src.IdentyfikatorSprawozdania, src.IdentyfikatorOdrzuconegoSprawozdania, src.IdentyfikatorSprawozdaniaLacznego, src.OpisWyjasnienie, src.DataWyslania, src.DataGodzWygenerowania, src.DataZaksiegowania, src.CzyWystornowano, src.DataStornowania, src.WystornowanoPrzez, src.KodProcesuTrezor, src.TypDefinicjiSprawozdaniaTrezor, src.KodJednostkiTrezor, src.OkresBudzetowyTrezor, src.TrezorXML, src.StatusDokumentuTrezor, src.DataGodzOstatnModyfikacji, src.IdUzytkownikaOstatnModyfikujacego, src.IdTransakcjiModyfikacji, src.DataGodzUtworzeniaRekordu, src.IdUzytkownikaTworzacego, src.IdTransakcjiUtworzeniaRekordu, src.WersjaRekordu, src.Partycja, src.KodGrupyDefinicji)
;SET @Merged = 1; 
END

 


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ZZFJ_Pozycje' BEGIN
MERGE INTO zef2.ZZFJ_Pozycje AS tgt
USING WA_StageHurtownia.zef2.ZZFJ_Pozycje AS src
ON (tgt.IdentyfikatoRekordu=src.IdentyfikatoRekordu)
WHEN MATCHED  AND src.operacja IN ('U', 'I')
THEN UPDATE SET
tgt.IdSprawozdania=src.IdSprawozdania, tgt.Opis=src.Opis, tgt.NumerWiersza=src.NumerWiersza, tgt.StanNaKoniecRokuPoprzedniego=src.StanNaKoniecRokuPoprzedniego, tgt.StanNaKoniecRokuBiezacego=src.StanNaKoniecRokuBiezacego, tgt.KodWiersza=src.KodWiersza, tgt.KodPozycjiTrezor=src.KodPozycjiTrezor, tgt.KodSekcjiTrezor=src.KodSekcjiTrezor, tgt.WersjaRekordu=src.WersjaRekordu, tgt.Partycja=src.Partycja, tgt.IdUzytkownikaTworzacego=src.IdUzytkownikaTworzacego, tgt.DataGodzUtworzeniaRekordu=src.DataGodzUtworzeniaRekordu, tgt.IdTransakcjiUtworzeniaRekordu=src.IdTransakcjiUtworzeniaRekordu, tgt.AdresOdbiorcy=src.AdresOdbiorcy, tgt.NazwaOdbiorcy=src.NazwaOdbiorcy, tgt.KodGrupyZatrudnienia=src.KodGrupyZatrudnienia, tgt.Klasyfikacja=src.Klasyfikacja, tgt.Paragraf=src.Paragraf, tgt.Czesc=src.Czesc, tgt.IdProgramu=src.IdProgramu, tgt.KodProjektu=src.KodProjektu, tgt.Dzial=src.Dzial, tgt.Rozdzial=src.Rozdzial, tgt.Dzialanie=src.Dzialanie, tgt.Wymiar=src.Wymiar, tgt.KontoKsiegowe=src.KontoKsiegowe, tgt.IdUzytkownikaOstatnModyfikujacego=src.IdUzytkownikaOstatnModyfikujacego, tgt.DataGodzOstatnModyfikacji=src.DataGodzOstatnModyfikacji, tgt.IdTransakcjiModyfikacji=src.IdTransakcjiModyfikacji, tgt.NazwaProgramu=src.NazwaProgramu, tgt.PrzyczynyDecyzjiUmorzenia=src.PrzyczynyDecyzjiUmorzenia, tgt.Uwagi=src.Uwagi, tgt.PowodUmorzenia=src.PowodUmorzenia
WHEN MATCHED AND src.operacja = 'D' THEN DELETE
WHEN NOT MATCHED AND src.operacja IN ('U', 'I')
THEN INSERT (IdentyfikatoRekordu, IdSprawozdania, Opis, NumerWiersza, StanNaKoniecRokuPoprzedniego, StanNaKoniecRokuBiezacego, KodWiersza, KodPozycjiTrezor, KodSekcjiTrezor, WersjaRekordu, Partycja, IdUzytkownikaTworzacego, DataGodzUtworzeniaRekordu, IdTransakcjiUtworzeniaRekordu, AdresOdbiorcy, NazwaOdbiorcy, KodGrupyZatrudnienia, Klasyfikacja, Paragraf, Czesc, IdProgramu, KodProjektu, Dzial, Rozdzial, Dzialanie, Wymiar, KontoKsiegowe, IdUzytkownikaOstatnModyfikujacego, DataGodzOstatnModyfikacji, IdTransakcjiModyfikacji, NazwaProgramu, PrzyczynyDecyzjiUmorzenia, Uwagi, PowodUmorzenia)
VALUES (src.IdentyfikatoRekordu, src.IdSprawozdania, src.Opis, src.NumerWiersza, src.StanNaKoniecRokuPoprzedniego, src.StanNaKoniecRokuBiezacego, src.KodWiersza, src.KodPozycjiTrezor, src.KodSekcjiTrezor, src.WersjaRekordu, src.Partycja, src.IdUzytkownikaTworzacego, src.DataGodzUtworzeniaRekordu, src.IdTransakcjiUtworzeniaRekordu, src.AdresOdbiorcy, src.NazwaOdbiorcy, src.KodGrupyZatrudnienia, src.Klasyfikacja, src.Paragraf, src.Czesc, src.IdProgramu, src.KodProjektu, src.Dzial, src.Rozdzial, src.Dzialanie, src.Wymiar, src.KontoKsiegowe, src.IdUzytkownikaOstatnModyfikujacego, src.DataGodzOstatnModyfikacji, src.IdTransakcjiModyfikacji, src.NazwaProgramu, src.PrzyczynyDecyzjiUmorzenia, src.Uwagi, src.PowodUmorzenia)
;SET @Merged = 1; 
END

IF (@Merged = 0)
	BEGIN
			DECLARE @Info VARCHAR(500) = 'W procedurze nie znaleziono bloku odpowiadającego tabeli [' + @TableName + '] z parametru @TableName.';
			THROW 51002, @Info, 0;
				END
			END;