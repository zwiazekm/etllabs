





-- ==============================================
-- Author:		Michał Błędowski
-- Create date: 2015-12-17
-- Description:	Procedura Merge'ująca w schemacie AIMP2.
-- ===============================================

CREATE PROCEDURE [aimp2].[MergeTableFromStageODS] (@TableName VARCHAR(50) = NULL)
AS
BEGIN
	SET NOCOUNT ON;
	DECLARE @Merged BIT = 0;

	IF (@TableName IS NULL) BEGIN
		;THROW 51001, 'Nie wskazano nazwy tabeli w parametrze @TableName procedury.', 0;
		END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ariadna_dokument' BEGIN
	MERGE INTO aimp2.ariadna_dokument AS tgt
	USING WI_StageODS.aimp2.ariadna_dokument AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.numer_dokumentu_ZISAR=src.numer_dokumentu_ZISAR, tgt.numer_dokumentu_SO=src.numer_dokumentu_SO, tgt.system_operacyjny=src.system_operacyjny, tgt.rodzaj_dokumentu=src.rodzaj_dokumentu, tgt.nr_typu_komunikatu=src.nr_typu_komunikatu, tgt.wynik_analizy_ryzyka=src.wynik_analizy_ryzyka, tgt.uc_zglaszajacy_do_AAR=src.uc_zglaszajacy_do_AAR, tgt.uc_kontroli_towarow=src.uc_kontroli_towarow
	WHEN NOT MATCHED
	THEN INSERT (id, numer_dokumentu_ZISAR, numer_dokumentu_SO, system_operacyjny, rodzaj_dokumentu, nr_typu_komunikatu, wynik_analizy_ryzyka, uc_zglaszajacy_do_AAR, uc_kontroli_towarow)
	VALUES (src.id, src.numer_dokumentu_ZISAR, src.numer_dokumentu_SO, src.system_operacyjny, src.rodzaj_dokumentu, src.nr_typu_komunikatu, src.wynik_analizy_ryzyka, src.uc_zglaszajacy_do_AAR, src.uc_kontroli_towarow);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ariadna_metody_kontroli' BEGIN
	MERGE INTO aimp2.ariadna_metody_kontroli AS tgt
	USING WI_StageODS.aimp2.ariadna_metody_kontroli AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.obsluga_wskazan_kontroli_id=src.obsluga_wskazan_kontroli_id, tgt.poziom_zdefiniowania=src.poziom_zdefiniowania, tgt.metoda_kontroli=src.metoda_kontroli
	WHEN NOT MATCHED
	THEN INSERT (id, obsluga_wskazan_kontroli_id, poziom_zdefiniowania, metoda_kontroli)
	VALUES (src.id, src.obsluga_wskazan_kontroli_id, src.poziom_zdefiniowania, src.metoda_kontroli);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ariadna_owk' BEGIN
	MERGE INTO aimp2.ariadna_owk AS tgt
	USING WI_StageODS.aimp2.ariadna_owk AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.dokument_id=src.dokument_id, tgt.numer_dokumentu_ZISAR=src.numer_dokumentu_ZISAR, tgt.zrodlo=src.zrodlo, tgt.nr_algorytmu=src.nr_algorytmu, tgt.autor=src.autor, tgt.WAR1=src.WAR1, tgt.WAR1_SO=src.WAR1_SO, tgt.WAR24=src.WAR24, tgt.WAR24_SO=src.WAR24_SO, tgt.WAR5_SO=src.WAR5_SO, tgt.Zmiana_WAR_uzasadnienie_SO=src.Zmiana_WAR_uzasadnienie_SO, tgt.obszar_ryzyka=src.obszar_ryzyka, tgt.Zmiana_mk_uz_SO=src.Zmiana_mk_uz_SO, tgt.tresc_dyrektywy=src.tresc_dyrektywy, tgt.informacja_dla_dyspozytora=src.informacja_dla_dyspozytora, tgt.decyzja_dyspozytora_SO=src.decyzja_dyspozytora_SO, tgt.odst_od_kontroli_uz_SO=src.odst_od_kontroli_uz_SO, tgt.adresaci_dyrektywy_SO=src.adresaci_dyrektywy_SO, tgt.zalecenie_dyspozytora_SO=src.zalecenie_dyspozytora_SO, tgt.ddk_UC_wprowadzenia_SO=src.ddk_UC_wprowadzenia_SO, tgt.zakres_przebieg_kontroli_SO=src.zakres_przebieg_kontroli_SO, tgt.wynik_kontroli_SO=src.wynik_kontroli_SO
	WHEN NOT MATCHED
	THEN INSERT (id, dokument_id, numer_dokumentu_ZISAR, zrodlo, nr_algorytmu, autor, WAR1, WAR1_SO, WAR24, WAR24_SO, WAR5_SO, Zmiana_WAR_uzasadnienie_SO, obszar_ryzyka, Zmiana_mk_uz_SO, tresc_dyrektywy, informacja_dla_dyspozytora, decyzja_dyspozytora_SO, odst_od_kontroli_uz_SO, adresaci_dyrektywy_SO, zalecenie_dyspozytora_SO, ddk_UC_wprowadzenia_SO, zakres_przebieg_kontroli_SO, wynik_kontroli_SO)
	VALUES (src.id, src.dokument_id, src.numer_dokumentu_ZISAR, src.zrodlo, src.nr_algorytmu, src.autor, src.WAR1, src.WAR1_SO, src.WAR24, src.WAR24_SO, src.WAR5_SO, src.Zmiana_WAR_uzasadnienie_SO, src.obszar_ryzyka, src.Zmiana_mk_uz_SO, src.tresc_dyrektywy, src.informacja_dla_dyspozytora, src.decyzja_dyspozytora_SO, src.odst_od_kontroli_uz_SO, src.adresaci_dyrektywy_SO, src.zalecenie_dyspozytora_SO, src.ddk_UC_wprowadzenia_SO, src.zakres_przebieg_kontroli_SO, src.wynik_kontroli_SO);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ariadna_owk_podsumowanie' BEGIN
	MERGE INTO aimp2.ariadna_owk_podsumowanie AS tgt
	USING WI_StageODS.aimp2.ariadna_owk_podsumowanie AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.obsluga_wskazan_kontroli_id=src.obsluga_wskazan_kontroli_id, tgt.nr_pozycji=src.nr_pozycji, tgt.zakres_przebieg_kontroli_SO=src.zakres_przebieg_kontroli_SO, tgt.wynik_kontroli_SO=src.wynik_kontroli_SO
	WHEN NOT MATCHED
	THEN INSERT (id, obsluga_wskazan_kontroli_id, nr_pozycji, zakres_przebieg_kontroli_SO, wynik_kontroli_SO)
	VALUES (src.id, src.obsluga_wskazan_kontroli_id, src.nr_pozycji, src.zakres_przebieg_kontroli_SO, src.wynik_kontroli_SO);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ariadna_owk_pozycje' BEGIN
	MERGE INTO aimp2.ariadna_owk_pozycje AS tgt
	USING WI_StageODS.aimp2.ariadna_owk_pozycje AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.obsluga_wskazan_kontroli_id=src.obsluga_wskazan_kontroli_id, tgt.nr_pozycji=src.nr_pozycji
	WHEN NOT MATCHED
	THEN INSERT (id, obsluga_wskazan_kontroli_id, nr_pozycji)
	VALUES (src.id, src.obsluga_wskazan_kontroli_id, src.nr_pozycji);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ariadna_zespol_kontroli' BEGIN
	MERGE INTO aimp2.ariadna_zespol_kontroli AS tgt
	USING WI_StageODS.aimp2.ariadna_zespol_kontroli AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.obsluga_wskazan_kontroli_id=src.obsluga_wskazan_kontroli_id, tgt.login=src.login, tgt.rejestrator_wynikow_ZISAR=src.rejestrator_wynikow_ZISAR
	WHEN NOT MATCHED
	THEN INSERT (id, obsluga_wskazan_kontroli_id, login, rejestrator_wynikow_ZISAR)
	VALUES (src.id, src.obsluga_wskazan_kontroli_id, src.login, src.rejestrator_wynikow_ZISAR);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_CHANG' BEGIN
	MERGE INTO aimp2.ICS_CHANG AS tgt
	USING WI_StageODS.aimp2.ICS_CHANG AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.AFTER=src.AFTER, tgt.BEFORE=src.BEFORE, tgt.ITEM=src.ITEM, tgt.OPER_ID=src.OPER_ID
	WHEN NOT MATCHED
	THEN INSERT (ID, AFTER, BEFORE, ITEM, OPER_ID)
	VALUES (src.ID, src.AFTER, src.BEFORE, src.ITEM, src.OPER_ID);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DECL' BEGIN
	MERGE INTO aimp2.ICS_DECL AS tgt
	USING WI_StageODS.aimp2.ICS_DECL AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.TYPE=src.TYPE, tgt.FLAG=src.FLAG, tgt.MANUAL=src.MANUAL, tgt.REF_NO=src.REF_NO, tgt.RETR_EMAIL=src.RETR_EMAIL, tgt.RETR_POST=src.RETR_POST, tgt.SELF_REF=src.SELF_REF, tgt.SIGN=src.SIGN, tgt.VERSION=src.VERSION, tgt.dts=src.dts, tgt.aeo=src.aeo, tgt.segmentation=src.segmentation, tgt.TYPED=src.TYPED, tgt.EMERGENCY=src.EMERGENCY, tgt.REF_NO_PAPER=src.REF_NO_PAPER, tgt.trad_com_system=src.trad_com_system, tgt.login=src.login, tgt.ULOCK_FLAG=src.ULOCK_FLAG, tgt.ULOCK_TIME=src.ULOCK_TIME
	WHEN NOT MATCHED
	THEN INSERT (ID, TYPE, FLAG, MANUAL, REF_NO, RETR_EMAIL, RETR_POST, SELF_REF, SIGN, VERSION, dts, aeo, segmentation, TYPED, EMERGENCY, REF_NO_PAPER, trad_com_system, login, ULOCK_FLAG, ULOCK_TIME)
	VALUES (src.ID, src.TYPE, src.FLAG, src.MANUAL, src.REF_NO, src.RETR_EMAIL, src.RETR_POST, src.SELF_REF, src.SIGN, src.VERSION, src.dts, src.aeo, src.segmentation, src.TYPED, src.EMERGENCY, src.REF_NO_PAPER, src.trad_com_system, src.login, src.ULOCK_FLAG, src.ULOCK_TIME);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DECL_PARAM' BEGIN
	MERGE INTO aimp2.ICS_DECL_PARAM AS tgt
	USING WI_StageODS.aimp2.ICS_DECL_PARAM AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.decl_id=src.decl_id, tgt.key_name=src.key_name, tgt.value=src.value
	WHEN NOT MATCHED
	THEN INSERT (id, decl_id, key_name, value)
	VALUES (src.id, src.decl_id, src.key_name, src.value);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DIRT' BEGIN
	MERGE INTO aimp2.ICS_DIRT AS tgt
	USING WI_StageODS.aimp2.ICS_DIRT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ADDRESSEE=src.ADDRESSEE, tgt.AUTHOR=src.AUTHOR, tgt.DIR_FOR_NEXT_CO=src.DIR_FOR_NEXT_CO, tgt.DIR_DISPATCHER=src.DIR_DISPATCHER, tgt.INFORMATION=src.INFORMATION, tgt.WARUE=src.WARUE, tgt.WAR1=src.WAR1, tgt.WAR234=src.WAR234, tgt.WAR5=src.WAR5, tgt.COMMENT=src.COMMENT, tgt.MRN=src.MRN, tgt.ALGORITHM_NUMBER=src.ALGORITHM_NUMBER, tgt.OBJECTION_NUMBER=src.OBJECTION_NUMBER, tgt.RISK_AREA=src.RISK_AREA, tgt.samples=src.samples, tgt.PROFILE=src.PROFILE, tgt.STATUS=src.STATUS, tgt.TEXT=src.TEXT, tgt.CONTROL_TYPE=src.CONTROL_TYPE, tgt.POINTER=src.POINTER, tgt.RESULT=src.RESULT, tgt.SOURCE=src.SOURCE, tgt.DECL_ID=src.DECL_ID, tgt.ITEM_TYPE=src.ITEM_TYPE, tgt.REALISATION_DATE=src.REALISATION_DATE, tgt.ID_VERIFICATION_ITEM=src.ID_VERIFICATION_ITEM, tgt.DIRTYPE=src.DIRTYPE, tgt.INTRO=src.INTRO, tgt.ORIGIN=src.ORIGIN, tgt.VERIFICATION_REQUIRED=src.VERIFICATION_REQUIRED, tgt.MODIFIED_BY=src.MODIFIED_BY, tgt.RISK_ANALYSIS_RESULT=src.RISK_ANALYSIS_RESULT, tgt.RESERVATION_NUMBER=src.RESERVATION_NUMBER, tgt.INFORMATION_FOR_DISPATCHER=src.INFORMATION_FOR_DISPATCHER, tgt.AGRIM_DISCREPANCY=src.AGRIM_DISCREPANCY, tgt.OFFICIAL_ANNOTATION=src.OFFICIAL_ANNOTATION, tgt.ADD_TEXT=src.ADD_TEXT, tgt.forced_veri=src.forced_veri, tgt.correct_calc_tsk=src.correct_calc_tsk, tgt.zisar_source=src.zisar_source, tgt.zisar_id=src.zisar_id, tgt.ENTITY_ROLE=src.ENTITY_ROLE, tgt.ADDRESSED_TO_CUSTOMS_OFFICE=src.ADDRESSED_TO_CUSTOMS_OFFICE, tgt.DIR_ACF=src.DIR_ACF
	WHEN NOT MATCHED
	THEN INSERT (ID, ADDRESSEE, AUTHOR, DIR_FOR_NEXT_CO, DIR_DISPATCHER, INFORMATION, WARUE, WAR1, WAR234, WAR5, COMMENT, MRN, ALGORITHM_NUMBER, OBJECTION_NUMBER, RISK_AREA, samples, PROFILE, STATUS, TEXT, CONTROL_TYPE, POINTER, RESULT, SOURCE, DECL_ID, ITEM_TYPE, REALISATION_DATE, ID_VERIFICATION_ITEM, DIRTYPE, INTRO, ORIGIN, VERIFICATION_REQUIRED, MODIFIED_BY, RISK_ANALYSIS_RESULT, RESERVATION_NUMBER, INFORMATION_FOR_DISPATCHER, AGRIM_DISCREPANCY, OFFICIAL_ANNOTATION, ADD_TEXT, forced_veri, correct_calc_tsk, zisar_source, zisar_id, ENTITY_ROLE, ADDRESSED_TO_CUSTOMS_OFFICE, DIR_ACF)
	VALUES (src.ID, src.ADDRESSEE, src.AUTHOR, src.DIR_FOR_NEXT_CO, src.DIR_DISPATCHER, src.INFORMATION, src.WARUE, src.WAR1, src.WAR234, src.WAR5, src.COMMENT, src.MRN, src.ALGORITHM_NUMBER, src.OBJECTION_NUMBER, src.RISK_AREA, src.samples, src.PROFILE, src.STATUS, src.TEXT, src.CONTROL_TYPE, src.POINTER, src.RESULT, src.SOURCE, src.DECL_ID, src.ITEM_TYPE, src.REALISATION_DATE, src.ID_VERIFICATION_ITEM, src.DIRTYPE, src.INTRO, src.ORIGIN, src.VERIFICATION_REQUIRED, src.MODIFIED_BY, src.RISK_ANALYSIS_RESULT, src.RESERVATION_NUMBER, src.INFORMATION_FOR_DISPATCHER, src.AGRIM_DISCREPANCY, src.OFFICIAL_ANNOTATION, src.ADD_TEXT, src.forced_veri, src.correct_calc_tsk, src.zisar_source, src.zisar_id, src.ENTITY_ROLE, src.ADDRESSED_TO_CUSTOMS_OFFICE, src.DIR_ACF);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DIRT_CHANGE' BEGIN
	MERGE INTO aimp2.ICS_DIRT_CHANGE AS tgt
	USING WI_StageODS.aimp2.ICS_DIRT_CHANGE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DIRT_ID=src.DIRT_ID, tgt.AFFECTS=src.AFFECTS, tgt.AFTER=src.AFTER, tgt.JUSTIFICATION=src.JUSTIFICATION, tgt.INITIAL_VALUE=src.INITIAL_VALUE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DIRT_ID, AFFECTS, AFTER, JUSTIFICATION, INITIAL_VALUE, version)
	VALUES (src.ID, src.DIRT_ID, src.AFFECTS, src.AFTER, src.JUSTIFICATION, src.INITIAL_VALUE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DIRT_CONTROL_METHOD' BEGIN
	MERGE INTO aimp2.ICS_DIRT_CONTROL_METHOD AS tgt
	USING WI_StageODS.aimp2.ICS_DIRT_CONTROL_METHOD AS src
	ON (tgt.directive_id=src.directive_id AND tgt.code=src.code)
	WHEN NOT MATCHED
	THEN INSERT (directive_id, code)
	VALUES (src.directive_id, src.code);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DIRT_IND' BEGIN
	MERGE INTO aimp2.ICS_DIRT_IND AS tgt
	USING WI_StageODS.aimp2.ICS_DIRT_IND AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DIRECTIVE_ID=src.DIRECTIVE_ID, tgt.NAME=src.NAME, tgt.VALUE=src.VALUE, tgt.show=src.show, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DIRECTIVE_ID, NAME, VALUE, show, version)
	VALUES (src.ID, src.DIRECTIVE_ID, src.NAME, src.VALUE, src.show, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DIRT_INTR' BEGIN
	MERGE INTO aimp2.ICS_DIRT_INTR AS tgt
	USING WI_StageODS.aimp2.ICS_DIRT_INTR AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.CODE=src.CODE, tgt.DIRT_ID=src.DIRT_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, CODE, DIRT_ID, version)
	VALUES (src.ID, src.CODE, src.DIRT_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DIRT_POSITION' BEGIN
	MERGE INTO aimp2.ICS_DIRT_POSITION AS tgt
	USING WI_StageODS.aimp2.ICS_DIRT_POSITION AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.directive_id=src.directive_id, tgt.position=src.position
	WHEN NOT MATCHED
	THEN INSERT (id, directive_id, position)
	VALUES (src.id, src.directive_id, src.position);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DPZ_CONS_RECEIVER' BEGIN
	MERGE INTO aimp2.ICS_DPZ_CONS_RECEIVER AS tgt
	USING WI_StageODS.aimp2.ICS_DPZ_CONS_RECEIVER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.RECEIVER_TYPE=src.RECEIVER_TYPE, tgt.N_FIRST_NAME=src.N_FIRST_NAME, tgt.N_LAST_NAME=src.N_LAST_NAME, tgt.N_PESEL=src.N_PESEL, tgt.B_IDENTIFIER=src.B_IDENTIFIER, tgt.B_NAME=src.B_NAME, tgt.DECL_ID=src.DECL_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, RECEIVER_TYPE, N_FIRST_NAME, N_LAST_NAME, N_PESEL, B_IDENTIFIER, B_NAME, DECL_ID, version)
	VALUES (src.ID, src.RECEIVER_TYPE, src.N_FIRST_NAME, src.N_LAST_NAME, src.N_PESEL, src.B_IDENTIFIER, src.B_NAME, src.DECL_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DPZ_DECISION' BEGIN
	MERGE INTO aimp2.ICS_DPZ_DECISION AS tgt
	USING WI_StageODS.aimp2.ICS_DPZ_DECISION AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DEC_DATE=src.DEC_DATE, tgt.DECL_ID=src.DECL_ID, tgt.MRN=src.MRN, tgt.DEC_NO=src.DEC_NO, tgt.POSITIONS=src.POSITIONS, tgt.DESCRIPTION=src.DESCRIPTION, tgt.DTYPE=src.DTYPE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DEC_DATE, DECL_ID, MRN, DEC_NO, POSITIONS, DESCRIPTION, DTYPE, version)
	VALUES (src.ID, src.DEC_DATE, src.DECL_ID, src.MRN, src.DEC_NO, src.POSITIONS, src.DESCRIPTION, src.DTYPE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DPZ_LOCATION' BEGIN
	MERGE INTO aimp2.ICS_DPZ_LOCATION AS tgt
	USING WI_StageODS.aimp2.ICS_DPZ_LOCATION AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DPZ_ID=src.DPZ_ID, tgt.CODE=src.CODE, tgt.COUNTRY=src.COUNTRY, tgt.QUALIFIER=src.QUALIFIER, tgt.LOCATION_CO=src.LOCATION_CO, tgt.DESCRIPTION=src.DESCRIPTION, tgt.TYPE=src.TYPE, tgt.ZCP_ADDRESS_ID=src.ZCP_ADDRESS_ID, tgt.ADDITIONAL_IDENTITY=src.ADDITIONAL_IDENTITY, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DPZ_ID, CODE, COUNTRY, QUALIFIER, LOCATION_CO, DESCRIPTION, TYPE, ZCP_ADDRESS_ID, ADDITIONAL_IDENTITY, version)
	VALUES (src.ID, src.DPZ_ID, src.CODE, src.COUNTRY, src.QUALIFIER, src.LOCATION_CO, src.DESCRIPTION, src.TYPE, src.ZCP_ADDRESS_ID, src.ADDITIONAL_IDENTITY, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK' BEGIN
	MERGE INTO aimp2.ICS_DSK AS tgt
	USING WI_StageODS.aimp2.ICS_DSK AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DATA_PRZYJECIA=src.DATA_PRZYJECIA, tgt.DODATKOWY_EMAIL1=src.DODATKOWY_EMAIL1, tgt.MASA_BRUTTO=src.MASA_BRUTTO, tgt.NUMER_REFERENCYJNY_PRZESYLKI=src.NUMER_REFERENCYJNY_PRZESYLKI, tgt.PLACOWKA_PODMIOTU=src.PLACOWKA_PODMIOTU, tgt.PODPIS_ELEKTRONICZNY=src.PODPIS_ELEKTRONICZNY, tgt.STATUS=src.STATUS, tgt.UC_DEKLARACJI=src.UC_DEKLARACJI, tgt.OF_ODBIORCA_ID=src.OF_ODBIORCA_ID, tgt.PG_ODBIORCA_ID=src.PG_ODBIORCA_ID, tgt.OF_PODM_DO_KONTAKTU_ID=src.OF_PODM_DO_KONTAKTU_ID, tgt.PG_PODM_DO_KONTAKTU_ID=src.PG_PODM_DO_KONTAKTU_ID, tgt.OF_PRZEDSTAWICIEL_ID=src.OF_PRZEDSTAWICIEL_ID, tgt.PG_PRZEDSTAWICIEL_ID=src.PG_PRZEDSTAWICIEL_ID, tgt.OF_SKLAD_DEKL_ID=src.OF_SKLAD_DEKL_ID, tgt.PG_SKLAD_DEKL_ID=src.PG_SKLAD_DEKL_ID, tgt.REFERENCJE_DO_ZT=src.REFERENCJE_DO_ZT, tgt.PTW_MRZ=src.PTW_MRZ, tgt.GAN_ID=src.GAN_ID, tgt.UC_NADZORU=src.UC_NADZORU, tgt.DATA_REJESTRACJI=src.DATA_REJESTRACJI, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DATA_PRZYJECIA, DODATKOWY_EMAIL1, MASA_BRUTTO, NUMER_REFERENCYJNY_PRZESYLKI, PLACOWKA_PODMIOTU, PODPIS_ELEKTRONICZNY, STATUS, UC_DEKLARACJI, OF_ODBIORCA_ID, PG_ODBIORCA_ID, OF_PODM_DO_KONTAKTU_ID, PG_PODM_DO_KONTAKTU_ID, OF_PRZEDSTAWICIEL_ID, PG_PRZEDSTAWICIEL_ID, OF_SKLAD_DEKL_ID, PG_SKLAD_DEKL_ID, REFERENCJE_DO_ZT, PTW_MRZ, GAN_ID, UC_NADZORU, DATA_REJESTRACJI, version)
	VALUES (src.ID, src.DATA_PRZYJECIA, src.DODATKOWY_EMAIL1, src.MASA_BRUTTO, src.NUMER_REFERENCYJNY_PRZESYLKI, src.PLACOWKA_PODMIOTU, src.PODPIS_ELEKTRONICZNY, src.STATUS, src.UC_DEKLARACJI, src.OF_ODBIORCA_ID, src.PG_ODBIORCA_ID, src.OF_PODM_DO_KONTAKTU_ID, src.PG_PODM_DO_KONTAKTU_ID, src.OF_PRZEDSTAWICIEL_ID, src.PG_PRZEDSTAWICIEL_ID, src.OF_SKLAD_DEKL_ID, src.PG_SKLAD_DEKL_ID, src.REFERENCJE_DO_ZT, src.PTW_MRZ, src.GAN_ID, src.UC_NADZORU, src.DATA_REJESTRACJI, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_DOKUMENT_POPRZ' BEGIN
	MERGE INTO aimp2.ICS_DSK_DOKUMENT_POPRZ AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_DOKUMENT_POPRZ AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.KATEGORIA=src.KATEGORIA, tgt.KOD=src.KOD, tgt.NUMER=src.NUMER, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, KATEGORIA, KOD, NUMER, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.KATEGORIA, src.KOD, src.NUMER, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_DOKUMENT_POPRZ_POS' BEGIN
	MERGE INTO aimp2.ICS_DSK_DOKUMENT_POPRZ_POS AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_DOKUMENT_POPRZ_POS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_DOKUMENT_POPRZ=src.ICS_DSK_DOKUMENT_POPRZ, tgt.NUMER_POZYCJI=src.NUMER_POZYCJI, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_DOKUMENT_POPRZ, NUMER_POZYCJI, version)
	VALUES (src.ID, src.ICS_DSK_DOKUMENT_POPRZ, src.NUMER_POZYCJI, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_KONTENER' BEGIN
	MERGE INTO aimp2.ICS_DSK_KONTENER AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_KONTENER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.NUMER_KONTENERA=src.NUMER_KONTENERA, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, NUMER_KONTENERA, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.NUMER_KONTENERA, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_LOKALIZACJA' BEGIN
	MERGE INTO aimp2.ICS_DSK_LOKALIZACJA AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_LOKALIZACJA AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.KOD_MIEJSCA_LOKALIZACJI_TOW=src.KOD_MIEJSCA_LOKALIZACJI_TOW, tgt.KRAJ=src.KRAJ, tgt.KWALIFIKATOR_LOKALIZACJI=src.KWALIFIKATOR_LOKALIZACJI, tgt.OPIS_MIEJSCA_LOKALIZACJI_TOW=src.OPIS_MIEJSCA_LOKALIZACJI_TOW, tgt.TYP_LOKALIZACJI=src.TYP_LOKALIZACJI, tgt.DODATKOWY_IDENTYFIKATOR=src.DODATKOWY_IDENTYFIKATOR, tgt.goods_location_code=src.goods_location_code, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, KOD_MIEJSCA_LOKALIZACJI_TOW, KRAJ, KWALIFIKATOR_LOKALIZACJI, OPIS_MIEJSCA_LOKALIZACJI_TOW, TYP_LOKALIZACJI, DODATKOWY_IDENTYFIKATOR, goods_location_code, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.KOD_MIEJSCA_LOKALIZACJI_TOW, src.KRAJ, src.KWALIFIKATOR_LOKALIZACJI, src.OPIS_MIEJSCA_LOKALIZACJI_TOW, src.TYP_LOKALIZACJI, src.DODATKOWY_IDENTYFIKATOR, src.goods_location_code, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_LOKALIZACJA_ADRES' BEGIN
	MERGE INTO aimp2.ICS_DSK_LOKALIZACJA_ADRES AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_LOKALIZACJA_ADRES AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_LOKALIZACJA_ID=src.ICS_DSK_LOKALIZACJA_ID, tgt.KOD_POCZTOWY=src.KOD_POCZTOWY, tgt.KRAJ=src.KRAJ, tgt.MIEJSCOWOSC=src.MIEJSCOWOSC, tgt.ULICA_I_NR=src.ULICA_I_NR, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_LOKALIZACJA_ID, KOD_POCZTOWY, KRAJ, MIEJSCOWOSC, ULICA_I_NR, version)
	VALUES (src.ID, src.ICS_DSK_LOKALIZACJA_ID, src.KOD_POCZTOWY, src.KRAJ, src.MIEJSCOWOSC, src.ULICA_I_NR, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_NIESKUTECZNE_ZAB' BEGIN
	MERGE INTO aimp2.ICS_DSK_NIESKUTECZNE_ZAB AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_NIESKUTECZNE_ZAB AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.NR_POZYCJI=src.NR_POZYCJI, tgt.UZASADNIENIE=src.UZASADNIENIE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, NR_POZYCJI, UZASADNIENIE, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.NR_POZYCJI, src.UZASADNIENIE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_OPERACJA' BEGIN
	MERGE INTO aimp2.ICS_DSK_OPERACJA AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_OPERACJA AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.ADNOTACJA=src.ADNOTACJA, tgt.DATA=src.DATA, tgt.NAZWA=src.NAZWA, tgt.UWAGI=src.UWAGI, tgt.WYKONAL=src.WYKONAL, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, ADNOTACJA, DATA, NAZWA, UWAGI, WYKONAL, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.ADNOTACJA, src.DATA, src.NAZWA, src.UWAGI, src.WYKONAL, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_PODM_W_LANCUCHU' BEGIN
	MERGE INTO aimp2.ICS_DSK_PODM_W_LANCUCHU AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_PODM_W_LANCUCHU AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.ROLA=src.ROLA, tgt.IDENTYFIKATOR=src.IDENTYFIKATOR, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, ROLA, IDENTYFIKATOR, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.ROLA, src.IDENTYFIKATOR, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_POW_O_KONTROLI' BEGIN
	MERGE INTO aimp2.ICS_DSK_POW_O_KONTROLI AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_POW_O_KONTROLI AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.CZAS_KONTROLI=src.CZAS_KONTROLI, tgt.UWAGI=src.UWAGI, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, CZAS_KONTROLI, UWAGI, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.CZAS_KONTROLI, src.UWAGI, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TOWAR' BEGIN
	MERGE INTO aimp2.ICS_DSK_TOWAR AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TOWAR AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.ILOSC_TOWARU=src.ILOSC_TOWARU, tgt.JEDNOSTKA_MIARY=src.JEDNOSTKA_MIARY, tgt.KWOTA=src.KWOTA, tgt.NR_POZYCJI=src.NR_POZYCJI, tgt.NUMER_REFERENCYJNY_PRZESYLKI=src.NUMER_REFERENCYJNY_PRZESYLKI, tgt.STATUS_POZYCJI_DSK=src.STATUS_POZYCJI_DSK, tgt.TERMIN=src.TERMIN, tgt.OPIS_NIEPRAWIDL=src.OPIS_NIEPRAWIDL, tgt.ICS_ENS_ITEMS_ID=src.ICS_ENS_ITEMS_ID, tgt.OF_ODBIORCA_ID=src.OF_ODBIORCA_ID, tgt.PG_ODBIORCA_ID=src.PG_ODBIORCA_ID, tgt.MASA_BRUTTO=src.MASA_BRUTTO, tgt.MASA_NETTO=src.MASA_NETTO, tgt.OPIS_TOWARU=src.OPIS_TOWARU, tgt.UWAGI=src.UWAGI, tgt.REFERENCJE_DO_ZT=src.REFERENCJE_DO_ZT, tgt.WYNIK_KONTROLI=src.WYNIK_KONTROLI, tgt.PRZETERMINOWANY=src.PRZETERMINOWANY, tgt.ZABEZPIECZONO=src.ZABEZPIECZONO, tgt.KOD_CUS=src.KOD_CUS, tgt.KOD_TOWAROWY=src.KOD_TOWAROWY, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, ILOSC_TOWARU, JEDNOSTKA_MIARY, KWOTA, NR_POZYCJI, NUMER_REFERENCYJNY_PRZESYLKI, STATUS_POZYCJI_DSK, TERMIN, OPIS_NIEPRAWIDL, ICS_ENS_ITEMS_ID, OF_ODBIORCA_ID, PG_ODBIORCA_ID, MASA_BRUTTO, MASA_NETTO, OPIS_TOWARU, UWAGI, REFERENCJE_DO_ZT, WYNIK_KONTROLI, PRZETERMINOWANY, ZABEZPIECZONO, KOD_CUS, KOD_TOWAROWY, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.ILOSC_TOWARU, src.JEDNOSTKA_MIARY, src.KWOTA, src.NR_POZYCJI, src.NUMER_REFERENCYJNY_PRZESYLKI, src.STATUS_POZYCJI_DSK, src.TERMIN, src.OPIS_NIEPRAWIDL, src.ICS_ENS_ITEMS_ID, src.OF_ODBIORCA_ID, src.PG_ODBIORCA_ID, src.MASA_BRUTTO, src.MASA_NETTO, src.OPIS_TOWARU, src.UWAGI, src.REFERENCJE_DO_ZT, src.WYNIK_KONTROLI, src.PRZETERMINOWANY, src.ZABEZPIECZONO, src.KOD_CUS, src.KOD_TOWAROWY, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TOWAR_DOKUMENT_POPRZ' BEGIN
	MERGE INTO aimp2.ICS_DSK_TOWAR_DOKUMENT_POPRZ AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TOWAR_DOKUMENT_POPRZ AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_TOWAR_ID=src.ICS_DSK_TOWAR_ID, tgt.KATEGORIA=src.KATEGORIA, tgt.KOD=src.KOD, tgt.NR_POZYCJI=src.NR_POZYCJI, tgt.NUMER=src.NUMER, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_TOWAR_ID, KATEGORIA, KOD, NR_POZYCJI, NUMER, version)
	VALUES (src.ID, src.ICS_DSK_TOWAR_ID, src.KATEGORIA, src.KOD, src.NR_POZYCJI, src.NUMER, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TOWAR_DOKUMENT_WYMAG' BEGIN
	MERGE INTO aimp2.ICS_DSK_TOWAR_DOKUMENT_WYMAG AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TOWAR_DOKUMENT_WYMAG AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_TOWAR_ID=src.ICS_DSK_TOWAR_ID, tgt.KOD=src.KOD, tgt.NUMER=src.NUMER, tgt.UWAGI=src.UWAGI, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_TOWAR_ID, KOD, NUMER, UWAGI, version)
	VALUES (src.ID, src.ICS_DSK_TOWAR_ID, src.KOD, src.NUMER, src.UWAGI, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TOWAR_KONTENER' BEGIN
	MERGE INTO aimp2.ICS_DSK_TOWAR_KONTENER AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TOWAR_KONTENER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_TOWAR_ID=src.ICS_DSK_TOWAR_ID, tgt.NUMER_KONTENERA=src.NUMER_KONTENERA, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_TOWAR_ID, NUMER_KONTENERA, version)
	VALUES (src.ID, src.ICS_DSK_TOWAR_ID, src.NUMER_KONTENERA, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TOWAR_ODMOWA_SKLAD' BEGIN
	MERGE INTO aimp2.ICS_DSK_TOWAR_ODMOWA_SKLAD AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TOWAR_ODMOWA_SKLAD AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_TOWAR_ID=src.ICS_DSK_TOWAR_ID, tgt.OPIS_NIEPRAWIDLOWOSCI=src.OPIS_NIEPRAWIDLOWOSCI, tgt.UZASADNIENIE=src.UZASADNIENIE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_TOWAR_ID, OPIS_NIEPRAWIDLOWOSCI, UZASADNIENIE, version)
	VALUES (src.ID, src.ICS_DSK_TOWAR_ID, src.OPIS_NIEPRAWIDLOWOSCI, src.UZASADNIENIE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TOWAR_OPAKOWANIE' BEGIN
	MERGE INTO aimp2.ICS_DSK_TOWAR_OPAKOWANIE AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TOWAR_OPAKOWANIE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_TOWAR_ID=src.ICS_DSK_TOWAR_ID, tgt.LICZBA_OPAKOWAN=src.LICZBA_OPAKOWAN, tgt.NUMERY_I_ZNAKI_OPAKOWAN=src.NUMERY_I_ZNAKI_OPAKOWAN, tgt.RODZAJ_OPAKOWANIA=src.RODZAJ_OPAKOWANIA, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_TOWAR_ID, LICZBA_OPAKOWAN, NUMERY_I_ZNAKI_OPAKOWAN, RODZAJ_OPAKOWANIA, version)
	VALUES (src.ID, src.ICS_DSK_TOWAR_ID, src.LICZBA_OPAKOWAN, src.NUMERY_I_ZNAKI_OPAKOWAN, src.RODZAJ_OPAKOWANIA, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TOWAR_PODM_W_LANCUCHU' BEGIN
	MERGE INTO aimp2.ICS_DSK_TOWAR_PODM_W_LANCUCHU AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TOWAR_PODM_W_LANCUCHU AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_TOWAR_ID=src.ICS_DSK_TOWAR_ID, tgt.ROLA=src.ROLA, tgt.IDENTYFIKATOR=src.IDENTYFIKATOR, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_TOWAR_ID, ROLA, IDENTYFIKATOR, version)
	VALUES (src.ID, src.ICS_DSK_TOWAR_ID, src.ROLA, src.IDENTYFIKATOR, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TOWAR_WNIOSKOWANE_UNIE' BEGIN
	MERGE INTO aimp2.ICS_DSK_TOWAR_WNIOSKOWANE_UNIE AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TOWAR_WNIOSKOWANE_UNIE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_TOWAR_ID=src.ICS_DSK_TOWAR_ID, tgt.MRN=src.MRN, tgt.NR_POZYCJI=src.NR_POZYCJI, tgt.STATUS=src.STATUS, tgt.UZASADNIENIE=src.UZASADNIENIE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_TOWAR_ID, MRN, NR_POZYCJI, STATUS, UZASADNIENIE, version)
	VALUES (src.ID, src.ICS_DSK_TOWAR_ID, src.MRN, src.NR_POZYCJI, src.STATUS, src.UZASADNIENIE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_TRANSPORT' BEGIN
	MERGE INTO aimp2.ICS_DSK_TRANSPORT AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_TRANSPORT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.ZNAKI_SRODKA_TRANSPORTU=src.ZNAKI_SRODKA_TRANSPORTU, tgt.OZNACZENIE_SRODKA_TRANSPORTU=src.OZNACZENIE_SRODKA_TRANSPORTU, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, ZNAKI_SRODKA_TRANSPORTU, OZNACZENIE_SRODKA_TRANSPORTU, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.ZNAKI_SRODKA_TRANSPORTU, src.OZNACZENIE_SRODKA_TRANSPORTU, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_WSP_ADRES' BEGIN
	MERGE INTO aimp2.ICS_DSK_WSP_ADRES AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_WSP_ADRES AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.KOD_POCZTOWY=src.KOD_POCZTOWY, tgt.KRAJ=src.KRAJ, tgt.MIEJSCOWOSC=src.MIEJSCOWOSC, tgt.ULICA_NR=src.ULICA_NR, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, KOD_POCZTOWY, KRAJ, MIEJSCOWOSC, ULICA_NR, version)
	VALUES (src.ID, src.KOD_POCZTOWY, src.KRAJ, src.MIEJSCOWOSC, src.ULICA_NR, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_WSP_INFORMACJA_DOD' BEGIN
	MERGE INTO aimp2.ICS_DSK_WSP_INFORMACJA_DOD AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_WSP_INFORMACJA_DOD AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK=src.ICS_DSK, tgt.ICS_DSK_TOWAR_ID=src.ICS_DSK_TOWAR_ID, tgt.KOD=src.KOD, tgt.OPIS=src.OPIS, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK, ICS_DSK_TOWAR_ID, KOD, OPIS, version)
	VALUES (src.ID, src.ICS_DSK, src.ICS_DSK_TOWAR_ID, src.KOD, src.OPIS, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_WSP_OSOBA_FIZYCZNA' BEGIN
	MERGE INTO aimp2.ICS_DSK_WSP_OSOBA_FIZYCZNA AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_WSP_OSOBA_FIZYCZNA AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DSK_WSP_ADRES_ID=src.DSK_WSP_ADRES_ID, tgt.IMIE=src.IMIE, tgt.NAZWISKO=src.NAZWISKO, tgt.NR_IDENTYFIKACYJNY=src.NR_IDENTYFIKACYJNY, tgt.PESEL=src.PESEL, tgt.PLACOWKA=src.PLACOWKA, tgt.RODZAJ_PRZEDSTAWICIELSTWA=src.RODZAJ_PRZEDSTAWICIELSTWA, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DSK_WSP_ADRES_ID, IMIE, NAZWISKO, NR_IDENTYFIKACYJNY, PESEL, PLACOWKA, RODZAJ_PRZEDSTAWICIELSTWA, version)
	VALUES (src.ID, src.DSK_WSP_ADRES_ID, src.IMIE, src.NAZWISKO, src.NR_IDENTYFIKACYJNY, src.PESEL, src.PLACOWKA, src.RODZAJ_PRZEDSTAWICIELSTWA, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_WSP_PODMIOT_GOSP' BEGIN
	MERGE INTO aimp2.ICS_DSK_WSP_PODMIOT_GOSP AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_WSP_PODMIOT_GOSP AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DSK_WSP_ADRES_ID=src.DSK_WSP_ADRES_ID, tgt.EMAIL=src.EMAIL, tgt.EORI=src.EORI, tgt.NAZWA=src.NAZWA, tgt.REGON=src.REGON, tgt.TIN=src.TIN, tgt.PLACOWKA_PODMIOTU=src.PLACOWKA_PODMIOTU, tgt.RODZAJ_PRZEDSTAWICIELSTWA=src.RODZAJ_PRZEDSTAWICIELSTWA, tgt.AEO_CERTIFICATE_GROUP_ID=src.AEO_CERTIFICATE_GROUP_ID, tgt.NR_IDENTYFIKACYJNY=src.NR_IDENTYFIKACYJNY, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DSK_WSP_ADRES_ID, EMAIL, EORI, NAZWA, REGON, TIN, PLACOWKA_PODMIOTU, RODZAJ_PRZEDSTAWICIELSTWA, AEO_CERTIFICATE_GROUP_ID, NR_IDENTYFIKACYJNY, version)
	VALUES (src.ID, src.DSK_WSP_ADRES_ID, src.EMAIL, src.EORI, src.NAZWA, src.REGON, src.TIN, src.PLACOWKA_PODMIOTU, src.RODZAJ_PRZEDSTAWICIELSTWA, src.AEO_CERTIFICATE_GROUP_ID, src.NR_IDENTYFIKACYJNY, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_ZAMK_CELNE' BEGIN
	MERGE INTO aimp2.ICS_DSK_ZAMK_CELNE AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_ZAMK_CELNE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.ILOSC=src.ILOSC, tgt.RODZAJ=src.RODZAJ, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ID, ILOSC, RODZAJ, version)
	VALUES (src.ID, src.ICS_DSK_ID, src.ILOSC, src.RODZAJ, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_ZAMK_CELNE_NUMERY' BEGIN
	MERGE INTO aimp2.ICS_DSK_ZAMK_CELNE_NUMERY AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_ZAMK_CELNE_NUMERY AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ICS_DSK_ZAMK_CELNE_ID=src.ICS_DSK_ZAMK_CELNE_ID, tgt.NUMER=src.NUMER, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ICS_DSK_ZAMK_CELNE_ID, NUMER, version)
	VALUES (src.ID, src.ICS_DSK_ZAMK_CELNE_ID, src.NUMER, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_GAN_ZCP_CUST_DATA' BEGIN
	MERGE INTO aimp2.ICS_GAN_ZCP_CUST_DATA AS tgt
	USING WI_StageODS.aimp2.ICS_GAN_ZCP_CUST_DATA AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.GAN_CUST_DATA_DETL_ID=src.GAN_CUST_DATA_DETL_ID, tgt.UPO_IDENT_NUMBER=src.UPO_IDENT_NUMBER, tgt.STATUS=src.STATUS, tgt.ZCP_SELF_REF=src.ZCP_SELF_REF, tgt.REGI_DATE=src.REGI_DATE
	WHEN NOT MATCHED
	THEN INSERT (ID, GAN_CUST_DATA_DETL_ID, UPO_IDENT_NUMBER, STATUS, ZCP_SELF_REF, REGI_DATE)
	VALUES (src.ID, src.GAN_CUST_DATA_DETL_ID, src.UPO_IDENT_NUMBER, src.STATUS, src.ZCP_SELF_REF, src.REGI_DATE);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_GAN_ZCP_CUST_DATA_DETL' BEGIN
	MERGE INTO aimp2.ICS_GAN_ZCP_CUST_DATA_DETL AS tgt
	USING WI_StageODS.aimp2.ICS_GAN_ZCP_CUST_DATA_DETL AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.GAN_ZCP_CUST_DATA_ID=src.GAN_ZCP_CUST_DATA_ID, tgt.POSITION_NO=src.POSITION_NO
	WHEN NOT MATCHED
	THEN INSERT (ID, GAN_ZCP_CUST_DATA_ID, POSITION_NO)
	VALUES (src.ID, src.GAN_ZCP_CUST_DATA_ID, src.POSITION_NO);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_MESS' BEGIN
	MERGE INTO aimp2.ICS_MESS AS tgt
	USING WI_StageODS.aimp2.ICS_MESS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DESCRIPTION=src.DESCRIPTION, tgt.DIRECTION=src.DIRECTION, tgt.DOC_ID=src.DOC_ID, tgt.DOC_TIME=src.DOC_TIME, tgt.MIME_TYPE=src.MIME_TYPE, tgt.NAMESPACE=src.NAMESPACE, tgt.RECIPIENT=src.RECIPIENT, tgt.REF_NO=src.REF_NO, tgt.SELF_REF=src.SELF_REF, tgt.SENDER=src.SENDER, tgt.VERSION=src.VERSION, tgt.XML_NAME=src.XML_NAME, tgt.ATTACH_ID=src.ATTACH_ID, tgt.DECL_ID=src.DECL_ID, tgt.RESP_TO=src.RESP_TO, tgt.APP_TRANS_ID=src.APP_TRANS_ID, tgt.ARRIVE_ID=src.ARRIVE_ID, tgt.ARRIVE_DATE=src.ARRIVE_DATE, tgt.MANUAL=src.MANUAL, tgt.UNHANDLED=src.UNHANDLED, tgt.entity_id=src.entity_id, tgt.entity_id_agent=src.entity_id_agent, tgt.person_id_seap=src.person_id_seap, tgt.person_id_sisc=src.person_id_sisc, tgt.case_id=src.case_id, tgt.nadawca_email=src.nadawca_email, tgt.REJECTED=src.REJECTED, tgt.repository=src.repository, tgt.migration_time=src.migration_time, tgt.original_doc_id=src.original_doc_id, tgt.trad_com_system=src.trad_com_system, tgt.sender_recipient_agency=src.sender_recipient_agency
	WHEN NOT MATCHED
	THEN INSERT (ID, DESCRIPTION, DIRECTION, DOC_ID, DOC_TIME, MIME_TYPE, NAMESPACE, RECIPIENT, REF_NO, SELF_REF, SENDER, VERSION, XML_NAME, ATTACH_ID, DECL_ID, RESP_TO, APP_TRANS_ID, ARRIVE_ID, ARRIVE_DATE, MANUAL, UNHANDLED, entity_id, entity_id_agent, person_id_seap, person_id_sisc, case_id, nadawca_email, REJECTED, repository, migration_time, original_doc_id, trad_com_system, sender_recipient_agency)
	VALUES (src.ID, src.DESCRIPTION, src.DIRECTION, src.DOC_ID, src.DOC_TIME, src.MIME_TYPE, src.NAMESPACE, src.RECIPIENT, src.REF_NO, src.SELF_REF, src.SENDER, src.VERSION, src.XML_NAME, src.ATTACH_ID, src.DECL_ID, src.RESP_TO, src.APP_TRANS_ID, src.ARRIVE_ID, src.ARRIVE_DATE, src.MANUAL, src.UNHANDLED, src.entity_id, src.entity_id_agent, src.person_id_seap, src.person_id_sisc, src.case_id, src.nadawca_email, src.REJECTED, src.repository, src.migration_time, src.original_doc_id, src.trad_com_system, src.sender_recipient_agency);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_MESS_KANAL' BEGIN
	MERGE INTO aimp2.ICS_MESS_KANAL AS tgt
	USING WI_StageODS.aimp2.ICS_MESS_KANAL AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.MESS_ID=src.MESS_ID, tgt.KTYP=src.KTYP, tgt.KCHOICE=src.KCHOICE, tgt.VAL=src.VAL, tgt.VAL_ADD=src.VAL_ADD
	WHEN NOT MATCHED
	THEN INSERT (ID, MESS_ID, KTYP, KCHOICE, VAL, VAL_ADD)
	VALUES (src.ID, src.MESS_ID, src.KTYP, src.KCHOICE, src.VAL, src.VAL_ADD);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_OPER' BEGIN
	MERGE INTO aimp2.ICS_OPER AS tgt
	USING WI_StageODS.aimp2.ICS_OPER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ANNO=src.ANNO, tgt.CODE=src.CODE, tgt.OPER=src.OPER, tgt.TIME=src.TIME, tgt.DECL_ID=src.DECL_ID, tgt.ANNO_KIND=src.ANNO_KIND
	WHEN NOT MATCHED
	THEN INSERT (ID, ANNO, CODE, OPER, TIME, DECL_ID, ANNO_KIND)
	VALUES (src.ID, src.ANNO, src.CODE, src.OPER, src.TIME, src.DECL_ID, src.ANNO_KIND);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_OTHER' BEGIN
	MERGE INTO aimp2.ICS_OTHER AS tgt
	USING WI_StageODS.aimp2.ICS_OTHER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DEST_DATE=src.DEST_DATE, tgt.REGI_DATE=src.REGI_DATE, tgt.MEASURE_UNIT=src.MEASURE_UNIT, tgt.NUMBER_OF_PACKAGES=src.NUMBER_OF_PACKAGES, tgt.DESCRIPTION=src.DESCRIPTION, tgt.TYPE=src.TYPE, tgt.OTHER_STATE=src.OTHER_STATE, tgt.RETURN_DATE=src.RETURN_DATE, tgt.DECLARATION_CO=src.DECLARATION_CO, tgt.CURRENCY=src.CURRENCY, tgt.VALUE=src.VALUE, tgt.BE_CONSIGNEE_ID=src.BE_CONSIGNEE_ID, tgt.NP_CONSIGNEE_ID=src.NP_CONSIGNEE_ID, tgt.all_items_incl=src.all_items_incl, tgt.ACCEPTANCE_DATE=src.ACCEPTANCE_DATE, tgt.DOC_SELF_REF=src.DOC_SELF_REF, tgt.QUANTITY=src.QUANTITY, tgt.GROSS_WEIGHT=src.GROSS_WEIGHT
	WHEN NOT MATCHED
	THEN INSERT (ID, DEST_DATE, REGI_DATE, MEASURE_UNIT, NUMBER_OF_PACKAGES, DESCRIPTION, TYPE, OTHER_STATE, RETURN_DATE, DECLARATION_CO, CURRENCY, VALUE, BE_CONSIGNEE_ID, NP_CONSIGNEE_ID, all_items_incl, ACCEPTANCE_DATE, DOC_SELF_REF, QUANTITY, GROSS_WEIGHT)
	VALUES (src.ID, src.DEST_DATE, src.REGI_DATE, src.MEASURE_UNIT, src.NUMBER_OF_PACKAGES, src.DESCRIPTION, src.TYPE, src.OTHER_STATE, src.RETURN_DATE, src.DECLARATION_CO, src.CURRENCY, src.VALUE, src.BE_CONSIGNEE_ID, src.NP_CONSIGNEE_ID, src.all_items_incl, src.ACCEPTANCE_DATE, src.DOC_SELF_REF, src.QUANTITY, src.GROSS_WEIGHT);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_OTHER_ADDRESS' BEGIN
	MERGE INTO aimp2.ICS_OTHER_ADDRESS AS tgt
	USING WI_StageODS.aimp2.ICS_OTHER_ADDRESS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZIP_CODE=src.ZIP_CODE, tgt.COUNTRY=src.COUNTRY, tgt.CITY=src.CITY, tgt.STREET_AND_NO=src.STREET_AND_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZIP_CODE, COUNTRY, CITY, STREET_AND_NO, version)
	VALUES (src.ID, src.ZIP_CODE, src.COUNTRY, src.CITY, src.STREET_AND_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_OTHER_BUSINESS_ENTITY' BEGIN
	MERGE INTO aimp2.ICS_OTHER_BUSINESS_ENTITY AS tgt
	USING WI_StageODS.aimp2.ICS_OTHER_BUSINESS_ENTITY AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.EMAIL=src.EMAIL, tgt.EORI=src.EORI, tgt.IDENTIFIER=src.IDENTIFIER, tgt.NAME=src.NAME, tgt.REGON=src.REGON, tgt.TIN=src.TIN, tgt.OTHER_ADDRESS_ID=src.OTHER_ADDRESS_ID, tgt.AEO_CERTIFICATE_GROUP_ID=src.AEO_CERTIFICATE_GROUP_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, EMAIL, EORI, IDENTIFIER, NAME, REGON, TIN, OTHER_ADDRESS_ID, AEO_CERTIFICATE_GROUP_ID, version)
	VALUES (src.ID, src.EMAIL, src.EORI, src.IDENTIFIER, src.NAME, src.REGON, src.TIN, src.OTHER_ADDRESS_ID, src.AEO_CERTIFICATE_GROUP_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_OTHER_CUSTOM_DEST' BEGIN
	MERGE INTO aimp2.ICS_OTHER_CUSTOM_DEST AS tgt
	USING WI_StageODS.aimp2.ICS_OTHER_CUSTOM_DEST AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DATE=src.DATE, tgt.COMMENT=src.COMMENT, tgt.REF_NO=src.REF_NO, tgt.TYPE=src.TYPE, tgt.OTHER_ID=src.OTHER_ID, tgt.QUANTITY=src.QUANTITY, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DATE, COMMENT, REF_NO, TYPE, OTHER_ID, QUANTITY, version)
	VALUES (src.ID, src.DATE, src.COMMENT, src.REF_NO, src.TYPE, src.OTHER_ID, src.QUANTITY, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_OTHER_NATURAL_PERSON' BEGIN
	MERGE INTO aimp2.ICS_OTHER_NATURAL_PERSON AS tgt
	USING WI_StageODS.aimp2.ICS_OTHER_NATURAL_PERSON AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.IDENTIFIER=src.IDENTIFIER, tgt.NAME=src.NAME, tgt.SURNAME=src.SURNAME, tgt.ID_NO=src.ID_NO, tgt.PESEL=src.PESEL, tgt.OTHER_ADDRESS_ID=src.OTHER_ADDRESS_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, IDENTIFIER, NAME, SURNAME, ID_NO, PESEL, OTHER_ADDRESS_ID, version)
	VALUES (src.ID, src.IDENTIFIER, src.NAME, src.SURNAME, src.ID_NO, src.PESEL, src.OTHER_ADDRESS_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_PWD' BEGIN
	MERGE INTO aimp2.ICS_PWD AS tgt
	USING WI_StageODS.aimp2.ICS_PWD AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.cancellation_reason=src.cancellation_reason, tgt.tqsSent=src.tqsSent, tgt.czasDecyzjePrzywoz=src.czasDecyzjePrzywoz, tgt.jednCzasDecyzjePrzywoz=src.jednCzasDecyzjePrzywoz, tgt.czasPowPrzedPrzybyciem=src.czasPowPrzedPrzybyciem, tgt.jednCzasPowPrzedPrzybyciem=src.jednCzasPowPrzedPrzybyciem, tgt.ie25Pending=src.ie25Pending, tgt.uzpMaxDeliverDate=src.uzpMaxDeliverDate, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (id, cancellation_reason, tqsSent, czasDecyzjePrzywoz, jednCzasDecyzjePrzywoz, czasPowPrzedPrzybyciem, jednCzasPowPrzedPrzybyciem, ie25Pending, uzpMaxDeliverDate, version)
	VALUES (src.id, src.cancellation_reason, src.tqsSent, src.czasDecyzjePrzywoz, src.jednCzasDecyzjePrzywoz, src.czasPowPrzedPrzybyciem, src.jednCzasPowPrzedPrzybyciem, src.ie25Pending, src.uzpMaxDeliverDate, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_PWD_ITEM_ARR_DATA' BEGIN
	MERGE INTO aimp2.ICS_PWD_ITEM_ARR_DATA AS tgt
	USING WI_StageODS.aimp2.ICS_PWD_ITEM_ARR_DATA AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.CHK_DATE=src.CHK_DATE, tgt.REQUEST_ID=src.REQUEST_ID, tgt.ADD_QUANTITY=src.ADD_QUANTITY, tgt.QUANTITY_SUPPL_UNIT=src.QUANTITY_SUPPL_UNIT, tgt.PERMISSION_NO=src.PERMISSION_NO, tgt.DISCREPANCY_INFO=src.DISCREPANCY_INFO, tgt.AGRIM_VALID_TO=src.AGRIM_VALID_TO, tgt.PWD_ITEM=src.PWD_ITEM, tgt.QUANTITY=src.QUANTITY, tgt.QUANTITY_UNIT=src.QUANTITY_UNIT, tgt.QUANTITY_UNIT_QUALIFIER=src.QUANTITY_UNIT_QUALIFIER, tgt.QUANTITY_SUPPL_UNIT_QUALIFIER=src.QUANTITY_SUPPL_UNIT_QUALIFIER, tgt.BALANCE_STATUS=src.BALANCE_STATUS, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, CHK_DATE, REQUEST_ID, ADD_QUANTITY, QUANTITY_SUPPL_UNIT, PERMISSION_NO, DISCREPANCY_INFO, AGRIM_VALID_TO, PWD_ITEM, QUANTITY, QUANTITY_UNIT, QUANTITY_UNIT_QUALIFIER, QUANTITY_SUPPL_UNIT_QUALIFIER, BALANCE_STATUS, version)
	VALUES (src.ID, src.CHK_DATE, src.REQUEST_ID, src.ADD_QUANTITY, src.QUANTITY_SUPPL_UNIT, src.PERMISSION_NO, src.DISCREPANCY_INFO, src.AGRIM_VALID_TO, src.PWD_ITEM, src.QUANTITY, src.QUANTITY_UNIT, src.QUANTITY_UNIT_QUALIFIER, src.QUANTITY_SUPPL_UNIT_QUALIFIER, src.BALANCE_STATUS, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ics_pwd_item_irregularity' BEGIN
	MERGE INTO aimp2.ics_pwd_item_irregularity AS tgt
	USING WI_StageODS.aimp2.ics_pwd_item_irregularity AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.pwd_item=src.pwd_item, tgt.description=src.description, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (id, pwd_item, description, version)
	VALUES (src.id, src.pwd_item, src.description, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_PWD_PROCEDURE' BEGIN
	MERGE INTO aimp2.ICS_PWD_PROCEDURE AS tgt
	USING WI_StageODS.aimp2.ICS_PWD_PROCEDURE AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.pwd_id=src.pwd_id, tgt.code=src.code, tgt.prev_code=src.prev_code, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (id, pwd_id, code, prev_code, version)
	VALUES (src.id, src.pwd_id, src.code, src.prev_code, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_PWD_PROCEDURE_DETAIL' BEGIN
	MERGE INTO aimp2.ICS_PWD_PROCEDURE_DETAIL AS tgt
	USING WI_StageODS.aimp2.ICS_PWD_PROCEDURE_DETAIL AS src
	ON (tgt.procedure_id=src.procedure_id AND tgt.code=src.code)
	WHEN NOT MATCHED
	THEN INSERT (procedure_id, code)
	VALUES (src.procedure_id, src.code);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP' BEGIN
	MERGE INTO aimp2.ICS_ZCP AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.LEGAL_ANNOTATIONS=src.LEGAL_ANNOTATIONS, tgt.CALC_DATE=src.CALC_DATE, tgt.REJECT_DATE=src.REJECT_DATE, tgt.REGI_DATE=src.REGI_DATE, tgt.CANCEL_DATE=src.CANCEL_DATE, tgt.PREV_DOC_NR=src.PREV_DOC_NR, tgt.NUMB_FORMS=src.NUMB_FORMS, tgt.TOTAL_ITEM_VALUE=src.TOTAL_ITEM_VALUE, tgt.ADDITIONAL_DECL_TYPE=src.ADDITIONAL_DECL_TYPE, tgt.CONTAINERS=src.CONTAINERS, tgt.COUNTRY_OF_DESTINATION=src.COUNTRY_OF_DESTINATION, tgt.COUNTRY_OF_DESTINATION_REGION=src.COUNTRY_OF_DESTINATION_REGION, tgt.COUNTRY_OF_EXPORT=src.COUNTRY_OF_EXPORT, tgt.NUMBER_OF_PACKAGES=src.NUMBER_OF_PACKAGES, tgt.NO_OF_ITEMS=src.NO_OF_ITEMS, tgt.GROSS_MASS=src.GROSS_MASS, tgt.NO_OF_PERMISSION=src.NO_OF_PERMISSION, tgt.ZCP_SYSTEM_NUMBER=src.ZCP_SYSTEM_NUMBER, tgt.DEFERRED_PAYMENT=src.DEFERRED_PAYMENT, tgt.ELECTR_SIGNATURE=src.ELECTR_SIGNATURE, tgt.ZCP_STATE=src.ZCP_STATE, tgt.KIND_OF_DECLARATION=src.KIND_OF_DECLARATION, tgt.PRESENTATION_GOODS_CO=src.PRESENTATION_GOODS_CO, tgt.DECLARATION_CO=src.DECLARATION_CO, tgt.PRESENTATION_GOODS=src.PRESENTATION_GOODS, tgt.ICS_GAN_CUST_DATA_ID=src.ICS_GAN_CUST_DATA_ID, tgt.DPZ_POD=src.DPZ_POD, tgt.DPZ_POSTAL=src.DPZ_POSTAL, tgt.DPZ_PARCEL_NUM=src.DPZ_PARCEL_NUM, tgt.ACCEPTANCE_DATE=src.ACCEPTANCE_DATE, tgt.DPZ_CONS_RELEASE_DATE=src.DPZ_CONS_RELEASE_DATE, tgt.REGO_DATE=src.REGO_DATE, tgt.DPZ_REGO_MANNER=src.DPZ_REGO_MANNER, tgt.EMCS_STATUS=src.EMCS_STATUS, tgt.ZCP_DECL_TYPE=src.ZCP_DECL_TYPE, tgt.ACCEPTANCE_DATE_TIME=src.ACCEPTANCE_DATE_TIME, tgt.DPZ_RECEIVABLE_PROTECTION=src.DPZ_RECEIVABLE_PROTECTION, tgt.registry_num=src.registry_num, tgt.DPZ_CONTROL_RESULT=src.DPZ_CONTROL_RESULT, tgt.ZCP_UZP_CUT_OFF_DATE=src.ZCP_UZP_CUT_OFF_DATE, tgt.ZCP_VAT7=src.ZCP_VAT7, tgt.rectification_body=src.rectification_body, tgt.UZP_ID=src.UZP_ID, tgt.tqsVersion=src.tqsVersion, tgt.tqsSent=src.tqsSent, tgt.DPZ_RELEASE_DATE=src.DPZ_RELEASE_DATE, tgt.DPZ_RECEIVABLES=src.DPZ_RECEIVABLES, tgt.ZCP_DOC_SIGNER_ID=src.ZCP_DOC_SIGNER_ID, tgt.PARCEL_REFERENCE_NUMBER=src.PARCEL_REFERENCE_NUMBER, tgt.CURRENCY_CODE=src.CURRENCY_CODE, tgt.ENTRY_CO=src.ENTRY_CO, tgt.CONTROL_CO=src.CONTROL_CO, tgt.ZCP_ACF=src.ZCP_ACF, tgt.PRESENT_DATE=src.PRESENT_DATE, tgt.tqsSent2=src.tqsSent2, tgt.releasedInPresentationCo=src.releasedInPresentationCo, tgt.ZCP_VAT7_CLOSED_DATE=src.ZCP_VAT7_CLOSED_DATE, tgt.ZCP_VAT7_REF_DATE=src.ZCP_VAT7_REF_DATE, tgt.ZCP_VAT7_DEADLINE_DATE=src.ZCP_VAT7_DEADLINE_DATE, tgt.ZCP_UZP_PROC=src.ZCP_UZP_PROC, tgt.ZCP_VAT_BL_PROC=src.ZCP_VAT_BL_PROC, tgt.EMAIL_PERMIT_HOLDER_BONDED_WH=src.EMAIL_PERMIT_HOLDER_BONDED_WH, tgt.EMAIL_WAREHOUSE_TEMP_STORAGE=src.EMAIL_WAREHOUSE_TEMP_STORAGE, tgt.PDR_PARM_SUBM_TIME_SUPP_DECL=src.PDR_PARM_SUBM_TIME_SUPP_DECL, tgt.OSOZ_HAND_GUAR_SING=src.OSOZ_HAND_GUAR_SING, tgt.ISZTAR_RECEIVED=src.ISZTAR_RECEIVED, tgt.ISZTAR_CALLED=src.ISZTAR_CALLED, tgt.CALCD_RECEIVED=src.CALCD_RECEIVED, tgt.CALCD_CALLED=src.CALCD_CALLED
	WHEN NOT MATCHED
	THEN INSERT (ID, LEGAL_ANNOTATIONS, CALC_DATE, REJECT_DATE, REGI_DATE, CANCEL_DATE, PREV_DOC_NR, NUMB_FORMS, TOTAL_ITEM_VALUE, ADDITIONAL_DECL_TYPE, CONTAINERS, COUNTRY_OF_DESTINATION, COUNTRY_OF_DESTINATION_REGION, COUNTRY_OF_EXPORT, NUMBER_OF_PACKAGES, NO_OF_ITEMS, GROSS_MASS, NO_OF_PERMISSION, ZCP_SYSTEM_NUMBER, DEFERRED_PAYMENT, ELECTR_SIGNATURE, ZCP_STATE, KIND_OF_DECLARATION, PRESENTATION_GOODS_CO, DECLARATION_CO, PRESENTATION_GOODS, ICS_GAN_CUST_DATA_ID, DPZ_POD, DPZ_POSTAL, DPZ_PARCEL_NUM, ACCEPTANCE_DATE, DPZ_CONS_RELEASE_DATE, REGO_DATE, DPZ_REGO_MANNER, EMCS_STATUS, ZCP_DECL_TYPE, ACCEPTANCE_DATE_TIME, DPZ_RECEIVABLE_PROTECTION, registry_num, DPZ_CONTROL_RESULT, ZCP_UZP_CUT_OFF_DATE, ZCP_VAT7, rectification_body, UZP_ID, tqsVersion, tqsSent, DPZ_RELEASE_DATE, DPZ_RECEIVABLES, ZCP_DOC_SIGNER_ID, PARCEL_REFERENCE_NUMBER, CURRENCY_CODE, ENTRY_CO, CONTROL_CO, ZCP_ACF, PRESENT_DATE, tqsSent2, releasedInPresentationCo, ZCP_VAT7_CLOSED_DATE, ZCP_VAT7_REF_DATE, ZCP_VAT7_DEADLINE_DATE, ZCP_UZP_PROC, ZCP_VAT_BL_PROC, EMAIL_PERMIT_HOLDER_BONDED_WH, EMAIL_WAREHOUSE_TEMP_STORAGE, PDR_PARM_SUBM_TIME_SUPP_DECL, OSOZ_HAND_GUAR_SING, ISZTAR_RECEIVED, ISZTAR_CALLED, CALCD_RECEIVED, CALCD_CALLED)
	VALUES (src.ID, src.LEGAL_ANNOTATIONS, src.CALC_DATE, src.REJECT_DATE, src.REGI_DATE, src.CANCEL_DATE, src.PREV_DOC_NR, src.NUMB_FORMS, src.TOTAL_ITEM_VALUE, src.ADDITIONAL_DECL_TYPE, src.CONTAINERS, src.COUNTRY_OF_DESTINATION, src.COUNTRY_OF_DESTINATION_REGION, src.COUNTRY_OF_EXPORT, src.NUMBER_OF_PACKAGES, src.NO_OF_ITEMS, src.GROSS_MASS, src.NO_OF_PERMISSION, src.ZCP_SYSTEM_NUMBER, src.DEFERRED_PAYMENT, src.ELECTR_SIGNATURE, src.ZCP_STATE, src.KIND_OF_DECLARATION, src.PRESENTATION_GOODS_CO, src.DECLARATION_CO, src.PRESENTATION_GOODS, src.ICS_GAN_CUST_DATA_ID, src.DPZ_POD, src.DPZ_POSTAL, src.DPZ_PARCEL_NUM, src.ACCEPTANCE_DATE, src.DPZ_CONS_RELEASE_DATE, src.REGO_DATE, src.DPZ_REGO_MANNER, src.EMCS_STATUS, src.ZCP_DECL_TYPE, src.ACCEPTANCE_DATE_TIME, src.DPZ_RECEIVABLE_PROTECTION, src.registry_num, src.DPZ_CONTROL_RESULT, src.ZCP_UZP_CUT_OFF_DATE, src.ZCP_VAT7, src.rectification_body, src.UZP_ID, src.tqsVersion, src.tqsSent, src.DPZ_RELEASE_DATE, src.DPZ_RECEIVABLES, src.ZCP_DOC_SIGNER_ID, src.PARCEL_REFERENCE_NUMBER, src.CURRENCY_CODE, src.ENTRY_CO, src.CONTROL_CO, src.ZCP_ACF, src.PRESENT_DATE, src.tqsSent2, src.releasedInPresentationCo, src.ZCP_VAT7_CLOSED_DATE, src.ZCP_VAT7_REF_DATE, src.ZCP_VAT7_DEADLINE_DATE, src.ZCP_UZP_PROC, src.ZCP_VAT_BL_PROC, src.EMAIL_PERMIT_HOLDER_BONDED_WH, src.EMAIL_WAREHOUSE_TEMP_STORAGE, src.PDR_PARM_SUBM_TIME_SUPP_DECL, src.OSOZ_HAND_GUAR_SING, src.ISZTAR_RECEIVED, src.ISZTAR_CALLED, src.CALCD_RECEIVED, src.CALCD_CALLED);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ADDITIONAL_INFO' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ADDITIONAL_INFO AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ADDITIONAL_INFO AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CODE=src.CODE, tgt.DESCRIPTION=src.DESCRIPTION, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CODE, DESCRIPTION, version)
	VALUES (src.ID, src.ZCP_ID, src.CODE, src.DESCRIPTION, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ADDRESS' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ADDRESS AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ADDRESS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZIP_CODE=src.ZIP_CODE, tgt.COUNTRY=src.COUNTRY, tgt.CITY=src.CITY, tgt.STREET_AND_NO=src.STREET_AND_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZIP_CODE, COUNTRY, CITY, STREET_AND_NO, version)
	VALUES (src.ID, src.ZIP_CODE, src.COUNTRY, src.CITY, src.STREET_AND_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_BONDED_WAREHOUSE' BEGIN
	MERGE INTO aimp2.ICS_ZCP_BONDED_WAREHOUSE AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_BONDED_WAREHOUSE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.COUNTRY_OF_PERMISSION=src.COUNTRY_OF_PERMISSION, tgt.ID_NO=src.ID_NO, tgt.TYPE=src.TYPE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, COUNTRY_OF_PERMISSION, ID_NO, TYPE, version)
	VALUES (src.ID, src.ZCP_ID, src.COUNTRY_OF_PERMISSION, src.ID_NO, src.TYPE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_BUSINESS_ENTITY' BEGIN
	MERGE INTO aimp2.ICS_ZCP_BUSINESS_ENTITY AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_BUSINESS_ENTITY AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ADDRESS_ID=src.ZCP_ADDRESS_ID, tgt.ZCP_DOC_SIGNER_ID=src.ZCP_DOC_SIGNER_ID, tgt.EMAIL=src.EMAIL, tgt.EORI=src.EORI, tgt.IDENTIFIER=src.IDENTIFIER, tgt.NAME=src.NAME, tgt.REGON=src.REGON, tgt.TIN=src.TIN, tgt.BE_OUTPOST=src.BE_OUTPOST, tgt.REPRESENTATIVE_TYPE=src.REPRESENTATIVE_TYPE, tgt.AEO_CERTIFICATE_GROUP_ID=src.AEO_CERTIFICATE_GROUP_ID, tgt.CUSTOMER_TYPE=src.CUSTOMER_TYPE, tgt.DECL_ID=src.DECL_ID, tgt.ID_SISC=src.ID_SISC, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ADDRESS_ID, ZCP_DOC_SIGNER_ID, EMAIL, EORI, IDENTIFIER, NAME, REGON, TIN, BE_OUTPOST, REPRESENTATIVE_TYPE, AEO_CERTIFICATE_GROUP_ID, CUSTOMER_TYPE, DECL_ID, ID_SISC, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ADDRESS_ID, src.ZCP_DOC_SIGNER_ID, src.EMAIL, src.EORI, src.IDENTIFIER, src.NAME, src.REGON, src.TIN, src.BE_OUTPOST, src.REPRESENTATIVE_TYPE, src.AEO_CERTIFICATE_GROUP_ID, src.CUSTOMER_TYPE, src.DECL_ID, src.ID_SISC, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_BUSINESS_ENTITY_AI' BEGIN
	MERGE INTO aimp2.ICS_ZCP_BUSINESS_ENTITY_AI AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_BUSINESS_ENTITY_AI AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_BUSINESS_ENTITY_ID=src.ZCP_BUSINESS_ENTITY_ID, tgt.CODE=src.CODE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_BUSINESS_ENTITY_ID, CODE, version)
	VALUES (src.ID, src.ZCP_BUSINESS_ENTITY_ID, src.CODE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_CANCEL_REQUEST' BEGIN
	MERGE INTO aimp2.ICS_ZCP_CANCEL_REQUEST AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_CANCEL_REQUEST AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.MRN=src.MRN, tgt.ITEM_NO=src.ITEM_NO, tgt.STATE=src.STATE, tgt.REASON=src.REASON, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, MRN, ITEM_NO, STATE, REASON, version)
	VALUES (src.ID, src.ZCP_ID, src.MRN, src.ITEM_NO, src.STATE, src.REASON, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_CONTAINER' BEGIN
	MERGE INTO aimp2.ICS_ZCP_CONTAINER AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_CONTAINER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CONTAINER_NUMBER=src.CONTAINER_NUMBER, tgt.ZCP_CONTAINER_ACF=src.ZCP_CONTAINER_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CONTAINER_NUMBER, ZCP_CONTAINER_ACF, version)
	VALUES (src.ID, src.ZCP_ID, src.CONTAINER_NUMBER, src.ZCP_CONTAINER_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_CONTRACT' BEGIN
	MERGE INTO aimp2.ICS_ZCP_CONTRACT AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_CONTRACT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CONTR_DATE=src.CONTR_DATE, tgt.CONTR_NO=src.CONTR_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CONTR_DATE, CONTR_NO, version)
	VALUES (src.ID, src.ZCP_ID, src.CONTR_DATE, src.CONTR_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_CONTROL_CO' BEGIN
	MERGE INTO aimp2.ICS_ZCP_CONTROL_CO AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_CONTROL_CO AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CODE=src.CODE, tgt.NAME=src.NAME, tgt.ZCP_ADDRESS_ID=src.ZCP_ADDRESS_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CODE, NAME, ZCP_ADDRESS_ID, version)
	VALUES (src.ID, src.ZCP_ID, src.CODE, src.NAME, src.ZCP_ADDRESS_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_DECISION' BEGIN
	MERGE INTO aimp2.ICS_ZCP_DECISION AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_DECISION AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DEC_DATE=src.DEC_DATE, tgt.MRN=src.MRN, tgt.DEC_NO=src.DEC_NO, tgt.POS_NO=src.POS_NO, tgt.TYPE=src.TYPE, tgt.ZCP_OPERATION_ID=src.ZCP_OPERATION_ID, tgt.DECL_ID=src.DECL_ID, tgt.POSITIONS=src.POSITIONS, tgt.DESCRIPTION=src.DESCRIPTION, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DEC_DATE, MRN, DEC_NO, POS_NO, TYPE, ZCP_OPERATION_ID, DECL_ID, POSITIONS, DESCRIPTION, version)
	VALUES (src.ID, src.DEC_DATE, src.MRN, src.DEC_NO, src.POS_NO, src.TYPE, src.ZCP_OPERATION_ID, src.DECL_ID, src.POSITIONS, src.DESCRIPTION, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_DELIVERY_REQS' BEGIN
	MERGE INTO aimp2.ICS_ZCP_DELIVERY_REQS AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_DELIVERY_REQS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CODE=src.CODE, tgt.DESTINATION_CODE=src.DESTINATION_CODE, tgt.DESTINATION=src.DESTINATION, tgt.COUNTRY=src.COUNTRY, tgt.UNLOCODE=src.UNLOCODE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CODE, DESTINATION_CODE, DESTINATION, COUNTRY, UNLOCODE, version)
	VALUES (src.ID, src.ZCP_ID, src.CODE, src.DESTINATION_CODE, src.DESTINATION, src.COUNTRY, src.UNLOCODE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_DOC_SIGNER' BEGIN
	MERGE INTO aimp2.ICS_ZCP_DOC_SIGNER AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_DOC_SIGNER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.EMAIL=src.EMAIL, tgt.NAME=src.NAME, tgt.SURNAME=src.SURNAME, tgt.criminal_liab_cert=src.criminal_liab_cert, tgt.PHONE=src.PHONE, tgt.CUSTOMS_AGENT_ENTRY_DATE=src.CUSTOMS_AGENT_ENTRY_DATE, tgt.CUSTOMS_AGENT_ENTRY_NO=src.CUSTOMS_AGENT_ENTRY_NO, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, EMAIL, NAME, SURNAME, criminal_liab_cert, PHONE, CUSTOMS_AGENT_ENTRY_DATE, CUSTOMS_AGENT_ENTRY_NO, ZCP_ACF, version)
	VALUES (src.ID, src.EMAIL, src.NAME, src.SURNAME, src.criminal_liab_cert, src.PHONE, src.CUSTOMS_AGENT_ENTRY_DATE, src.CUSTOMS_AGENT_ENTRY_NO, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_DV1_INCREM_DEDUCTION' BEGIN
	MERGE INTO aimp2.ICS_ZCP_DV1_INCREM_DEDUCTION AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_DV1_INCREM_DEDUCTION AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.INCREM_DEDUCTION=src.INCREM_DEDUCTION, tgt.AMOUNT=src.AMOUNT, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, ZCP_ITEM_ID, INCREM_DEDUCTION, AMOUNT, version)
	VALUES (src.ID, src.ZCP_ID, src.ZCP_ITEM_ID, src.INCREM_DEDUCTION, src.AMOUNT, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_DV1_VALUATION_RATIOS' BEGIN
	MERGE INTO aimp2.ICS_ZCP_DV1_VALUATION_RATIOS AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_DV1_VALUATION_RATIOS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.USE_RESTRICTIONS=src.USE_RESTRICTIONS, tgt.BUYER_SELLER_CONNECT=src.BUYER_SELLER_CONNECT, tgt.SALE_PRICE_DEPEND=src.SALE_PRICE_DEPEND, tgt.SALE_IS_SUBJECT_TO_AGREEMENT=src.SALE_IS_SUBJECT_TO_AGREEMENT, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, ZCP_ITEM_ID, USE_RESTRICTIONS, BUYER_SELLER_CONNECT, SALE_PRICE_DEPEND, SALE_IS_SUBJECT_TO_AGREEMENT, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ID, src.ZCP_ITEM_ID, src.USE_RESTRICTIONS, src.BUYER_SELLER_CONNECT, src.SALE_PRICE_DEPEND, src.SALE_IS_SUBJECT_TO_AGREEMENT, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_EAD_INFO' BEGIN
	MERGE INTO aimp2.ICS_ZCP_EAD_INFO AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_EAD_INFO AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.REQ_DATE=src.REQ_DATE, tgt.REQ_LRN=src.REQ_LRN, tgt.RESULT_CODE=src.RESULT_CODE, tgt.RESULT_ADDITIONAL_INFO=src.RESULT_ADDITIONAL_INFO, tgt.ARC=src.ARC, tgt.DECL_ID=src.DECL_ID, tgt.EAD_REF=src.EAD_REF, tgt.OPERATION_STATUS=src.OPERATION_STATUS, tgt.POWIADOM_KOD=src.POWIADOM_KOD, tgt.OPERATION=src.OPERATION, tgt.CREATED_STAMP=src.CREATED_STAMP, tgt.RETRY_TIMES=src.RETRY_TIMES, tgt.FINAL_INCONS=src.FINAL_INCONS, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, REQ_DATE, REQ_LRN, RESULT_CODE, RESULT_ADDITIONAL_INFO, ARC, DECL_ID, EAD_REF, OPERATION_STATUS, POWIADOM_KOD, OPERATION, CREATED_STAMP, RETRY_TIMES, FINAL_INCONS, version)
	VALUES (src.ID, src.REQ_DATE, src.REQ_LRN, src.RESULT_CODE, src.RESULT_ADDITIONAL_INFO, src.ARC, src.DECL_ID, src.EAD_REF, src.OPERATION_STATUS, src.POWIADOM_KOD, src.OPERATION, src.CREATED_STAMP, src.RETRY_TIMES, src.FINAL_INCONS, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_EAD_INFO_ITEM' BEGIN
	MERGE INTO aimp2.ICS_ZCP_EAD_INFO_ITEM AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_EAD_INFO_ITEM AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.NUMBER=src.NUMBER, tgt.CN_CODE=src.CN_CODE, tgt.MASS_NETTO=src.MASS_NETTO, tgt.EAD_INFO_ID=src.EAD_INFO_ID, tgt.V_STATE=src.V_STATE, tgt.EMCS_TRYB=src.EMCS_TRYB, tgt.ITEM_NO=src.ITEM_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, NUMBER, CN_CODE, MASS_NETTO, EAD_INFO_ID, V_STATE, EMCS_TRYB, ITEM_NO, version)
	VALUES (src.ID, src.NUMBER, src.CN_CODE, src.MASS_NETTO, src.EAD_INFO_ID, src.V_STATE, src.EMCS_TRYB, src.ITEM_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ENTITY_ICD' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ENTITY_ICD AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ENTITY_ICD AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.ENTITY_ROLE=src.ENTITY_ROLE, tgt.ENTITY_ID=src.ENTITY_ID, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, ENTITY_ROLE, ENTITY_ID, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ID, src.ENTITY_ROLE, src.ENTITY_ID, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_GUARANT' BEGIN
	MERGE INTO aimp2.ICS_ZCP_GUARANT AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_GUARANT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.GRN=src.GRN, tgt.ZCP_ID=src.ZCP_ID, tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.OTHER_GUARANTEE_TYPE_CODE=src.OTHER_GUARANTEE_TYPE_CODE, tgt.ACCESS_CODE=src.ACCESS_CODE, tgt.AMOUNT=src.AMOUNT, tgt.TYPE=src.TYPE, tgt.TIN=src.TIN, tgt.AMOUNT_USED=src.AMOUNT_USED, tgt.DATE_USED=src.DATE_USED, tgt.ZCP_ACF=src.ZCP_ACF, tgt.SEND_TO_ZEFIR=src.SEND_TO_ZEFIR, tgt.AMOUNT_SENT_TO_ZEFIR=src.AMOUNT_SENT_TO_ZEFIR, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, GRN, ZCP_ID, ZCP_ITEM_ID, OTHER_GUARANTEE_TYPE_CODE, ACCESS_CODE, AMOUNT, TYPE, TIN, AMOUNT_USED, DATE_USED, ZCP_ACF, SEND_TO_ZEFIR, AMOUNT_SENT_TO_ZEFIR, version)
	VALUES (src.ID, src.GRN, src.ZCP_ID, src.ZCP_ITEM_ID, src.OTHER_GUARANTEE_TYPE_CODE, src.ACCESS_CODE, src.AMOUNT, src.TYPE, src.TIN, src.AMOUNT_USED, src.DATE_USED, src.ZCP_ACF, src.SEND_TO_ZEFIR, src.AMOUNT_SENT_TO_ZEFIR, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_INEFFECTIVE_GUARANT' BEGIN
	MERGE INTO aimp2.ICS_ZCP_INEFFECTIVE_GUARANT AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_INEFFECTIVE_GUARANT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.POS_NO=src.POS_NO, tgt.REASON=src.REASON, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, POS_NO, REASON, version)
	VALUES (src.ID, src.ZCP_ID, src.POS_NO, src.REASON, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.LEGAL_ANNOTATIONS=src.LEGAL_ANNOTATIONS, tgt.RELEASE_OF_GOODS_DATE=src.RELEASE_OF_GOODS_DATE, tgt.QUANTITY_SUPPL_UNIT=src.QUANTITY_SUPPL_UNIT, tgt.CN_CODE=src.CN_CODE, tgt.CUS_CODE=src.CUS_CODE, tgt.TARIC_CODE=src.TARIC_CODE, tgt.COUNTRY_OF_ORIGIN=src.COUNTRY_OF_ORIGIN, tgt.COUNTRY_OF_DESTINATION=src.COUNTRY_OF_DESTINATION, tgt.COUNTRY_OF_DESTINATION_REGION=src.COUNTRY_OF_DESTINATION_REGION, tgt.COUNTRY_OF_EXPORT=src.COUNTRY_OF_EXPORT, tgt.MEASURE_NO=src.MEASURE_NO, tgt.ITEM_NO=src.ITEM_NO, tgt.PARCEL_REFERENCE_NUMBER=src.PARCEL_REFERENCE_NUMBER, tgt.PREFERENCE_CODE=src.PREFERENCE_CODE, tgt.ZCP_ITEM_STATUS=src.ZCP_ITEM_STATUS, tgt.ARR_STATUS=src.ARR_STATUS, tgt.EMCS_STATUS=src.EMCS_STATUS, tgt.MEASURE_TYPE_CODE=src.MEASURE_TYPE_CODE, tgt.TRANS_TYPE=src.TRANS_TYPE, tgt.EMCS_CN_CODE=src.EMCS_CN_CODE, tgt.EMCS_NET_MASS=src.EMCS_NET_MASS, tgt.EMCS_ARC_NO=src.EMCS_ARC_NO, tgt.DESCR_OF_IRREGULARITY=src.DESCR_OF_IRREGULARITY, tgt.ICS_ENS_ITEMS_ID=src.ICS_ENS_ITEMS_ID, tgt.NP_SENDER_ID=src.NP_SENDER_ID, tgt.BE_SENDER_ID=src.BE_SENDER_ID, tgt.NP_RECEIVER_ID=src.NP_RECEIVER_ID, tgt.BE_RECEIVER_ID=src.BE_RECEIVER_ID, tgt.NP_CONTACT_ID=src.NP_CONTACT_ID, tgt.BE_CONTACT_ID=src.BE_CONTACT_ID, tgt.ITEM_DESCRIPTION=src.ITEM_DESCRIPTION, tgt.NOTES=src.NOTES, tgt.GROSS_MASS_KG=src.GROSS_MASS_KG, tgt.NET_MASS_KG=src.NET_MASS_KG, tgt.QUANTITY=src.QUANTITY, tgt.ICS_GAN_CUST_DATA_DETL_ID=src.ICS_GAN_CUST_DATA_DETL_ID, tgt.AGRIM=src.AGRIM, tgt.E_AD=src.E_AD, tgt.PAYMENT_DONE=src.PAYMENT_DONE, tgt.NP_SELLER_ID=src.NP_SELLER_ID, tgt.BE_SELLER_ID=src.BE_SELLER_ID, tgt.BE_BUYER_ID=src.BE_BUYER_ID, tgt.NP_BUYER_ID=src.NP_BUYER_ID, tgt.CONTINUE_PROCESSING=src.CONTINUE_PROCESSING, tgt.VERIF_RESULT=src.VERIF_RESULT, tgt.NET_MASS_REAL=src.NET_MASS_REAL, tgt.CN_CODE_REAL=src.CN_CODE_REAL, tgt.DPZ_STRATEGIC=src.DPZ_STRATEGIC, tgt.PROCEDURE_PREVIOUS=src.PROCEDURE_PREVIOUS, tgt.PROCEDURE_REQUESTED=src.PROCEDURE_REQUESTED, tgt.GUARANT_DONE=src.GUARANT_DONE, tgt.ITEMS_VALUE=src.ITEMS_VALUE, tgt.RS_DATE=src.RS_DATE, tgt.RS_BASE=src.RS_BASE, tgt.RS_TYPE=src.RS_TYPE, tgt.ARR_SALDO=src.ARR_SALDO, tgt.SENT_TO_OSOZ_STATUS=src.SENT_TO_OSOZ_STATUS, tgt.SENT_TO_ZEFIR_STATUS=src.SENT_TO_ZEFIR_STATUS, tgt.INVA_REASON=src.INVA_REASON, tgt.DEL_BY_ADM_ID=src.DEL_BY_ADM_ID, tgt.INVA_MANU=src.INVA_MANU, tgt.INVA_REJ_REASON=src.INVA_REJ_REASON, tgt.VAT7_CLOSED=src.VAT7_CLOSED, tgt.INVA_SELF_REF=src.INVA_SELF_REF, tgt.NULL_PAYMENT_DONE=src.NULL_PAYMENT_DONE, tgt.UZP_ID=src.UZP_ID, tgt.SENT_ZC272=src.SENT_ZC272, tgt.PZC=src.PZC, tgt.tqsRejectedIn=src.tqsRejectedIn, tgt.EMCS_TRYB=src.EMCS_TRYB, tgt.STOP_WAITING_EMCS=src.STOP_WAITING_EMCS, tgt.CALC_DATE1=src.CALC_DATE1, tgt.CALC_DATE2=src.CALC_DATE2, tgt.CURRENCY_CODE=src.CURRENCY_CODE, tgt.VAT7_ADMINISTRATIVE_DECISION=src.VAT7_ADMINISTRATIVE_DECISION, tgt.VAT7_SETTLEMENT_DATE=src.VAT7_SETTLEMENT_DATE, tgt.OP_COUNTRY_CODE=src.OP_COUNTRY_CODE, tgt.ITEM_CODE=src.ITEM_CODE, tgt.INVA_DATE=src.INVA_DATE, tgt.ZEFIR_RECT_COUNTER=src.ZEFIR_RECT_COUNTER, tgt.CONSIGNEE_ID_BE_VALID_SC=src.CONSIGNEE_ID_BE_VALID_SC, tgt.ZCP_ITEM_ACF=src.ZCP_ITEM_ACF, tgt.CRX_VAL_RES=src.CRX_VAL_RES, tgt.ALL_GUARANT_PAYMENT_DONE=src.ALL_GUARANT_PAYMENT_DONE, tgt.ISZTAR_RECEIVED=src.ISZTAR_RECEIVED, tgt.EMCS_LRN=src.EMCS_LRN, tgt.PAY_REGISTRATION_ANNOTATION=src.PAY_REGISTRATION_ANNOTATION, tgt.RELEASED_IN_OSOZ=src.RELEASED_IN_OSOZ, tgt.PAYMENT_D_DONE=src.PAYMENT_D_DONE, tgt.version=src.version, tgt.TEMPORARY_DUTY=src.TEMPORARY_DUTY, tgt.FINAL_DUTY=src.FINAL_DUTY, tgt.EMCS_POWIADOM=src.EMCS_POWIADOM, tgt.EMCS_NUMER=src.EMCS_NUMER
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, LEGAL_ANNOTATIONS, RELEASE_OF_GOODS_DATE, QUANTITY_SUPPL_UNIT, CN_CODE, CUS_CODE, TARIC_CODE, COUNTRY_OF_ORIGIN, COUNTRY_OF_DESTINATION, COUNTRY_OF_DESTINATION_REGION, COUNTRY_OF_EXPORT, MEASURE_NO, ITEM_NO, PARCEL_REFERENCE_NUMBER, PREFERENCE_CODE, ZCP_ITEM_STATUS, ARR_STATUS, EMCS_STATUS, MEASURE_TYPE_CODE, TRANS_TYPE, EMCS_CN_CODE, EMCS_NET_MASS, EMCS_ARC_NO, DESCR_OF_IRREGULARITY, ICS_ENS_ITEMS_ID, NP_SENDER_ID, BE_SENDER_ID, NP_RECEIVER_ID, BE_RECEIVER_ID, NP_CONTACT_ID, BE_CONTACT_ID, ITEM_DESCRIPTION, NOTES, GROSS_MASS_KG, NET_MASS_KG, QUANTITY, ICS_GAN_CUST_DATA_DETL_ID, AGRIM, E_AD, PAYMENT_DONE, NP_SELLER_ID, BE_SELLER_ID, BE_BUYER_ID, NP_BUYER_ID, CONTINUE_PROCESSING, VERIF_RESULT, NET_MASS_REAL, CN_CODE_REAL, DPZ_STRATEGIC, PROCEDURE_PREVIOUS, PROCEDURE_REQUESTED, GUARANT_DONE, ITEMS_VALUE, RS_DATE, RS_BASE, RS_TYPE, ARR_SALDO, SENT_TO_OSOZ_STATUS, SENT_TO_ZEFIR_STATUS, INVA_REASON, DEL_BY_ADM_ID, INVA_MANU, INVA_REJ_REASON, VAT7_CLOSED, INVA_SELF_REF, NULL_PAYMENT_DONE, UZP_ID, SENT_ZC272, PZC, tqsRejectedIn, EMCS_TRYB, STOP_WAITING_EMCS, CALC_DATE1, CALC_DATE2, CURRENCY_CODE, VAT7_ADMINISTRATIVE_DECISION, VAT7_SETTLEMENT_DATE, OP_COUNTRY_CODE, ITEM_CODE, INVA_DATE, ZEFIR_RECT_COUNTER, CONSIGNEE_ID_BE_VALID_SC, ZCP_ITEM_ACF, CRX_VAL_RES, ALL_GUARANT_PAYMENT_DONE, ISZTAR_RECEIVED, EMCS_LRN, PAY_REGISTRATION_ANNOTATION, RELEASED_IN_OSOZ, PAYMENT_D_DONE, version, TEMPORARY_DUTY, FINAL_DUTY, EMCS_POWIADOM, EMCS_NUMER)
	VALUES (src.ID, src.ZCP_ID, src.LEGAL_ANNOTATIONS, src.RELEASE_OF_GOODS_DATE, src.QUANTITY_SUPPL_UNIT, src.CN_CODE, src.CUS_CODE, src.TARIC_CODE, src.COUNTRY_OF_ORIGIN, src.COUNTRY_OF_DESTINATION, src.COUNTRY_OF_DESTINATION_REGION, src.COUNTRY_OF_EXPORT, src.MEASURE_NO, src.ITEM_NO, src.PARCEL_REFERENCE_NUMBER, src.PREFERENCE_CODE, src.ZCP_ITEM_STATUS, src.ARR_STATUS, src.EMCS_STATUS, src.MEASURE_TYPE_CODE, src.TRANS_TYPE, src.EMCS_CN_CODE, src.EMCS_NET_MASS, src.EMCS_ARC_NO, src.DESCR_OF_IRREGULARITY, src.ICS_ENS_ITEMS_ID, src.NP_SENDER_ID, src.BE_SENDER_ID, src.NP_RECEIVER_ID, src.BE_RECEIVER_ID, src.NP_CONTACT_ID, src.BE_CONTACT_ID, src.ITEM_DESCRIPTION, src.NOTES, src.GROSS_MASS_KG, src.NET_MASS_KG, src.QUANTITY, src.ICS_GAN_CUST_DATA_DETL_ID, src.AGRIM, src.E_AD, src.PAYMENT_DONE, src.NP_SELLER_ID, src.BE_SELLER_ID, src.BE_BUYER_ID, src.NP_BUYER_ID, src.CONTINUE_PROCESSING, src.VERIF_RESULT, src.NET_MASS_REAL, src.CN_CODE_REAL, src.DPZ_STRATEGIC, src.PROCEDURE_PREVIOUS, src.PROCEDURE_REQUESTED, src.GUARANT_DONE, src.ITEMS_VALUE, src.RS_DATE, src.RS_BASE, src.RS_TYPE, src.ARR_SALDO, src.SENT_TO_OSOZ_STATUS, src.SENT_TO_ZEFIR_STATUS, src.INVA_REASON, src.DEL_BY_ADM_ID, src.INVA_MANU, src.INVA_REJ_REASON, src.VAT7_CLOSED, src.INVA_SELF_REF, src.NULL_PAYMENT_DONE, src.UZP_ID, src.SENT_ZC272, src.PZC, src.tqsRejectedIn, src.EMCS_TRYB, src.STOP_WAITING_EMCS, src.CALC_DATE1, src.CALC_DATE2, src.CURRENCY_CODE, src.VAT7_ADMINISTRATIVE_DECISION, src.VAT7_SETTLEMENT_DATE, src.OP_COUNTRY_CODE, src.ITEM_CODE, src.INVA_DATE, src.ZEFIR_RECT_COUNTER, src.CONSIGNEE_ID_BE_VALID_SC, src.ZCP_ITEM_ACF, src.CRX_VAL_RES, src.ALL_GUARANT_PAYMENT_DONE, src.ISZTAR_RECEIVED, src.EMCS_LRN, src.PAY_REGISTRATION_ANNOTATION, src.RELEASED_IN_OSOZ, src.PAYMENT_D_DONE, src.version, src.TEMPORARY_DUTY, src.FINAL_DUTY, src.EMCS_POWIADOM, src.EMCS_NUMER);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_ADD_INFO' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_ADD_INFO AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_ADD_INFO AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.CODE=src.CODE, tgt.DESCRIPTION=src.DESCRIPTION, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, CODE, DESCRIPTION, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.CODE, src.DESCRIPTION, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_ARR_DATA' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_ARR_DATA AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_ARR_DATA AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.CHK_DATE=src.CHK_DATE, tgt.REQUEST_ID=src.REQUEST_ID, tgt.ADD_QUANTITY=src.ADD_QUANTITY, tgt.QUANTITY_SUPPL_UNIT=src.QUANTITY_SUPPL_UNIT, tgt.PERMISSION_NO=src.PERMISSION_NO, tgt.DISCREPANCY_INFO=src.DISCREPANCY_INFO, tgt.AGRIM_VALID_TO=src.AGRIM_VALID_TO, tgt.ZCP_ITEM_TARIC_QUANTITY_ID=src.ZCP_ITEM_TARIC_QUANTITY_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, CHK_DATE, REQUEST_ID, ADD_QUANTITY, QUANTITY_SUPPL_UNIT, PERMISSION_NO, DISCREPANCY_INFO, AGRIM_VALID_TO, ZCP_ITEM_TARIC_QUANTITY_ID, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.CHK_DATE, src.REQUEST_ID, src.ADD_QUANTITY, src.QUANTITY_SUPPL_UNIT, src.PERMISSION_NO, src.DISCREPANCY_INFO, src.AGRIM_VALID_TO, src.ZCP_ITEM_TARIC_QUANTITY_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_CONTAINER' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_CONTAINER AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_CONTAINER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.CONTAINER_NUMBER=src.CONTAINER_NUMBER, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, CONTAINER_NUMBER, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.CONTAINER_NUMBER, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_CONTRACT' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_CONTRACT AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_CONTRACT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.CONTR_DATE=src.CONTR_DATE, tgt.CONTR_NO=src.CONTR_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, CONTR_DATE, CONTR_NO, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.CONTR_DATE, src.CONTR_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_CUSTOM_DEST' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_CUSTOM_DEST AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_CUSTOM_DEST AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.NAME=src.NAME, tgt.DOCUMENT_NO=src.DOCUMENT_NO, tgt.DATE=src.DATE, tgt.QUANTITY=src.QUANTITY, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, NAME, DOCUMENT_NO, DATE, QUANTITY, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.NAME, src.DOCUMENT_NO, src.DATE, src.QUANTITY, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_ENTITY_ICD' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_ENTITY_ICD AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_ENTITY_ICD AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.ENTITY_ID=src.ENTITY_ID, tgt.ENTITY_ROLE=src.ENTITY_ROLE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, ENTITY_ID, ENTITY_ROLE, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.ENTITY_ID, src.ENTITY_ROLE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_OSOZ2_GUARANTEE' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_OSOZ2_GUARANTEE AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_OSOZ2_GUARANTEE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.AMOUNT=src.AMOUNT, tgt.OPERATION_NO=src.OPERATION_NO, tgt.USE_DATE=src.USE_DATE, tgt.RELIEF_BALANCE=src.RELIEF_BALANCE, tgt.RELIEF_DATE=src.RELIEF_DATE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, AMOUNT, OPERATION_NO, USE_DATE, RELIEF_BALANCE, RELIEF_DATE, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.AMOUNT, src.OPERATION_NO, src.USE_DATE, src.RELIEF_BALANCE, src.RELIEF_DATE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_PACK' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_PACK AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_PACK AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.PACK_QUANTITY=src.PACK_QUANTITY, tgt.PACK_NUMBER_SIGN=src.PACK_NUMBER_SIGN, tgt.PACK_TYPE=src.PACK_TYPE, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, PACK_QUANTITY, PACK_NUMBER_SIGN, PACK_TYPE, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.PACK_QUANTITY, src.PACK_NUMBER_SIGN, src.PACK_TYPE, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_PAYMENT' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_PAYMENT AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_PAYMENT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.DEBT_NOTIFICATION_DATE=src.DEBT_NOTIFICATION_DATE, tgt.DEBT_ACQUAINTED_DATE=src.DEBT_ACQUAINTED_DATE, tgt.AMOUNT=src.AMOUNT, tgt.AMOUNT_TO_GUARANTEE=src.AMOUNT_TO_GUARANTEE, tgt.IS_AMOUNT_GUARANTEED=src.IS_AMOUNT_GUARANTEED, tgt.PAYMENT_METHOD=src.PAYMENT_METHOD, tgt.BASE=src.BASE, tgt.RATE=src.RATE, tgt.TYPE=src.TYPE, tgt.ICS_ZCP_ITEM_PODZ_ID=src.ICS_ZCP_ITEM_PODZ_ID, tgt.ROW_STYLE=src.ROW_STYLE, tgt.AMOUNT_PAID=src.AMOUNT_PAID, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, DEBT_NOTIFICATION_DATE, DEBT_ACQUAINTED_DATE, AMOUNT, AMOUNT_TO_GUARANTEE, IS_AMOUNT_GUARANTEED, PAYMENT_METHOD, BASE, RATE, TYPE, ICS_ZCP_ITEM_PODZ_ID, ROW_STYLE, AMOUNT_PAID, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.DEBT_NOTIFICATION_DATE, src.DEBT_ACQUAINTED_DATE, src.AMOUNT, src.AMOUNT_TO_GUARANTEE, src.IS_AMOUNT_GUARANTEED, src.PAYMENT_METHOD, src.BASE, src.RATE, src.TYPE, src.ICS_ZCP_ITEM_PODZ_ID, src.ROW_STYLE, src.AMOUNT_PAID, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_PODZ' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_PODZ AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_PODZ AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.MRN=src.MRN, tgt.PODZ_NO=src.PODZ_NO, tgt.PROPRIETARY_PODZ_NO=src.PROPRIETARY_PODZ_NO, tgt.STATUS=src.STATUS, tgt.AMOUNT=src.AMOUNT, tgt.COMMENTS=src.COMMENTS, tgt.GRN=src.GRN, tgt.G_OTHER_TYPE_CODE=src.G_OTHER_TYPE_CODE, tgt.TIN=src.TIN, tgt.G_ACCESS_CODE=src.G_ACCESS_CODE, tgt.SENT_TO_OSOZ_STATUS=src.SENT_TO_OSOZ_STATUS, tgt.SENT_TO_ZEFIR_STATUS=src.SENT_TO_ZEFIR_STATUS, tgt.QUOTA_ID=src.QUOTA_ID, tgt.SENT_ZC272=src.SENT_ZC272, tgt.AMOUNT_USED=src.AMOUNT_USED, tgt.DATE_USED=src.DATE_USED, tgt.SEND_TO_ZEFIR=src.SEND_TO_ZEFIR, tgt.NEXT_PODZ_NO=src.NEXT_PODZ_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, MRN, PODZ_NO, PROPRIETARY_PODZ_NO, STATUS, AMOUNT, COMMENTS, GRN, G_OTHER_TYPE_CODE, TIN, G_ACCESS_CODE, SENT_TO_OSOZ_STATUS, SENT_TO_ZEFIR_STATUS, QUOTA_ID, SENT_ZC272, AMOUNT_USED, DATE_USED, SEND_TO_ZEFIR, NEXT_PODZ_NO, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.MRN, src.PODZ_NO, src.PROPRIETARY_PODZ_NO, src.STATUS, src.AMOUNT, src.COMMENTS, src.GRN, src.G_OTHER_TYPE_CODE, src.TIN, src.G_ACCESS_CODE, src.SENT_TO_OSOZ_STATUS, src.SENT_TO_ZEFIR_STATUS, src.QUOTA_ID, src.SENT_ZC272, src.AMOUNT_USED, src.DATE_USED, src.SEND_TO_ZEFIR, src.NEXT_PODZ_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_POSTAGE' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_POSTAGE AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_POSTAGE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.CURRENCY_CODE=src.CURRENCY_CODE, tgt.AMOUNT=src.AMOUNT, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, CURRENCY_CODE, AMOUNT, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.CURRENCY_CODE, src.AMOUNT, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_POSTAL_VALUE' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_POSTAL_VALUE AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_POSTAL_VALUE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.CURRENCY_CODE=src.CURRENCY_CODE, tgt.VALUE=src.VALUE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, CURRENCY_CODE, VALUE, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.CURRENCY_CODE, src.VALUE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_PREV_DOC' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_PREV_DOC AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_PREV_DOC AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.CATEGORY=src.CATEGORY, tgt.CODE=src.CODE, tgt.NUMBER=src.NUMBER, tgt.PREV_DOC_NO=src.PREV_DOC_NO, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, CATEGORY, CODE, NUMBER, PREV_DOC_NO, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.CATEGORY, src.CODE, src.NUMBER, src.PREV_DOC_NO, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_PREV_DOC_POS' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_PREV_DOC_POS AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_PREV_DOC_POS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_PREV_DOC_ID=src.ZCP_ITEM_PREV_DOC_ID, tgt.PREV_DOC_NO=src.PREV_DOC_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_PREV_DOC_ID, PREV_DOC_NO, version)
	VALUES (src.ID, src.ZCP_ITEM_PREV_DOC_ID, src.PREV_DOC_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_PROCEDURE_DETAILS' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_PROCEDURE_DETAILS AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_PROCEDURE_DETAILS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.CODE=src.CODE, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, CODE, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.CODE, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_QUOTA' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_QUOTA AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_QUOTA AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.APPLIED_QUANTITY_UNIT=src.APPLIED_QUANTITY_UNIT, tgt.QUALIFIER_OF_UNIT=src.QUALIFIER_OF_UNIT, tgt.QUOTA_NO=src.QUOTA_NO, tgt.STATUS=src.STATUS, tgt.TYPE=src.TYPE, tgt.APPLIED_QUOTA_QUANTITY=src.APPLIED_QUOTA_QUANTITY, tgt.POS_ID=src.POS_ID, tgt.ZCP_ITEM_QUOTA_DEF_ID=src.ZCP_ITEM_QUOTA_DEF_ID, tgt.VERIFICATION_STATUS=src.VERIFICATION_STATUS, tgt.sent_to_tqs=src.sent_to_tqs, tgt.VERIFICATION_STATUS_SEC=src.VERIFICATION_STATUS_SEC, tgt.retro=src.retro, tgt.QUOTA_GRANTED_DESCR=src.QUOTA_GRANTED_DESCR, tgt.ZCP_ACF=src.ZCP_ACF, tgt.TQ1_STATUS=src.TQ1_STATUS, tgt.PREFERENCES=src.PREFERENCES, tgt.GRANTED_QUOTA_QUANTITY=src.GRANTED_QUOTA_QUANTITY, tgt.TARIFF_PROCESSED=src.TARIFF_PROCESSED, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, APPLIED_QUANTITY_UNIT, QUALIFIER_OF_UNIT, QUOTA_NO, STATUS, TYPE, APPLIED_QUOTA_QUANTITY, POS_ID, ZCP_ITEM_QUOTA_DEF_ID, VERIFICATION_STATUS, sent_to_tqs, VERIFICATION_STATUS_SEC, retro, QUOTA_GRANTED_DESCR, ZCP_ACF, TQ1_STATUS, PREFERENCES, GRANTED_QUOTA_QUANTITY, TARIFF_PROCESSED, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.APPLIED_QUANTITY_UNIT, src.QUALIFIER_OF_UNIT, src.QUOTA_NO, src.STATUS, src.TYPE, src.APPLIED_QUOTA_QUANTITY, src.POS_ID, src.ZCP_ITEM_QUOTA_DEF_ID, src.VERIFICATION_STATUS, src.sent_to_tqs, src.VERIFICATION_STATUS_SEC, src.retro, src.QUOTA_GRANTED_DESCR, src.ZCP_ACF, src.TQ1_STATUS, src.PREFERENCES, src.GRANTED_QUOTA_QUANTITY, src.TARIFF_PROCESSED, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_QUOTA_DEF' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_QUOTA_DEF AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_QUOTA_DEF AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DATE_OF_UPDATE=src.DATE_OF_UPDATE, tgt.UNIT=src.UNIT, tgt.QUALIFIER_OF_UNIT=src.QUALIFIER_OF_UNIT, tgt.CURRENCY=src.CURRENCY, tgt.ITEM_NO=src.ITEM_NO, tgt.BALANCE=src.BALANCE, tgt.IS_CRITICAL_STATE=src.IS_CRITICAL_STATE, tgt.CRITICAL_STATE_THRESHOLD=src.CRITICAL_STATE_THRESHOLD, tgt.INITIAL_AMOUNT=src.INITIAL_AMOUNT, tgt.VALID_FROM=src.VALID_FROM, tgt.VALID_TO=src.VALID_TO, tgt.IS_BLOCKED=src.IS_BLOCKED, tgt.BLOCKED_FROM=src.BLOCKED_FROM, tgt.BLOCKED_TO=src.BLOCKED_TO, tgt.IS_EXHAUSED=src.IS_EXHAUSED, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DATE_OF_UPDATE, UNIT, QUALIFIER_OF_UNIT, CURRENCY, ITEM_NO, BALANCE, IS_CRITICAL_STATE, CRITICAL_STATE_THRESHOLD, INITIAL_AMOUNT, VALID_FROM, VALID_TO, IS_BLOCKED, BLOCKED_FROM, BLOCKED_TO, IS_EXHAUSED, version)
	VALUES (src.ID, src.DATE_OF_UPDATE, src.UNIT, src.QUALIFIER_OF_UNIT, src.CURRENCY, src.ITEM_NO, src.BALANCE, src.IS_CRITICAL_STATE, src.CRITICAL_STATE_THRESHOLD, src.INITIAL_AMOUNT, src.VALID_FROM, src.VALID_TO, src.IS_BLOCKED, src.BLOCKED_FROM, src.BLOCKED_TO, src.IS_EXHAUSED, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_QUOTA_GRANTED' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_QUOTA_GRANTED AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_QUOTA_GRANTED AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.ISSUED_QUANTITY_UNIT=src.ISSUED_QUANTITY_UNIT, tgt.QUALIFIER_OF_UNIT=src.QUALIFIER_OF_UNIT, tgt.QUOTA_NO=src.QUOTA_NO, tgt.ISSUED_QUOTA_QUANTITY=src.ISSUED_QUOTA_QUANTITY, tgt.POS_ID=src.POS_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, ISSUED_QUANTITY_UNIT, QUALIFIER_OF_UNIT, QUOTA_NO, ISSUED_QUOTA_QUANTITY, POS_ID, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.ISSUED_QUANTITY_UNIT, src.QUALIFIER_OF_UNIT, src.QUOTA_NO, src.ISSUED_QUOTA_QUANTITY, src.POS_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_REQ_DOC' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_REQ_DOC AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_REQ_DOC AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.DOC_CODE=src.DOC_CODE, tgt.DOC_NUMBER=src.DOC_NUMBER, tgt.DOC_NOTES=src.DOC_NOTES, tgt.ITEM_QUANTITY=src.ITEM_QUANTITY, tgt.QUANTITY_UNIT=src.QUANTITY_UNIT, tgt.AGRIM_RESULT=src.AGRIM_RESULT, tgt.AGRIM_DISCREP_INFO=src.AGRIM_DISCREP_INFO, tgt.POZ_ID=src.POZ_ID, tgt.INSTITUTION_NAME=src.INSTITUTION_NAME, tgt.EXPIRATION_DATE=src.EXPIRATION_DATE, tgt.ZCP_ACF=src.ZCP_ACF, tgt.DOC_IDENTITY=src.DOC_IDENTITY, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, DOC_CODE, DOC_NUMBER, DOC_NOTES, ITEM_QUANTITY, QUANTITY_UNIT, AGRIM_RESULT, AGRIM_DISCREP_INFO, POZ_ID, INSTITUTION_NAME, EXPIRATION_DATE, ZCP_ACF, DOC_IDENTITY, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.DOC_CODE, src.DOC_NUMBER, src.DOC_NOTES, src.ITEM_QUANTITY, src.QUANTITY_UNIT, src.AGRIM_RESULT, src.AGRIM_DISCREP_INFO, src.POZ_ID, src.INSTITUTION_NAME, src.EXPIRATION_DATE, src.ZCP_ACF, src.DOC_IDENTITY, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_RETROSPECTIVE_REQ' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_RETROSPECTIVE_REQ AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_RETROSPECTIVE_REQ AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.DATE=src.DATE, tgt.LRN=src.LRN, tgt.PREFERENCES=src.PREFERENCES, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, DATE, LRN, PREFERENCES, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.DATE, src.LRN, src.PREFERENCES, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_TARIC_QUANTITY' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_TARIC_QUANTITY AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_TARIC_QUANTITY AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.UNIT=src.UNIT, tgt.QUALIFIER_OF_UNIT=src.QUALIFIER_OF_UNIT, tgt.QUANTITY=src.QUANTITY, tgt.POZ_ID_REQ_DOC=src.POZ_ID_REQ_DOC, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, UNIT, QUALIFIER_OF_UNIT, QUANTITY, POZ_ID_REQ_DOC, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.UNIT, src.QUALIFIER_OF_UNIT, src.QUANTITY, src.POZ_ID_REQ_DOC, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_TARIFF_MEASURE' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_TARIFF_MEASURE AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_TARIFF_MEASURE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.UAM_QUALIFIER=src.UAM_QUALIFIER, tgt.RECORD_NUMBER=src.RECORD_NUMBER, tgt.GEOGRAPHICAL_AREA_CODE=src.GEOGRAPHICAL_AREA_CODE, tgt.SERIES=src.SERIES, tgt.SID=src.SID, tgt.TYPE=src.TYPE, tgt.UAM_CODE=src.UAM_CODE, tgt.FOOTNOTES=src.FOOTNOTES, tgt.ARCHIV=src.ARCHIV, tgt.REC_DATE=src.REC_DATE, tgt.MEASURE_ID=src.MEASURE_ID, tgt.RETRO_QUOTA_ID=src.RETRO_QUOTA_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, UAM_QUALIFIER, RECORD_NUMBER, GEOGRAPHICAL_AREA_CODE, SERIES, SID, TYPE, UAM_CODE, FOOTNOTES, ARCHIV, REC_DATE, MEASURE_ID, RETRO_QUOTA_ID, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.UAM_QUALIFIER, src.RECORD_NUMBER, src.GEOGRAPHICAL_AREA_CODE, src.SERIES, src.SID, src.TYPE, src.UAM_CODE, src.FOOTNOTES, src.ARCHIV, src.REC_DATE, src.MEASURE_ID, src.RETRO_QUOTA_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_TAX_IDENTITY' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_TAX_IDENTITY AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_TAX_IDENTITY AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.VAT_NUMBER=src.VAT_NUMBER, tgt.TAX_ROLE=src.TAX_ROLE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, VAT_NUMBER, TAX_ROLE, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.VAT_NUMBER, src.TAX_ROLE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_VALUE_CORRECTION' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_VALUE_CORRECTION AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_VALUE_CORRECTION AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.POSITION_ID=src.POSITION_ID, tgt.CODE=src.CODE, tgt.VALUE=src.VALUE, tgt.ZCP_ITEM_VALUE_INFO_ID=src.ZCP_ITEM_VALUE_INFO_ID, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, POSITION_ID, CODE, VALUE, ZCP_ITEM_VALUE_INFO_ID, ZCP_ACF, version)
	VALUES (src.ID, src.POSITION_ID, src.CODE, src.VALUE, src.ZCP_ITEM_VALUE_INFO_ID, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_VALUE_DETAILS' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_VALUE_DETAILS AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_VALUE_DETAILS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_VALUE_INFO_ID=src.ZCP_ITEM_VALUE_INFO_ID, tgt.POSITION_ID=src.POSITION_ID, tgt.CODE=src.CODE, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_VALUE_INFO_ID, POSITION_ID, CODE, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ITEM_VALUE_INFO_ID, src.POSITION_ID, src.CODE, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_VALUE_INFO' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_VALUE_INFO AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_VALUE_INFO AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.VALUATION_METHOD=src.VALUATION_METHOD, tgt.STATISTICAL_VALUE=src.STATISTICAL_VALUE, tgt.ITEM_VALUE=src.ITEM_VALUE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, VALUATION_METHOD, STATISTICAL_VALUE, ITEM_VALUE, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.VALUATION_METHOD, src.STATISTICAL_VALUE, src.ITEM_VALUE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_VEHICLE' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_VEHICLE AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_VEHICLE AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.MAKE=src.MAKE, tgt.BODYWORK_NO=src.BODYWORK_NO, tgt.ENGINE_NO=src.ENGINE_NO, tgt.ENGINE_CAPACITY=src.ENGINE_CAPACITY, tgt.FUEL_TYPE=src.FUEL_TYPE, tgt.PROD_YEAR=src.PROD_YEAR, tgt.MODEL=src.MODEL, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, MAKE, BODYWORK_NO, ENGINE_NO, ENGINE_CAPACITY, FUEL_TYPE, PROD_YEAR, MODEL, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.MAKE, src.BODYWORK_NO, src.ENGINE_NO, src.ENGINE_CAPACITY, src.FUEL_TYPE, src.PROD_YEAR, src.MODEL, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_ITEM_WDZ' BEGIN
	MERGE INTO aimp2.ICS_ZCP_ITEM_WDZ AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_ITEM_WDZ AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.MRN=src.MRN, tgt.WDZ_NO=src.WDZ_NO, tgt.STATUS=src.STATUS, tgt.AMOUNT=src.AMOUNT, tgt.COMMENTS=src.COMMENTS, tgt.GRN=src.GRN, tgt.G_OTHER_TYPE_CODE=src.G_OTHER_TYPE_CODE, tgt.TIN=src.TIN, tgt.G_ACCESS_CODE=src.G_ACCESS_CODE, tgt.NEXT_WDZ_NO=src.NEXT_WDZ_NO, tgt.SENT_TO_OSOZ_STATUS=src.SENT_TO_OSOZ_STATUS, tgt.SENT_TO_ZEFIR_STATUS=src.SENT_TO_ZEFIR_STATUS, tgt.QUOTA_ID=src.QUOTA_ID, tgt.SENT_ZC272=src.SENT_ZC272, tgt.AMOUNT_USED=src.AMOUNT_USED, tgt.DATE_USED=src.DATE_USED, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, MRN, WDZ_NO, STATUS, AMOUNT, COMMENTS, GRN, G_OTHER_TYPE_CODE, TIN, G_ACCESS_CODE, NEXT_WDZ_NO, SENT_TO_OSOZ_STATUS, SENT_TO_ZEFIR_STATUS, QUOTA_ID, SENT_ZC272, AMOUNT_USED, DATE_USED, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.MRN, src.WDZ_NO, src.STATUS, src.AMOUNT, src.COMMENTS, src.GRN, src.G_OTHER_TYPE_CODE, src.TIN, src.G_ACCESS_CODE, src.NEXT_WDZ_NO, src.SENT_TO_OSOZ_STATUS, src.SENT_TO_ZEFIR_STATUS, src.QUOTA_ID, src.SENT_ZC272, src.AMOUNT_USED, src.DATE_USED, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_LOCATION' BEGIN
	MERGE INTO aimp2.ICS_ZCP_LOCATION AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_LOCATION AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.ZCP_ADDRESS_ID=src.ZCP_ADDRESS_ID, tgt.CODE=src.CODE, tgt.COUNTRY=src.COUNTRY, tgt.QUALIFIER=src.QUALIFIER, tgt.LOCATION_CO=src.LOCATION_CO, tgt.DESCRIPTION=src.DESCRIPTION, tgt.TYPE=src.TYPE, tgt.ADDITIONAL_IDENTITY=src.ADDITIONAL_IDENTITY, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, ZCP_ADDRESS_ID, CODE, COUNTRY, QUALIFIER, LOCATION_CO, DESCRIPTION, TYPE, ADDITIONAL_IDENTITY, version)
	VALUES (src.ID, src.ZCP_ID, src.ZCP_ADDRESS_ID, src.CODE, src.COUNTRY, src.QUALIFIER, src.LOCATION_CO, src.DESCRIPTION, src.TYPE, src.ADDITIONAL_IDENTITY, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_NAT_ADD_CODES' BEGIN
	MERGE INTO aimp2.ICS_ZCP_NAT_ADD_CODES AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_NAT_ADD_CODES AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.NATIONAL_CODE=src.NATIONAL_CODE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, NATIONAL_CODE, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.NATIONAL_CODE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_NATURAL_PERSON' BEGIN
	MERGE INTO aimp2.ICS_ZCP_NATURAL_PERSON AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_NATURAL_PERSON AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ADDRESS_ID=src.ZCP_ADDRESS_ID, tgt.ZCP_DOC_SIGNER_ID=src.ZCP_DOC_SIGNER_ID, tgt.IDENTIFIER=src.IDENTIFIER, tgt.NAME=src.NAME, tgt.SURNAME=src.SURNAME, tgt.ID_NO=src.ID_NO, tgt.PESEL=src.PESEL, tgt.REPRESENTATIVE_TYPE=src.REPRESENTATIVE_TYPE, tgt.BE_OUTPOST=src.BE_OUTPOST, tgt.DECL_ID=src.DECL_ID, tgt.CUSTOMER_TYPE=src.CUSTOMER_TYPE, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ADDRESS_ID, ZCP_DOC_SIGNER_ID, IDENTIFIER, NAME, SURNAME, ID_NO, PESEL, REPRESENTATIVE_TYPE, BE_OUTPOST, DECL_ID, CUSTOMER_TYPE, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ADDRESS_ID, src.ZCP_DOC_SIGNER_ID, src.IDENTIFIER, src.NAME, src.SURNAME, src.ID_NO, src.PESEL, src.REPRESENTATIVE_TYPE, src.BE_OUTPOST, src.DECL_ID, src.CUSTOMER_TYPE, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_NOTIF_ABOUT_CONTROL' BEGIN
	MERGE INTO aimp2.ICS_ZCP_NOTIF_ABOUT_CONTROL AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_NOTIF_ABOUT_CONTROL AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.TIME=src.TIME, tgt.REMARKS=src.REMARKS, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, TIME, REMARKS, version)
	VALUES (src.ID, src.ZCP_ID, src.TIME, src.REMARKS, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_OFFICIAL_ANNOTATION' BEGIN
	MERGE INTO aimp2.ICS_ZCP_OFFICIAL_ANNOTATION AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_OFFICIAL_ANNOTATION AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.zcp_item_id=src.zcp_item_id, tgt.annotation=src.annotation, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (id, zcp_item_id, annotation, version)
	VALUES (src.id, src.zcp_item_id, src.annotation, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_OSOZ_ZEFIR_OQ' BEGIN
	MERGE INTO aimp2.ICS_ZCP_OSOZ_ZEFIR_OQ AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_OSOZ_ZEFIR_OQ AS src
	ON (tgt.id=src.id)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.zcp_id=src.zcp_id, tgt.operation=src.operation, tgt.procedure_type=src.procedure_type, tgt.status=src.status, tgt.zcp_item_id=src.zcp_item_id, tgt.zcp_wdz_item_id=src.zcp_wdz_item_id, tgt.zcp_podz_item_id=src.zcp_podz_item_id, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (id, zcp_id, operation, procedure_type, status, zcp_item_id, zcp_wdz_item_id, zcp_podz_item_id, version)
	VALUES (src.id, src.zcp_id, src.operation, src.procedure_type, src.status, src.zcp_item_id, src.zcp_wdz_item_id, src.zcp_podz_item_id, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_PAYMENT' BEGIN
	MERGE INTO aimp2.ICS_ZCP_PAYMENT AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_PAYMENT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.DEBT_NOTIFICATION_DATE=src.DEBT_NOTIFICATION_DATE, tgt.DEBT_ACQUAINTED_DATE=src.DEBT_ACQUAINTED_DATE, tgt.AMOUNT=src.AMOUNT, tgt.AMOUNT_TO_GUARANTEE=src.AMOUNT_TO_GUARANTEE, tgt.IS_AMOUNT_GUARANTEED=src.IS_AMOUNT_GUARANTEED, tgt.IS_AMOUNT_PAID=src.IS_AMOUNT_PAID, tgt.PAYMENT_METHOD=src.PAYMENT_METHOD, tgt.BASE=src.BASE, tgt.RATE=src.RATE, tgt.TYPE=src.TYPE, tgt.ZCP_PODZ_ID=src.ZCP_PODZ_ID, tgt.ZCP_DECISION_ID=src.ZCP_DECISION_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, DEBT_NOTIFICATION_DATE, DEBT_ACQUAINTED_DATE, AMOUNT, AMOUNT_TO_GUARANTEE, IS_AMOUNT_GUARANTEED, IS_AMOUNT_PAID, PAYMENT_METHOD, BASE, RATE, TYPE, ZCP_PODZ_ID, ZCP_DECISION_ID, version)
	VALUES (src.ID, src.DEBT_NOTIFICATION_DATE, src.DEBT_ACQUAINTED_DATE, src.AMOUNT, src.AMOUNT_TO_GUARANTEE, src.IS_AMOUNT_GUARANTEED, src.IS_AMOUNT_PAID, src.PAYMENT_METHOD, src.BASE, src.RATE, src.TYPE, src.ZCP_PODZ_ID, src.ZCP_DECISION_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_PERMITS_HOLDER' BEGIN
	MERGE INTO aimp2.ICS_ZCP_PERMITS_HOLDER AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_PERMITS_HOLDER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.PERMIT_TYPE=src.PERMIT_TYPE, tgt.IDENTIFY=src.IDENTIFY, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, PERMIT_TYPE, IDENTIFY, version)
	VALUES (src.ID, src.ZCP_ID, src.PERMIT_TYPE, src.IDENTIFY, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_POD' BEGIN
	MERGE INTO aimp2.ICS_ZCP_POD AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_POD AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.ZCP_DECISION_ID=src.ZCP_DECISION_ID, tgt.CREATED_DATE=src.CREATED_DATE, tgt.FAMILIARIZE_DEBT_DATE=src.FAMILIARIZE_DEBT_DATE, tgt.STATUS=src.STATUS, tgt.message_id=src.message_id, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, ZCP_DECISION_ID, CREATED_DATE, FAMILIARIZE_DEBT_DATE, STATUS, message_id, version)
	VALUES (src.ID, src.ZCP_ID, src.ZCP_DECISION_ID, src.CREATED_DATE, src.FAMILIARIZE_DEBT_DATE, src.STATUS, src.message_id, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_POD_ITEM' BEGIN
	MERGE INTO aimp2.ICS_ZCP_POD_ITEM AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_POD_ITEM AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_POD_ID=src.ZCP_POD_ID, tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_POD_ID, ZCP_ITEM_ID, version)
	VALUES (src.ID, src.ZCP_POD_ID, src.ZCP_ITEM_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_PODZ' BEGIN
	MERGE INTO aimp2.ICS_ZCP_PODZ AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_PODZ AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.MRN=src.MRN, tgt.PODZ_NO=src.PODZ_NO, tgt.PROPRIETARY_PODZ_NO=src.PROPRIETARY_PODZ_NO, tgt.STATUS=src.STATUS, tgt.COMMENTS=src.COMMENTS, tgt.TIN=src.TIN, tgt.CREATION_DATE=src.CREATION_DATE, tgt.SELF_REF_284=src.SELF_REF_284, tgt.SELF_REF_285=src.SELF_REF_285, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, MRN, PODZ_NO, PROPRIETARY_PODZ_NO, STATUS, COMMENTS, TIN, CREATION_DATE, SELF_REF_284, SELF_REF_285, version)
	VALUES (src.ID, src.ZCP_ID, src.MRN, src.PODZ_NO, src.PROPRIETARY_PODZ_NO, src.STATUS, src.COMMENTS, src.TIN, src.CREATION_DATE, src.SELF_REF_284, src.SELF_REF_285, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_PREV_DOC' BEGIN
	MERGE INTO aimp2.ICS_ZCP_PREV_DOC AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_PREV_DOC AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CATEGORY=src.CATEGORY, tgt.CODE=src.CODE, tgt.NUMBER=src.NUMBER, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CATEGORY, CODE, NUMBER, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ID, src.CATEGORY, src.CODE, src.NUMBER, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_PREV_DOC_POS' BEGIN
	MERGE INTO aimp2.ICS_ZCP_PREV_DOC_POS AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_PREV_DOC_POS AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_PREV_DOC_ID=src.ZCP_PREV_DOC_ID, tgt.PREV_DOC_NO=src.PREV_DOC_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_PREV_DOC_ID, PREV_DOC_NO, version)
	VALUES (src.ID, src.ZCP_PREV_DOC_ID, src.PREV_DOC_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_TARIC_ADD_CODES' BEGIN
	MERGE INTO aimp2.ICS_ZCP_TARIC_ADD_CODES AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_TARIC_ADD_CODES AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ITEM_ID=src.ZCP_ITEM_ID, tgt.TARIC_CODE=src.TARIC_CODE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ITEM_ID, TARIC_CODE, version)
	VALUES (src.ID, src.ZCP_ITEM_ID, src.TARIC_CODE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_TAX_IDENTITY' BEGIN
	MERGE INTO aimp2.ICS_ZCP_TAX_IDENTITY AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_TAX_IDENTITY AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.VAT_NUMBER=src.VAT_NUMBER, tgt.TAX_ROLE=src.TAX_ROLE, tgt.ZCP_ACF=src.ZCP_ACF, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, VAT_NUMBER, TAX_ROLE, ZCP_ACF, version)
	VALUES (src.ID, src.ZCP_ID, src.VAT_NUMBER, src.TAX_ROLE, src.ZCP_ACF, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_TRANSACTION' BEGIN
	MERGE INTO aimp2.ICS_ZCP_TRANSACTION AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_TRANSACTION AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CURRENCY=src.CURRENCY, tgt.TYPE=src.TYPE, tgt.CURRENCY_OF_INVOICE=src.CURRENCY_OF_INVOICE, tgt.VALUE_DETAIL=src.VALUE_DETAIL, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CURRENCY, TYPE, CURRENCY_OF_INVOICE, VALUE_DETAIL, version)
	VALUES (src.ID, src.ZCP_ID, src.CURRENCY, src.TYPE, src.CURRENCY_OF_INVOICE, src.VALUE_DETAIL, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_TRANSPORT_AT_BORDER' BEGIN
	MERGE INTO aimp2.ICS_ZCP_TRANSPORT_AT_BORDER AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_TRANSPORT_AT_BORDER AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.TRANSPORT_AFFIL_ACTIVE_MEANS=src.TRANSPORT_AFFIL_ACTIVE_MEANS, tgt.KIND_OF_TRANSPORT=src.KIND_OF_TRANSPORT, tgt.MARKINGS=src.MARKINGS, tgt.TRANSPORT_MEANS_ID=src.TRANSPORT_MEANS_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, TRANSPORT_AFFIL_ACTIVE_MEANS, KIND_OF_TRANSPORT, MARKINGS, TRANSPORT_MEANS_ID, version)
	VALUES (src.ID, src.ZCP_ID, src.TRANSPORT_AFFIL_ACTIVE_MEANS, src.KIND_OF_TRANSPORT, src.MARKINGS, src.TRANSPORT_MEANS_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_TRANSPORT_DOCUMENT' BEGIN
	MERGE INTO aimp2.ICS_ZCP_TRANSPORT_DOCUMENT AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_TRANSPORT_DOCUMENT AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CODE=src.CODE, tgt.DOC_NO=src.DOC_NO, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CODE, DOC_NO, version)
	VALUES (src.ID, src.ZCP_ID, src.CODE, src.DOC_NO, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_TRANSPORT_INTERNAL' BEGIN
	MERGE INTO aimp2.ICS_ZCP_TRANSPORT_INTERNAL AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_TRANSPORT_INTERNAL AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.CODE=src.CODE, tgt.MARKINGS=src.MARKINGS, tgt.TRANSPORT_AFFIL_ACTIVE_MEANS=src.TRANSPORT_AFFIL_ACTIVE_MEANS, tgt.TRANSPORT_MEANS_ID=src.TRANSPORT_MEANS_ID, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, CODE, MARKINGS, TRANSPORT_AFFIL_ACTIVE_MEANS, TRANSPORT_MEANS_ID, version)
	VALUES (src.ID, src.ZCP_ID, src.CODE, src.MARKINGS, src.TRANSPORT_AFFIL_ACTIVE_MEANS, src.TRANSPORT_MEANS_ID, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_VAT_PERIOD' BEGIN
	MERGE INTO aimp2.ICS_ZCP_VAT_PERIOD AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_VAT_PERIOD AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.BE_RECEIVER_ID=src.BE_RECEIVER_ID, tgt.DATE_FROM=src.DATE_FROM, tgt.DATE_TO=src.DATE_TO, tgt.FREQUENCY_CODE=src.FREQUENCY_CODE, tgt.BASE=src.BASE, tgt.AMOUNT=src.AMOUNT, tgt.VAT7_BASE=src.VAT7_BASE, tgt.VAT7_AMOUNT=src.VAT7_AMOUNT, tgt.LOGIN=src.LOGIN, tgt.ACC_DATE=src.ACC_DATE, tgt.VAT7_CLOSED=src.VAT7_CLOSED, tgt.NP_RECEIVER_ID=src.NP_RECEIVER_ID, tgt.TIN=src.TIN, tgt.EORI=src.EORI, tgt.VAT7_ARTICLE=src.VAT7_ARTICLE, tgt.VAT7_CLOSED_DATE=src.VAT7_CLOSED_DATE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, BE_RECEIVER_ID, DATE_FROM, DATE_TO, FREQUENCY_CODE, BASE, AMOUNT, VAT7_BASE, VAT7_AMOUNT, LOGIN, ACC_DATE, VAT7_CLOSED, NP_RECEIVER_ID, TIN, EORI, VAT7_ARTICLE, VAT7_CLOSED_DATE, version)
	VALUES (src.ID, src.BE_RECEIVER_ID, src.DATE_FROM, src.DATE_TO, src.FREQUENCY_CODE, src.BASE, src.AMOUNT, src.VAT7_BASE, src.VAT7_AMOUNT, src.LOGIN, src.ACC_DATE, src.VAT7_CLOSED, src.NP_RECEIVER_ID, src.TIN, src.EORI, src.VAT7_ARTICLE, src.VAT7_CLOSED_DATE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_ZCP_WDZ' BEGIN
	MERGE INTO aimp2.ICS_ZCP_WDZ AS tgt
	USING WI_StageODS.aimp2.ICS_ZCP_WDZ AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_ID=src.ZCP_ID, tgt.MRN=src.MRN, tgt.WDZ_NO=src.WDZ_NO, tgt.PROPRIETARY_WDZ_NO=src.PROPRIETARY_WDZ_NO, tgt.STATUS=src.STATUS, tgt.COMMENTS=src.COMMENTS, tgt.SELF_REF_282=src.SELF_REF_282, tgt.SELF_REF_283=src.SELF_REF_283, tgt.TIN=src.TIN, tgt.AUTHOR=src.AUTHOR, tgt.CREATION_DATE=src.CREATION_DATE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_ID, MRN, WDZ_NO, PROPRIETARY_WDZ_NO, STATUS, COMMENTS, SELF_REF_282, SELF_REF_283, TIN, AUTHOR, CREATION_DATE, version)
	VALUES (src.ID, src.ZCP_ID, src.MRN, src.WDZ_NO, src.PROPRIETARY_WDZ_NO, src.STATUS, src.COMMENTS, src.SELF_REF_282, src.SELF_REF_283, src.TIN, src.AUTHOR, src.CREATION_DATE, src.version);
SET @Merged = 1;
END




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ICS_DSK_OSOB_PODP_DOK' BEGIN
	MERGE INTO aimp2.ICS_DSK_OSOB_PODP_DOK AS tgt
	USING WI_StageODS.aimp2.ICS_DSK_OSOB_PODP_DOK AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.EMAIL=src.EMAIL, tgt.IMIE=src.IMIE, tgt.NAZWISKO=src.NAZWISKO, tgt.SWIAD_ODP_KARNEJ=src.SWIAD_ODP_KARNEJ, tgt.TELEFON=src.TELEFON, tgt.AGENT_CELNY_DATA_WPISU=src.AGENT_CELNY_DATA_WPISU, tgt.AGENT_CELNY_NR_WPISU=src.AGENT_CELNY_NR_WPISU, tgt.ICS_DSK_ID=src.ICS_DSK_ID, tgt.POUCZENIE=src.POUCZENIE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, EMAIL, IMIE, NAZWISKO, SWIAD_ODP_KARNEJ, TELEFON, AGENT_CELNY_DATA_WPISU, AGENT_CELNY_NR_WPISU, ICS_DSK_ID, POUCZENIE, version)
	VALUES (src.ID, src.EMAIL, src.IMIE, src.NAZWISKO, src.SWIAD_ODP_KARNEJ, src.TELEFON, src.AGENT_CELNY_DATA_WPISU, src.AGENT_CELNY_NR_WPISU, src.ICS_DSK_ID, src.POUCZENIE, src.version);
SET @Merged = 1;
END



----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
IF @TableName = 'ais_zcp_natural_pers_add_info' BEGIN
	MERGE INTO aimp2.ais_zcp_natural_pers_add_info AS tgt
	USING WI_StageODS.aimp2.ais_zcp_natural_pers_add_info AS src
	ON (tgt.ID=src.ID)
	WHEN MATCHED
	THEN UPDATE SET
	tgt.ZCP_NATURAL_PERSON_ID=src.ZCP_NATURAL_PERSON_ID, tgt.CODE=src.CODE, tgt.version=src.version
	WHEN NOT MATCHED
	THEN INSERT (ID, ZCP_NATURAL_PERSON_ID, CODE, version)
	VALUES (src.ID, src.ZCP_NATURAL_PERSON_ID, src.CODE, src.version);
SET @Merged = 1;
END



		
	IF (@Merged = 0)
		BEGIN
			DECLARE @Info VARCHAR(500) = 'W procedurze nie znaleziono bloku odpowiadającego tabeli [' + @TableName + '] z parametru @TableName.';
			THROW 51002, @Info, 0;
		END
	END;